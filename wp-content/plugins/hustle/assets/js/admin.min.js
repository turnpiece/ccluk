!function(e){"use strict";window.Hustle=function(e,t,i){var s={},o={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},n=function(o,n){var a=o.split(".");if(a.length){var l=function(s,o){var a=s.split("."),d=a.splice(0,1)[0];if(d){if(a.length)o[d]=o[d]||{};else{var r=n.call(null,e,t,i);o[d]=_.isFunction(r)||"undefined"==typeof r?r:_.extend(o[d]||{},r)}a.length&&d&&l(a.join("."),o[d])}};l(o,s)}else{var d=s[o]||{};s[o]=_.extend(d,n.call(null,e,t,i))}},a=function(){return s},l=function(e){if(e.split(".").length){var t=!1,i=function(e,s){var o=e.split("."),n=o.splice(0,1)[0];t=s[n],o.length&&i(o.join("."),s[n])};return i(e,s),t}return s[e]||!1},d=_.extend({},Backbone.Events),r=Backbone.View.extend({__base_events:{"click .wph-tabs--wrap .wph-tabs--nav li label":"__base_toggle_tab"},initialize:function(){this.events=_.extend({},this.events,this.__base_events),_.isFunction(this.init_mix)&&this.init_mix.apply(this,arguments),this.render&&(this.render=_.wrap(this.render,function(e){this.trigger("before_render"),e.call(this),d.trigger("view.rendered",this),this.trigger("rendered")})),_.isFunction(this.init)&&this.init.apply(this,arguments)},__base_toggle_tab:function(e){var t=this.$(e.target),i=(t.attr("href")||"").replace(/^\#/,""),s=!!i&&this.$("#"+i),o=t.closest(".wph-tabs--wrap"),n=t.closest("li");s&&s.length&&(o.find(".wph-tabs--content").not(s).removeClass("current"),s.addClass("current"),n.addClass("current"),n.siblings().removeClass("current"))}}),c=_.memoize(function(e){var t;return function(i){return t=t||_.template(document.getElementById(e).innerHTML,null,o),t(i).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),u=_.memoize(function(e){var t;return function(i){return(t=t||_.template(e,null,o))(i)}}),p=function(){return e.extend(!0,{},o)},m=function(){var t=function(e){var t,i,s,o=document.cookie.split(";");for(s=e+"=",t=0;t<o.length;t+=1){for(i=o[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(s)){var n=i.substring(s.length,i.length);return n?JSON.parse(n):n}}return null},i=function(t,i,s){var o,n;i=e.isArray(i)||e.isPlainObject(i)?JSON.stringify(i):i,isNaN(s)?n="":(o=new Date,o.setTime(o.getTime()+24*s*60*60*1e3),n="; expires="+o.toGMTString()),document.cookie=t+"="+i+n+"; path=/"};return{set:i,get:t}}(),h=function(){return{Module_Show_Count:"hustle_module_show_count-"}}();return{define:n,get_modules:a,get:l,Events:d,View:r,template:c,create_template:u,get_template_options:p,cookie:m,consts:h}}(jQuery,document,window)}(jQuery);var Optin=Optin||{};Optin.View={},Optin.Models={},Optin.Events={},"undefined"!=typeof Backbone&&_.extend(Optin.Events,Backbone.Events),function(e){"use strict";Optin.COOKIE_PREFIX="inc_optin_long_hidden-",Optin.POPUP_COOKIE_PREFIX="inc_optin_popup_long_hidden-",Optin.SLIDE_IN_COOKIE_PREFIX="inc_optin_slide_in_long_hidden-",Optin.SLIDE_IN_COOKIE_HIDE_ALL="inc_optin_slide_in_hide_all",Optin.global_mixin=function(){_.mixin({log:function(){console.log(arguments)},toBool:function(e){return _.isBoolean(e)?e:_.isString(e)&&["true","false","1"].indexOf(e.toLowerCase())!==-1?"true"===e.toLowerCase()||"1"===e.toLowerCase():_.isNumber(e)?!!e:!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&e},isTrue:function(e){return!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&(_.isNumber(e)?0!==e:(e=e.toString().toLowerCase(),["1","true","on"].indexOf(e)!==-1))},isFalse:function(e){return!_.isTrue(e)},control_base:function(e,t,i){return i=_.isUndefined(i)?"checked":i,e=_.toBool(e),t=_.isBoolean(e)?_.isTrue(t):t,_.isEqual(e,t)?i+"="+i:""},checked:function(e,t){return _.control_base(e,t,"checked")},selected:function(e,t){return _.control_base(e,t,"selected")},disabled:function(e,t){return _.control_base(e,t,"disabled")},"class":function(e,t,i){return _.isTrue(e)?t:"undefined"!=typeof i?i:""},add_class:function(e,t,i){return"class={class}".replace("{class}",_["class"](e,t,i))},toUpperCase:function(e){return _.isString(e)?e.toUpperCase():""}}),_.findKey||_.mixin({findKey:function(e,t,i){t=cb(t,i);for(var s,o=_.keys(e),n=0,a=o.length;n<a;n++)if(s=o[n],t(e[s],s,e))return s}})},Optin.global_mixin(),Backbone.Model.prototype.toJSON=function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||Backbone.Collection&&e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},String.prototype.toInt=function(){return parseInt(this,10)},String.prototype.isEmpty=function(){return 0===this.length||!this.trim()},Optin.template=_.memoize(function(t){var i,s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(o){return i=i||_.template(e("#"+t).html(),null,s),i(o).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.template_compat=_.memoize(function(t){var i;return function(s){return i=i||_.template(e("#"+t).html()),i(s).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.cookie=Hustle.cookie,e(document).on("blur","input, textarea, select",function(){var t=e(this);t.is(":input[type=button], :input[type=submit], :input[type=reset]")||(t.val()&&t.val().trim&&""!==t.val().trim()?t.parent().addClass("hustle-input-filled"):t.parent().removeClass("hustle-input-filled"))}),Optin.Mixins={_mixins:{},_services_mixins:{},_desing_mixins:{},_display_mixins:{},add:function(e,t){this._mixins[e]=t},get_mixins:function(){return this._mixins},add_services_mixin:function(e,t){this._services_mixins[e]=t},get_services_mixins:function(){return this._services_mixins}}}(jQuery),Hustle.define("Modal_Email",function(e){"use strict";var t={};return Backbone.View.extend({id:"wph-modal-email",className:"wpmudev-modal",template:Optin.template("hustle-modal-email-tpl"),list_header_template:Optin.template("wpoi-email-list-header-tpl"),list_template:Optin.template("wpoi-emails-list-tpl"),show_delay:350,events:{"click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide"},initialize:function(){return this.render()},render:function(){var i=this,s=this.template(this.model);return s=s.replace("__id",this.model.id),s=s.replace("__type",this.model.type),this.$el.html(s),t[this.model.id]||(t[this.model.id]=e.ajax({url:ajaxurl,type:"GET",data:{action:"hustle_get_email_lists",id:i.model.id,_ajax_nonce:e("#hustle_get_emails_list_nonce").val()}}),this.delay_show=0),t[this.model.id].then(function(e){if(e.success){var t=e.data.module_fields,s=[];i.model.module_fields.length||(i.model.module_fields=t,i.$(".wpmudev-listing-head").html(i.list_header_template({module_fields:t})),_.each(t,function(e){s.push({name:e.name,label:e.label})}));var o=i.list_template({subscriptions:e.data.subscriptions,module_fields:s});i.$(".wpmudev-listing-body").html(o)}}),this.$el.appendTo("#wpmudev-hustle"),this.show(),this},show:function(){e("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},close:function(e){e.preventDefault(),this.$el.removeClass("show"),_.delay(function(){this.remove()}.bind(this),350)},hide:function(t){var i=e(t.target),s=this.$el.find(".wpmudev-box-modal"),o=this;(i.hasClass("wpmudev-modal-mask")||i.hasClass("wpmudev-i_close")||i.parent().hasClass("wpmudev-i_close"))&&(s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){o.$el.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},500))}})}),Hustle.define("Modal_Error",function(e){"use strict";var t=Backbone.View.extend({template:Optin.template("hustle-error-list-tpl"),className:"wpmudev-listing-row",controller:!1,initialize:function(e){this.controller=e.controller,this.module_fields=e.module_fields,this.render()},render:function(){var e=this.template({model:this.model,module_fields:this.module_fields});this.$el.html(e),this.$el.appendTo(this.controller.$(".wpmudev-listing-body"))}});return Backbone.View.extend({id:"wph-modal-error",template:Optin.template("hustle-modal-error-tpl"),list_header_template:Optin.template("hustle-error-header-list-tpl"),className:"wpmudev-modal",events:{"click .inc-opt-close-error-list":"toggleErrorLog","click .wpmudev-button-clear-logs":"clearLogs","click .wpmudev-button-delete-logs":"_clean","click .wpmudev-button-cancel-delete-logs":"cancelDelete","click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide"},initialize:function(e){return this.$el.html(this.template({id:this.model.id})),this.button=e.button,this.render()},render:function(){var i=this,s=this.template(this.model);return s=s.replace("__id",this.model.id),s=s.replace("__type",this.model.type),this.clearLogButton=this.$(".wpmudev-button-clear-logs"),this.exportButton=this.$(".wpmudev-button-download-csv"),this.deleteConfirmation=this.$(".hustle-delete-logs-confirmation"),e.getJSON(window.ajaxurl,{id:this.model.id,_wpnonce:optin_vars.error_log_nonce,action:"get_error_list"},function(e){if(e.success&&e.data&&e.data.logs){var s=e.data.module_fields;i.model.module_fields=s,i.$(".wpmudev-listing-head").html(i.list_header_template({module_fields:s})),_.each(e.data.logs,function(e){new t({module_fields:s,model:e,controller:i})}),i.show()}}),this.$el.html(s),e("#wph-modal-error").length>0?e("#wph-modal-error").html(this.$el):this.$el.appendTo("#wpmudev-hustle"),this.show(),this},show:function(){e("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},hide:function(t){var i=e(t.target),s=this.$el.find(".wpmudev-box-modal"),o=this;(i.hasClass("wpmudev-modal-mask")||i.hasClass("wpmudev-i_close")||i.parent().hasClass("wpmudev-i_close"))&&(s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){o.$el.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},500))},toggleErrorLog:function(){this.$el.removeClass("show")},clearLogs:function(t){e(t.target).parents(".wpmudev-footer-clear").find(".hustle-delete-logs-confirmation").removeClass("wpmudev-hidden"),this.clearLogButton.attr("disabled",!0),this.exportButton.attr("disabled",!0)},_clean:function(){var t=this;e.get(window.ajaxurl,{id:this.model.id,_wpnonce:optin_vars.clear_log_nonce,action:"clear_logs"},function(e){e.success&&(t.toggleErrorLog(),_.delay(function(){t.button.remove(),t.remove()},350))})},cancelDelete:function(t){e(t.target).parents(".hustle-delete-logs-confirmation").addClass("wpmudev-hidden"),this.clearLogButton.removeAttr("disabled"),this.exportButton.removeAttr("disabled")}})}),function(e){"use strict";Hustle.Events.on("modules.view.rendered",function(t){Hustle.Events.trigger("modules.view.select.render",t),t instanceof Backbone.View&&(e(".wpmudev-box-close").each(function(){var t=e(this),i=t.find(".wpmudev-box-action"),s=t.find(".wpmudev-box-body");i.on("click",function(e){e.stopPropagation(),s.slideToggle()})}),e(".wpmudev-box-close").each(function(){var t=e(this),i=t.find(".wpmudev-i_close");i.on("click",function(e){e.stopPropagation(),t.removeClass("wpmudev-show").addClass("wpmudev-hide")})}),function(){function t(){var t=e(window).scrollTop(),i=e(".wpmudev-preview-anchor");i.length&&(i=i.offset().top,t>i?(e(".wpmudev-menu").addClass("wpmudev-preview-on"),e(".wpmudev-preview").addClass("wpmudev-preview-sticky"),e(".wpmudev-preview-anchor").height(e(".wpmudev-preview").outerHeight())):(e(".wpmudev-menu").removeClass("wpmudev-preview-on"),e(".wpmudev-preview").removeClass("wpmudev-preview-sticky"),e(".wpmudev-preview-anchor").height(0)))}e(function(){e(window).scroll(t),t()})}(),e("#wph-add-new-service-modal").each(function(){var t=e(this),i=(e("#wph-add-another-service"),t.find(".wpmudev-i_close")),s=t.find("#wph-cancel-add-service"),o=t.find(".wpmudev-box-modal");i.on("click",function(i){i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)}),s.on("click",function(i){i.preventDefault(),i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)})}),e("input#mailchimp_groups_instructions").each(function(){var t=e(this);t.val('<label class="wpmudev-label--notice">'+skbl+"</label>")}),e("#wph-edit-form-modal").each(function(){var t=e(this),i=(e("#wph-edit-form"),t.find(".wpmudev-i_close")),s=t.find("#wph-cancel-edit-form"),o=t.find(".wpmudev-box-modal");i.on("click",function(i){i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)}),s.on("click",function(i){i.preventDefault(),i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)})}),e("#wph-preview-modal").each(function(){var i=e(this),s=(e(".wpmudev-preview"),i.find(".hustle-modal"),i.find(".hustle-modal-success")),o=(i.find(".hustle-modal-close .hustle-icon"),i.find(".hustle-modal-cta")),n=i.find("a"),a=i.find("button");o.on("click",function(e){e.preventDefault()}),n.on("click",function(e){e.preventDefault()}),s.length?a.on("click",function(e){e.preventDefault(),s.addClass("hustle-modal-success_show"),Hustle.Events.trigger("modules.view.preview.success",t)}):a.on("click",function(e){e.preventDefault()})}),e(".wpmudev-table-body-row").each(function(){var t=e(this),i=t.find(".wpmudev-preview-item-manage");i.click(function(e){e.stopPropagation(),t.toggleClass("wpmudev-open")})}),e(".hustle-modal-three .hustle-modal-optin_form").each(function(){var t=e(this),i=t.find(".hustle-modal-optin_field"),s=e('<div class="hustle-modal-optin_half" />'),o=i.length;if(t.hasClass("hustle-modal-optin_groups")){t.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var n=0;n<o;n+=2)i.filter(":eq("+n+"),:eq("+(n+1)+")").wrapAll(s)}}),e(".hustle-modal-four .hustle-modal-optin_form").each(function(){var t=e(this),i=t.find(".hustle-modal-optin_field"),s=e('<div class="hustle-modal-optin_half" />'),o=i.length;if(t.hasClass("hustle-modal-optin_groups")){t.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var n=0;n<o;n+=2)i.filter(":eq("+n+"),:eq("+(n+1)+")").wrapAll(s)}}),console.log("view rendered"))});var t={allowClear:!1,containerCssClass:"wpmudev-select2",dropdownCssClass:"wpmudev-select2-dropdown",tags:"true",width:"100%",createTag:function(){return!1}};pagenow.indexOf("listing")!==-1&&(t.minimumResultsForSearch=-1);var i=function(){e(".wpmudev-select").wpmuiSelect(t)};i(),Hustle.Events.on("modules.view.select.render",function(e){i()})}(jQuery),Hustle.define("Delete_Confirmation",function(e){"use strict";return Backbone.View.extend({el:"#wph-delete-module-confirmation",opts:{id:"",multiple:0,ids:"",nonce:"",action:"",url:ajaxurl},events:{"click .hustle-delete-module-confirm":"confirm","click .hustle-delete-module-cancel":"cancel"},initialize:function(e){this.opts=_.extend({},this.opts,e)},confirm:function(t){t.preventDefault(),t.stopPropagation();var i=this,s=this.$(t.target);s.addClass("wpmudev-button-onload"),e.ajax({url:this.opts.url,type:"POST",data:{action:this.opts.action,_ajax_nonce:this.opts.nonce,id:this.opts.id,multiple:this.opts.multiple,ids:this.opts.ids},success:function(e){i.opts.onSuccess&&_.isFunction(i.opts.onSuccess)&&i.opts.onSuccess.call(this,e,i)}})},cancel:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass("wpmudev-modal-active")}})}),Hustle.define("Featured_Image_Holder",function(e){"use strict";return Backbone.View.extend({template:Optin.template("wph-popup-choose_image"),target_div:"",media_frame:!1,options:{attribute:"feature_image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},initialize:function(t){if(this.options=_.extend({},this.options,t),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");t.module_type&&(this.template=Optin.template("wph-"+t.module_type+"-choose_image")),this.target_div=t.target_div,e(document).on("click","button#wpmudev-feature-image-browse",e.proxy(this.open,this)),e(document).on("click",".wpmudev-feature-image-src-input_text",e.proxy(this.open,this)),e(document).on("click","button#wpmudev-feature-image-clear",e.proxy(this.clear,this)),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this.show_or_hide_clear_button(),this},show_or_hide_clear_button:function(){var e=this.model.get("feature_image");""===e||"undefined"==typeof e?(this.$el.find(".wpmudev-clear_image .wpmudev-button").hide(),this.$el.find(".wpmudev-feature-image-src-input_text").css("pointer-events","auto")):(this.$el.find(".wpmudev-clear_image .wpmudev-button").show(),this.$el.find(".wpmudev-feature-image-src-input_text").css("pointer-events","none"))},define_media_frame:function(){var e=this;this.media_frame=wp.media({title:e.options.title,button:{text:e.options.button_text},multiple:e.options.multiple}).on("select",function(){var t=e.media_frame.state().get("selection").first().toJSON();if(t&&t.url){var i=t.url,s="";t.sizes&&t.sizes.thumbnail&&t.sizes.thumbnail.url&&(s=t.sizes.thumbnail.url),e.target_div.find(".wpmudev-feature-image-src-input_text").val(i),e.target_div.find(".wpmudev-inserted_image").css("background-image","url("+s+")"),e.model.set("feature_image",i,{silent:!0}),e.show_or_hide_clear_button()}})},open:function(e){e.preventDefault(),this.media_frame.open()},clear:function(e){e.preventDefault(),this.target_div.find(".wpmudev-feature-image-src-input_text").val(""),this.target_div.find(".wpmudev-inserted_image").css("background-image","url()"),this.model.set("feature_image","",{silent:!0}),this.show_or_hide_clear_button()}})}),Hustle.define("Media_Holder",function(){"use strict";return Backbone.View.extend({template:Optin.template("hustle-media-holder-tpl"),media_frame:!1,options:{attribute:"image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},events:{"click .wph-media--add":"open","click .wph-button--dots":"toggle_options","click .i-close":"toggle_options","click .wpoi-swap-image-button":"swap_image","click .wpoi-delete-image-button":"delete_image"},initialize:function(e){if(this.options=_.extend({},this.options,e),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");jQuery(document).on("click",this.close_media_options),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this},define_media_frame:function(){var e=this,t=this.$(".wph-media--preview"),i=this.$(".wph-media--holder"),s=this.$(".wph-media--options");this.media_frame=wp.media({title:e.options.title,button:{text:e.options.button_text},multiple:e.options.multiple}).on("select",function(){var o=e.media_frame.state().get("selection").first().toJSON();o&&o.url&&(t.css("background-image","url({url})".replace("{url}",o.url)),i.addClass("has-image"),e.model.set(e.options.attribute,o.url),s.removeClass("hidden"),e.$(".wph-media--add").addClass("hidden"))})},open:function(e){e.preventDefault();var t=this.$(".wph-media--holder");t.removeClass("has-image"),this.media_frame.open()},toggle_options:function(){this.$("wph-media--list").toggleClass("wph-open"),this.$(".wph-media--items").toggleClass("hidden"),this.$(".svg-triangle").toggleClass("hidden")},close_media_options:function(e){var t=jQuery(e.target),i=t.closest(".wph-media--list");if(0===i.length&&!t.hasClass("wph-button wph-button--dots")){var s=jQuery(".wph-media--list"),o=s.find(".wph-media--items"),n=s.find(".svg-triangle");o.hasClass("hidden")||o.addClass("hidden"),n.hasClass("hidden")||n.addClass("hidden")}},swap_image:function(e){e.preventDefault(),this.media_frame&&(this.media_frame.open(),this.toggle_options())},delete_image:function(e){e.preventDefault();var t=this.$(".wph-media--preview");this.model.set(this.options.attribute,""),t.css("background-image","url('')"),this.toggle_options(),this.$(".wph-media--add").removeClass("hidden"),this.$(".wph-media--options").addClass("hidden")}})}),Hustle.define("Mixins.Model_Updater",function(e,t,i){"use strict";return{init_mix:function(){this.events=_.extend({},this.events,this._events),this.delegateEvents()},_events:{"change input[type='text']":"_update_text","change input[type='number']":"_update_text","change input[type='checkbox']":"_update_checkbox","change input[type=radio]":"_update_radios","change select":"_update_select"},_update_text:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,t.target.value,n))},_update_checkbox:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,i.is(":checked")?1:0,n))},_update_radios:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,t.target.value,n))},_update_select:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,i.val(),n))}}}),Hustle.define("Settings.Conditions_View",function(e){"use strict";return Hustle.View.extend({template:Optin.template("wph-wizard-module-conditions"),handle_tpl:Optin.template("wph-wizard-module-conditions-handle"),className:"wph-conditions",events:{"click .wph-conditions--side .wph-conditions--item:not(.disabled)":"toggle_condition","click .wph-conditions--side .wph-conditions--item:not(.disabled) span":"toggle_condition","click .wph-conditions--item header":"toggle_panel"},init:function(e){this.type=e.type,this.active_conditions={},this.listenTo(this.model,"change",this.toggle_empty_message),this.render()},render:function(){var e=this.model.toJSON();this.$el.html(this.template({type_name:this.type})),_.each(Optin.View.Conditions,function(t,i){var s=this.handle_tpl({label:this.get_label(i),id:i,cid:this.get_condition_cid(i),active_class:e[i]?"added":"",icon_class:e[i]?"wph-condition-remove":"wph-condition-add"});this.$(".wph-conditions--side .wph-conditions--items").append(s)},this),_.each(e,function(e,t){this.add_condition_panel(t)},this),this.toggle_empty_message()},get_condition_cid:function(e){return e=e.replace(/ /g,""),this.type+"_"+e},get_label:function(e){var t=optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type;return optin_vars.messages.conditions[e]?optin_vars.messages.conditions[e].replace("{type_name}",t):e},take_care_of_connected_conditions:function(e){e.disable&&e.disable.length&&_.each(e.disable,function(e,t){var i=this.$("#"+this.get_condition_cid(e));i.toggleClass("disabled")},this)},add_condition:function(e,t){var i=this.add_condition_panel(e);return t.addClass("added"),t.find("span").addClass("wpoi-remove"),t.find("span").removeClass("wpoi-add"),this.model.set(e,i.get_configs()),this.model.toJSON()},remove_condition:function(e,t,i){this.take_care_of_connected_conditions(t),t.off("change:update_label"),t.remove(),delete this.active_conditions[e],i.removeClass("added"),i.find("span").removeClass("wpoi-remove"),i.find("span").addClass("wpoi-add"),this.model.unset(e)},add_condition_panel:function(e){if("undefined"!=typeof Optin.View.Conditions[e]){var t=this.active_conditions[e]=new Optin.View.Conditions[e]({model:this.model,type:this.type});_.isEmpty(this.active_conditions)&&this.$(".wph-conditions--box .wph-conditions--items").html(""),this.take_care_of_connected_conditions(t);var i=this;return t.on("change:update_label",function(){i.trigger("change:update_view_label",i)}),this.$(".wph-conditions--box .wph-conditions--items").append(t.$el),t}},toggle_condition:function(e){e.stopPropagation();var t=this.$(e.target).data("id")||this.$(e.target).closest(".wph-conditions--item").data("id"),i=this.$("#"+this.get_condition_cid(t)),s=this.active_conditions[t];s?(this.remove_condition(t,s,i),this.trigger("condition_removed",this,t,s)):(this.add_condition(t,i),this.trigger("condition_added",this,t,s)),this.trigger("toggle_condition",this,t,s)},toggle_empty_message:function(){this.model.isEmpty()?this.$(".wph-conditions--box .wph-conditions--items").addClass("wph-conditions-is_empty"):this.$(".wph-conditions--box .wph-conditions--items").removeClass("wph-conditions-is_empty"),this.model.isEmpty()?this.$(".wph-conditions--empty").show():this.$(".wph-conditions--empty").hide()},toggle_panel:_.debounce(function(t){var i=e(t.target),s=i.closest(".wph-conditions--item"),o=s.find("section");o.slideToggle(300,function(){s.toggleClass("wph-conditions--closed wph-conditions--open")})},300),get_conditions_labels:function(){var e=_.pluck(this.active_conditions,"label"),t=Hustle.create_template("<span>{{label}}</span>");return e.length?e.map(function(e){return t({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere},get_all_conditions_labels:function(){var e=this.active_conditions,t={posts:{label:optin_vars.messages.condition_labels.all_posts},pages:{label:optin_vars.messages.condition_labels.all_pages},categories:{label:optin_vars.messages.condition_labels.all_categories},tags:{label:optin_vars.messages.condition_labels.all_tags}},i=[];for(var s in t)"undefined"==typeof e[s]&&i.push(t[s].label);var o=_.pluck(e,"label"),n=Hustle.create_template("<span>{{label}}</span>");return o=o.concat(i),o.length?o.map(function(e){return n({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere}})}),function(e){"use strict";Optin.View.Conditions=Optin.View.Conditions||{};var t=Hustle.View.extend({condition_id:"",className:"wph-conditions--item wph-conditions--open",_template:Optin.template("wph-wizard-module-conditions-item"),template:!1,_defaults:{type_name:"",condition_name:"",label:""},_events:{"change input":"change_input","change textarea":"change_input","change select":"change_input"},init:function(t){return this.type=t.type,this.id=this.type+"-"+this.condition_id,this.template="undefined"!=typeof this.cpt?Optin.template("wpoi-condition-post_type"):Optin.template("wpoi-condition-"+this.condition_id),this._defaults={type_name:optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type,condition_name:optin_vars.messages.conditions[this.condition_id]?optin_vars.messages.conditions[this.condition_id]:this.condition_id},this.data=this.get_data(),this.render(),this.events=e.extend(!0,{},this.events,this._events),this.delegateEvents(),this.on_init&&_.isFunction(this.on_init)&&this.on_init.apply(this,arguments),this},get_data:function(){return _.extend({},this._defaults,this.defaults,this.model.get(this.condition_id),{type:this.type})},get_title:function(){return this.title.replace("{type_name}",this.data.type_name)},get_body:function(){return"function"==typeof this.body?this.body.apply(this,arguments):this.body.replace("{type_name}",this.data.type_name)},get_header:function(){return""},render:function(){this.$el.html("");var t=this._template(_.extend({},{title:this.get_title(),body:this.get_body(),header:this.get_header()},this._defaults,{type:this.type}));return this.$el.html(t),e(".wph-conditions--box .wph-conditions--item:not(:last-child)").removeClass("wph-conditions--open").addClass("wph-conditions--closed"),e(".wph-conditions--box .wph-conditions--item:not(:last-child) section").hide(),this.rendered&&"function"==typeof this.rendered&&this.rendered.apply(this,arguments),this},update_attribute:function(e,t){this.data=this.model.get(this.condition_id),this.data[e]=t,this.model.set(this.condition_id,this.data)},get_attribute:function(e){var t=this.model.get(this.condition_id);return!(!t||!t[e])&&t[e]},refresh_label:function(){this.$el.find(".wph-condition--preview").html("");var e=this.get_header();this.$el.find(".wph-condition--preview").html(e)},change_input:function(t){var i=t.target,s=i.getAttribute("data-attribute"),o=e(i),n=o.is(".js-wpoi-select")?o.val():t.target.value;if(o.is(".select2-search__field"))return!1;var a=this.update_attribute(s,n);return this.refresh_label(),a},get_configs:function(){return this.defaults||!0}}),i=function(t){e(".wph-conditions--items").data("select2ScrollPosition",{})},s=function(t){var i=["all"];t.params&&t.params.args&&t.params.args.data&&t.params.args.data.id&&"all"===t.params.args.data.id||(i=e(this).val(),i&&-1!==i.indexOf("all")?i.splice(i.indexOf("all"),1):i=(i||[]).concat([t.params.args.data.id]),i&&i.length||(i=[t.params.args.data.id])),e(this).val(i).trigger("change")},o={events:{"change input[type='radio']":"set_current_li"},set_current_li:function(t){var i=e(t.target),s=i.closest("li");s.siblings().removeClass("current"),s.toggleClass("current",i.is(":checked"))}};Optin.View.Conditions.posts=t.extend(_.extend({},o,{condition_id:"posts",title:optin_vars.messages.conditions.posts,label:optin_vars.messages.condition_labels.posts,defaults:{filter_type:"only",posts:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("posts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.get_attribute("posts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},update_label:function(){this.get_attribute("posts").length&&!_.contains(this.get_attribute("posts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length?this.get_attribute("posts").length:0):_.contains(this.get_attribute("posts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.pages=t.extend(_.extend({},o,{condition_id:"pages",title:optin_vars.messages.conditions.pages,label:optin_vars.messages.condition_labels.pages,defaults:{filter_type:"only",pages:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("pages"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.get_attribute("pages").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages;
},update_label:function(){this.get_attribute("pages").length&&!_.contains(this.get_attribute("pages"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length?this.get_attribute("pages").length:0):_.contains(this.get_attribute("pages"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}})),_.each(optin_vars.post_types,function(e,n){var a=e.label.toLowerCase();Optin.View.Conditions[e.label]=t.extend(_.extend({},o,{condition_id:e.label,title:e.label,label:optin_vars.messages.condition_labels.posts,cpt:!0,defaults:{filter_type:"only",selected_cpts:[],post_type:n,post_type_label:e.label},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("selected_cpts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+a:optin_vars.messages.condition_labels.no+" "+a:this.get_attribute("selected_cpts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length).replace("posts",a):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+a:optin_vars.messages.condition_labels.all+" "+a},update_label:function(){this.get_attribute("selected_cpts").length&&!_.contains(this.get_attribute("selected_cpts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length?this.get_attribute("selected_cpts").length:0).replace("posts",a):_.contains(this.get_attribute("selected_cpts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+a:optin_vars.messages.condition_labels.no+" "+a:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+a:optin_vars.messages.condition_labels.all+" "+a},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}}))}),Optin.View.Conditions.categories=t.extend(_.extend({},o,{condition_id:"categories",title:optin_vars.messages.conditions.categories,label:optin_vars.messages.condition_labels.categories,defaults:{filter_type:"only",categories:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("categories"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.get_attribute("categories").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},update_label:function(){this.get_attribute("categories").length&&!_.contains(this.get_attribute("categories"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length?this.get_attribute("categories").length:0):_.contains(this.get_attribute("categories"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.tags=t.extend(_.extend({},o,{condition_id:"tags",title:optin_vars.messages.conditions.tags,label:optin_vars.messages.condition_labels.tags,defaults:{filter_type:"only",tags:[]},on_init:function(){this.listenTo(this.model,"change",this.render),this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("tags"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.get_attribute("tags").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},update_label:function(){this.get_attribute("tags").length&&!_.contains(this.get_attribute("tags"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length?this.get_attribute("tags").length:0):_.contains(this.get_attribute("tags"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.only_on_not_found=t.extend({condition_id:"only_on_not_found",title:optin_vars.messages.conditions.only_on_not_found,label:optin_vars.messages.condition_labels.only_on_not_found,body:optin_vars.messages.conditions_body.only_on_not_found}),Optin.View.Conditions.visitor_logged_in=t.extend({condition_id:"visitor_logged_in",disable:["visitor_not_logged_in"],title:optin_vars.messages.conditions.visitor_logged_in,label:optin_vars.messages.condition_labels.visitor_logged_in,body:optin_vars.messages.conditions_body.visitor_logged_in}),Optin.View.Conditions.visitor_not_logged_in=t.extend({condition_id:"visitor_not_logged_in",disable:["visitor_logged_in"],title:optin_vars.messages.conditions.visitor_not_logged_in,label:optin_vars.messages.condition_labels.visitor_not_logged_in,body:optin_vars.messages.conditions_body.visitor_not_logged_in}),Optin.View.Conditions.shown_less_than=t.extend({condition_id:"shown_less_than",title:optin_vars.messages.conditions.shown_less_than,label:optin_vars.messages.condition_labels.shown_less_than,defaults:{less_than:1},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.only_on_mobile=t.extend({condition_id:"only_on_mobile",disable:["not_on_mobile"],title:optin_vars.messages.conditions.only_on_mobile,label:optin_vars.messages.condition_labels.only_on_mobile,body:optin_vars.messages.conditions_body.only_on_mobile}),Optin.View.Conditions.not_on_mobile=t.extend({condition_id:"not_on_mobile",disable:["only_on_mobile"],title:optin_vars.messages.conditions.not_on_mobile,label:optin_vars.messages.condition_labels.not_on_mobile,body:optin_vars.messages.conditions_body.not_on_mobile}),Optin.View.Conditions.from_specific_ref=t.extend({condition_id:"from_specific_ref",disable:["not_from_specific_ref"],title:optin_vars.messages.conditions.from_specific_ref,label:optin_vars.messages.condition_labels.from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_specific_ref=t.extend({condition_id:"not_from_specific_ref",disable:["from_specific_ref"],title:optin_vars.messages.conditions.not_from_specific_ref,label:optin_vars.messages.condition_labels.not_from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_internal_link=t.extend({condition_id:"not_from_internal_link",title:optin_vars.messages.conditions.not_from_internal_link,label:optin_vars.messages.condition_labels.not_from_internal_link,body:optin_vars.messages.conditions_body.not_from_internal_link}),Optin.View.Conditions.from_search_engine=t.extend({condition_id:"from_search_engine",title:optin_vars.messages.conditions.from_search_engine,label:optin_vars.messages.condition_labels.from_search_engine,body:optin_vars.messages.conditions_body.from_search_engine}),Optin.View.Conditions.on_specific_url=t.extend({condition_id:"on_specific_url",disable:["not_on_specific_url"],title:optin_vars.messages.conditions.on_specific_url,label:optin_vars.messages.condition_labels.on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_on_specific_url=t.extend({condition_id:"not_on_specific_url",disable:["on_specific_url"],title:optin_vars.messages.conditions.not_on_specific_url,label:optin_vars.messages.condition_labels.not_on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.visitor_has_commented=t.extend({condition_id:"visitor_has_commented",disable:["visitor_has_never_commented"],title:optin_vars.messages.conditions.visitor_has_commented,label:optin_vars.messages.condition_labels.visitor_has_commented,body:optin_vars.messages.conditions_body.visitor_has_commented}),Optin.View.Conditions.visitor_has_never_commented=t.extend({condition_id:"visitor_has_never_commented",disable:["visitor_has_commented"],title:optin_vars.messages.conditions.visitor_has_never_commented,label:optin_vars.messages.condition_labels.visitor_has_never_commented,body:optin_vars.messages.conditions_body.visitor_has_never_commented}),Optin.View.Conditions.in_a_country=t.extend({condition_id:"in_a_country",disable:["not_in_a_country"],title:optin_vars.messages.conditions.in_a_country,label:optin_vars.messages.condition_labels.in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",i).on("select2:unselecting",i)}}),Optin.View.Conditions.not_in_a_country=t.extend({condition_id:"not_in_a_country",disable:["in_a_country"],title:optin_vars.messages.conditions.not_in_a_country,label:optin_vars.messages.condition_labels.not_in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",i).on("select2:unselecting",i)}})}(jQuery),Hustle.define("Settings.Display_Triggers_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-settings-display-triggers-tpl"),events:{"click .tabs-header label":"change_tab"},init:function(e){this.type=e.type,this.listenTo(this.model,"change:on_adblock",this.hide_adblock_options_on_toggle),this.render()},render:function(){return this.$el.html(this.template(this.get_data())),this.hide_adblock_options_on_toggle(),this},get_data:function(){var e={};return e.type=this.type,_.extend({},e,this.model.toJSON())},change_tab:function(e){e.preventDefault();var t=this.$(e.target),i=t.parent("li"),s=this.$(t.attr("href")),o=t.find("input[type='radio']");this.$(".tabs-header li").removeClass("current"),this.$(".tabs-content").removeClass("current"),i.addClass("current"),s.addClass("current"),o.prop("checked",!0),this.model.set("trigger",o.val())},hide_adblock_options_on_toggle:function(){_.isTrue(this.model.get("on_adblock"))?this.$(".wpoi-popup-trigger-on-adblock-option").show():this.$(".wpoi-popup-trigger-on-adblock-option").hide()}}))}),Hustle.define("Settings.Modules_Activity",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-activity",events:{"change .hustle-for-admin-user-toggle":"toggle_for_user","change .hustle-for-logged-in-user-toggle":"toggle_for_user"},initialize:function(){},toggle_for_user:function(t){var i=this.$(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("user");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_for_user",id:s,_ajax_nonce:o,user_type:n},complete:function(e,t){i.attr("disabled",!1)},success:function(e){e.success||i.prop("checked",!i.is(":checked"))},error:function(){i.prop("checked",!i.is(":checked"))}})}})}),Hustle.define("Settings.Services_Edit_Modal",function(e){"use strict";return Backbone.View.extend({template:Hustle.template("wph-edit-provider-modal-tpl"),id:"wph-edit-provider-modal",events:{"click .i-close":"close","click .js-wph-button-cancel":"close","change #wph-provider-edit-modal-provider":"get_provider_options","click #wph-edit-service-save":"save_settings","submit form":"save_settings"},provider_options_nonce:!1,initialize:function(){this.render()},render:function(){var t=this;this.$el.html(this.template()).appendTo("body"),e.ajax({url:ajaxurl,type:"get",data:{action:"hustle_get_providers_edit_modal_content",id:t.model.get("id"),source:t.model.get("source"),_ajax_nonce:t.model.get("nonce")},success:function(e){e.success&&(t.$(".wph-edit-provider-modal-content").html(e.data.html),t.provider_options_nonce=e.data.provider_options_nonce,Hustle.Events.trigger("view.rendered",t))}})},get_provider_options:function(t){var i=this,s=this.$(t.target),o=this.$("#optin_new_provider_account_details"),n=this.$("#optin_new_provider_account_options");o.empty(),n.empty(),e.ajax({url:ajaxurl,type:"get",data:{action:"render_provider_account_options",provider_id:s.val(),_ajax_nonce:i.provider_options_nonce,optin:i.model.get("id")},success:function(e){e.success&&(o.html(e.data),Hustle.Events.trigger("view.rendered",i))}})},close:function(e){e.preventDefault(),this.remove()},hide:function(){},show:function(){},save_settings:function(t){t.preventDefault();var i=this.$(t.target),s=i.data("nonce"),o=this.$("#wph-provider-edit-modal-provider"),n=i.closest("form");e.ajax({url:ajaxurl,type:"post",data:{action:"hustle_save_providers_edit_modal",provider_id:o.val(),_ajax_nonce:s,id:this.model.get("id"),source:this.model.get("source"),form:n.serialize()},success:function(e){}})}})}),Hustle.define("Settings.Services",function(e){"use strict";return Backbone.View.extend({el:"#providers-edit-box",Modal_View:Hustle.get("Settings.Services_Edit_Modal"),modal:!1,events:{"click .wph-providers-edit":"open_edit_modal"},open_edit_modal:function(e){var t=this.$(e.target),i=t.data("id"),s=t.data("source"),o=t.data("nonce");this.modal=new this.Modal_View({model:new Backbone.Model({id:i,nonce:o,source:s})})}})}),function(e,t){"use strict";e(document).on("click",".wpoi-listing-wrap header.can-open .toggle, .wpoi-listing-wrap header.can-open .toggle-label",function(e){e.stopPropagation()}),e(".accordion header .optin-delete-optin, .accordion header .edit-optin, .wpoi-optin-details tr .button-edit").hide().css({transition:"none"}),e(document).on({mouseenter:function(){var t=e(this);t.find(".optin-delete-optin, .edit-optin").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".toggle-checkbox").removeProp("disabled"),t.find(".edit-optin").removeProp("disabled"),t.removeClass("disabled"),t.find(".optin-delete-optin, .edit-optin, .delete-optin-confirmation").stop().fadeOut("fast")}},".accordion header"),e(document).on({mouseenter:function(){var t=e(this);t.find(".button-edit").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".button-edit").stop().fadeOut("fast")}},".wpoi-optin-details tr"),e(document).on("click",".wpoi-tabs-menu a",function(t){t.preventDefault();var i=e(this).attr("tab");Optin.router.navigate(i,!0)}),e(document).on("click",".edit-optin",function(t){t.stopPropagation(),t.preventDefault(),window.location.href=e(this).attr("href")}),e(document).on("click",".wpoi-type-edit-button",function(t){t.preventDefault();var i=e(this).data("id"),s=e(this).data("type");window.location.href="admin.php?page=inc_optin&optin="+i+"#display/"+s}),e(document).on("click","*[for]",function(t){var i=e(this),s=i.attr("for"),o=e("#"+s);!i.is("label")&&o.length&&(o.trigger("change"),o.trigger("click"))}),e("#wpoi-complete-message").fadeIn(),e(document).on("click","#wpoi-complete-message .next-button button",function(t){e("#wpoi-complete-message").fadeOut()}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap header.can-open",function(t){e(this).find(".open").trigger("click")}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap .can-open .open",function(t){t.stopPropagation();var i=e(this),s=i.closest(".wpoi-listing-wrap"),o=s.find("section"),n=e(".wpoi-listing-wrap").not(s),a=e(".wpoi-listing-wrap section").not(o);a.slideUp(300,function(){a.removeClass("open")}),n.find(".dev-icon").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),o.slideToggle(300,function(){s.toggleClass("open"),s.find(".dev-icon").toggleClass("dev-icon-caret_up dev-icon-caret_down")})}),Optin.decorate_number_inputs=function(t){var i=t&&t.$el?t.$el.find(".wph-input--number input"):e(".wph-input--number input"),s=Hustle.create_template('<div class="wph-nbr--nav"><div class="wph-nbr--button wph-nbr--up {{disabled}}">+</div><div class="wph-nbr--button wph-nbr--down {{disabled}}">-</div></div>');i.each(function(){var t=e(this),i=t.is(":disabled")?"disabled":"";t.siblings(".wph-nbr--nav").length||t.after(s({disabled:i}))})},Hustle.Events.on("view.rendered",Optin.decorate_number_inputs),function(){e(document).on("click",".wph-nbr--up:not(.disabled)",function(t){var i,s=e(this),o=s.closest(".wph-input--number"),n=o.find("input"),a=parseFloat(n.val()),l=(n.attr("min"),n.attr("max"));i=a>=l?a:a+1,i!==a&&n.val(i).trigger("change")}),e(document).on("click",".wph-nbr--down:not(.disabled)",function(t){var i,s=e(this),o=s.closest(".wph-input--number"),n=o.find("input"),a=parseFloat(n.val()),l=n.attr("min");n.attr("max");i=a<=l?a:a-1,i!==a&&n.val(i).trigger("change")})}(),function(){function t(){var t=e(window).scrollTop(),i=e(".wph-sticky--anchor");i.length&&(i=i.offset().top,t>i?(e(".wph-preview--eye").addClass("wph-sticky--element"),e(".wph-sticky--anchor").height(e(".wph-preview--eye").outerHeight())):(e(".wph-preview--eye").removeClass("wph-sticky--element"),e(".wph-sticky--anchor").height(0)))}e(function(){e(window).scroll(t),t()})}()}(jQuery,document),function(e){"use strict";Optin.Provider=function(t){var i=this;return _.extend(this,{id:!1,provider_args:{},errors:{},render_in_previewr:_.noop,init:_.noop,add_args:function(){i.id===Optin.step.services.model.get("optin_provider")&&_.each(i.provider_args,function(t,i){var s=e(t);s.length&&(s=s.val().trim(),Optin.step.services.provider_args.set(i,s))})},clear_provider_args:function(){i.id===Optin.step.services.model.previousAttributes().optin_provider&&i.id!==Optin.step.services.model.get("optin_provider")&&Optin.step.services.provider_args.clear({silent:!0})},validate:function(){var t=[];return _.each(i.provider_args,function(s,o){var n=e(s),a=e("<span></span>");n.length>0&&""===n.val().trim()&&(t.push(i.errors[o]),a.attr("title",i.errors[o].message),n.addClass("wpoi-error"),n.after(a),_.defer(function(){a.addClass("dashicons dashicons-warning "+i.errors[o].iconClass)}))}),_(t)},check_module_field:function(t,i,s){e.getJSON(window.ajaxurl,{action:"add_module_field",provider:this.id,_wpnonce:optin_vars.get_module_field_nonce,optin_id:i,field:t},s).fail(function(){var e={error:!0};s&&s(e)})},validate_custom_field:function(t,i,s){i.$(".dashicons-warning").remove(),i.$("[name]").prop("disabled",!0),this.check_module_field(t,s,function(s){if(i.$("[name]").prop("disabled",!1),s.success)i.options=t,i._updateOptions();else{var o=e('<span class="dashicons dashicons-warning">'),n="custom"!==s.data.code?optin_vars.messages.module_fields[s.data.code]:s.data.message;o.attr("title",n),i.$('[name="label"]').before(o)}})},add_module_field:function(t,i,s){var o=i.$(".wph-add-new-field","#wpoi-module-field-maker");o.addClass("wp-button-save--loading"),o.prop("disabled",!0),this.check_module_field(t,s,function(s){if(o.prop("disabled",!1),s.success)t=s.data.field,i._add_module_field(t);else{var n=e('<span class="dashicons dashicons-warning">'),a="custom"!==s.data.code?optin_vars.messages.module_fields[s.data.code]:s.data.message;n.attr("title",a),o.before(n)}})}},t),this.init(),Optin.Events.on("services:validate:after",e.proxy(this,"add_args")),Optin.Events.on("design:preview:render:start",e.proxy(this,"clear_provider_args")),Optin.Events.on("optin:add_module_field_"+this.id,e.proxy(this,"add_module_field")),Optin.Events.on("optin:update_module_field_"+this.id,e.proxy(this,"validate_custom_field")),this}}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("activecampaign",function(t){return new Optin.Provider({id:"activecampaign",provider_args:{enabled:0},default_data:{enabled:!1,api_key:"",url:""},errors:{email_list:{name:"email_provider_lists",iconClass:"dashicons-warning-account_name"}},show_selected:function(){if(t.editing_service===this.id){var i=t.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("activecampaign"in i){var n="list_name"in i.activecampaign?i.activecampaign.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof i.activecampaign.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",i.activecampaign.api_key)},500),"undefined"!=typeof i.activecampaign.url&&setTimeout(function(){e('input[name="optin_url"]').attr("value",i.activecampaign.url)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_api_key"]').val(),s=!!t.model.get("email_services").activecampaign&&t.model.get("email_services").activecampaign.enabled,o=e('input[name="optin_url"]').val(),n=e('select[name="optin_email_list"]'),a=n.val(),l=n.find("option:selected").text(),d={api_key:i,enabled:s,url:o,list_id:a,list_name:l,desc:i},r=_.extend(t.activecampaign.provider_args,d);t.activecampaign.provider_args=r,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e,t,i){"use strict";Optin.Mixins.add_services_mixin("constantcontact",function(s){return new Optin.Provider({id:"constantcontact",provider_args:{enabled:0},show_selected:function(){if(s.service_supports_fields=!1,s.editing_service===this.id){var t=s.model.get("email_services"),i=e("#optin-provider-account-selected-list"),o=i.find(".wpmudev-label--notice span");if("constantcontact"in t){var n="list_name"in t.constantcontact?t.constantcontact.list_name:"";o.length&&o.html(window.optin_vars.messages.providers.no_fetch_list.replace("campaign","<strong>"+n+"</strong>"))}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e(".constantContact_optin_email_list"),s=!!t.model.get("email_services").constantcontact&&t.model.get("email_services").constantcontact.enabled,o=i.val(),n=i.find("option:selected").text(),a={list_id:o,enabled:s,list_name:n,desc:n},l=_.extend(t.constantcontact.provider_args,a);t.constantcontact.provider_args=l,Hustle.Events.trigger("optin.service.saved",t)}},mark_updated:function(){s.is_service_modal_updated=!0},init:function(){var s=function(){var t,s,o=e(this),n=o.data("optin"),a=o.attr("href");if(!n){var l=e(".next-button button.wph-button-save","#wpoi-wizard-services");l.trigger("click"),t=setInterval(function(){n=Optin.step.services.model.get("optin_id"),parseInt(n)>0&&(clearInterval(t),s={optin_id:n,_wpnonce:window.optin_vars.constantcontact_nonce,action:"update_constantcontact_referrer"},e.get(ajaxurl,s),_.delay(function(){i.location=a},300))},100)}};e(t).on("click",".constantcontact-authorize",s),e(t).on("change",".constantContact_optin_email_list",this.mark_updated),Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document,window),function(e){"use strict";Optin.Mixins.add_services_mixin("convertkit",function(t){return new Optin.Provider({id:"convertkit",provider_args:{enabled:0},default_data:{enabled:!1,api_key:"",api_secret:""},errors:{api_secret:{name:"optin_api_secret",message:optin_vars.messages.convertkit.enter_api_secret,iconClass:"dashicons-warning-account_name"}},show_selected:function(){if(t.editing_service===this.id){var i=t.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("convertkit"in i){var n="list_name"in i.convertkit?i.convertkit.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof i.convertkit.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",i.convertkit.api_key)},500),"undefined"!=typeof i.convertkit.api_secret&&setTimeout(function(){e('input[name="optin_api_secret"]').attr("value",i.convertkit.api_secret)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_api_key"]').val(),s=e('input[name="optin_api_secret"]').val(),o=!!t.model.get("email_services").convertkit&&t.model.get("email_services").convertkit.enabled,n=e('select[name="optin_email_list"]'),a=n.val(),l=n.find("option:selected").text(),d={api_key:i,enabled:o,api_secret:s,list_id:a,list_name:l,desc:i},r=_.extend(t.convertkit.provider_args,d);t.convertkit.provider_args=r,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e,t){"use strict";Optin.Mixins.add_services_mixin("e_newsletter",function(i){return new Optin.Provider({id:"e_newsletter",provider_args:{enabled:0},default_data:{enabled:!1,auto_optin:!1,synced:!1},show_selected:function(){i.editing_service!==this.id},update_args:function(t){if(i.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var s=!!t.model.get("email_services").e_newsletter&&t.model.get("email_services").e_newsletter.enabled,o=e('input[name="optin_auto_optin"]').is(":checked"),n=(e('input[name="optin_email_list"]'),""),a=e('input[name="synced"]').val(),l=new Array;e('input[name="optin_email_list"]:checked').each(function(){l.push(e(this).val())}),n=l,o=o?"subscribed":"pending";var d={auto_optin:o,enabled:s,list_id:n,synced:a},r=_.extend(t.e_newsletter.provider_args,d);t.e_newsletter.provider_args=r,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){var s=function(e){i.is_service_modal_updated=!0},o=function(e){i.is_service_modal_updated=!0};e(t).on("change","input[name='optin_auto_optin']",s),e(t).on("change","input[name='optin_email_list']",o),Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e,t,i){"use strict";Optin.Mixins.add_services_mixin("hubspot",function(s){return new Optin.Provider({id:"hubspot",provider_args:{enabled:0},show_selected:function(){if(s.editing_service===this.id){var t=s.model.get("email_services"),i=e("#optin-provider-account-selected-list"),o=i.find(".wpmudev-label--notice span");if("hubspot"in t){var n="list_name"in t.hubspot?t.hubspot.list_name:"";o.length&&o.html(window.optin_vars.messages.providers.no_fetch_list.replace("campaign","<strong>"+n+"</strong>"))}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('select[name="optin_email_list"]'),s=!!t.model.get("email_services").hubspot&&t.model.get("email_services").hubspot.enabled,o=i.val(),n=i.find("option:selected").text(),a={list_id:o,enabled:s,list_name:n,desc:n},l=_.extend(t.hubspot.provider_args,a);t.hubspot.provider_args=l,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){var s=function(){var t,s,o=e(this),n=o.data("optin"),a=o.attr("href");if(!n){var l=e(".next-button button.wph-button-save","#wpoi-wizard-services");l.trigger("click"),t=setInterval(function(){n=Optin.step.services.model.get("optin_id"),parseInt(n)>0&&(clearInterval(t),s={optin_id:n,_wpnonce:window.optin_vars.hubspot_nonce,action:"update_hubspot_referrer"},e.get(ajaxurl,s),_.delay(function(){i.location=a},300))},100)}};e(t).on("click",".hubspot-authorize",s),Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document,window),function(e,t){"use strict";Optin.Mixins.add_services_mixin("icontact",function(t){return new Optin.Provider({id:"icontact",provider_args:{enabled:0},default_data:{enabled:!1,username:"",password:""},show_selected:function(){if(t.editing_service===this.id){var i=t.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("icontact"in i){var n="list_name"in i.v?i.icontact.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof i.icontact.app_id&&setTimeout(function(){e('input[name="optin_app_id"]').attr("value",i.icontact.app_id)},500),"undefined"!=typeof i.icontact.username&&setTimeout(function(){e('input[name="optin_username"]').attr("value",i.icontact.username)},500),"undefined"!=typeof i.icontact.password&&setTimeout(function(){e('input[name="optin_password"]').attr("value",i.icontact.password)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_app_id"]').val(),s=e('input[name="optin_username"]').val(),o=!!t.model.get("email_services").icontact&&t.model.get("email_services").icontact.enabled,n=e('input[name="optin_password"]').val(),a=e('select[name="optin_email_list"]'),l=a.val(),d=a.find("option:selected").text(),r={app_id:i,username:s,enabled:o,password:n,list_id:l,list_name:d,desc:i},c=_.extend(t.icontact.provider_args,r);t.icontact.provider_args=c,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this));
}})})}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("infusionsoft",function(t){return new Optin.Provider({id:"infusionsoft",provider_args:{enabled:0},default_data:{enabled:!1,api_key:"",account_name:""},show_selected:function(){if(t.editing_service===this.id){var i=t.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("infusionsoft"in i){var n="list_name"in i.infusionsoft?i.infusionsoft.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof i.infusionsoft.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",i.infusionsoft.api_key)},500),"undefined"!=typeof i.infusionsoft.account_name&&setTimeout(function(){e('input[name="optin_account_name"]').attr("value",i.infusionsoft.account_name)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_api_key"]').val(),s=e('input[name="optin_account_name"]').val(),o=!!t.model.get("email_services").infusionsoft&&t.model.get("email_services").infusionsoft.enabled,n=e('select[name="optin_email_list"]'),a=n.val(),l=n.find("option:selected").text(),d={api_key:i,account_name:s,enabled:o,list_id:a,list_name:l,desc:i},r=_.extend(t.infusionsoft.provider_args,d);t.infusionsoft.provider_args=r,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("mad_mimi",function(t){return new Optin.Provider({id:"mad_mimi",provider_args:{enabled:0},default_data:{enabled:!1,api_key:"",username:""},errors:{email_list:{name:"email_provider_lists",iconClass:"dashicons-warning-account_name"}},show_selected:function(){if(t.service_supports_fields=!1,t.editing_service===this.id){var i=t.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("mad_mimi"in i){var n="list_name"in i.mad_mimi?i.mad_mimi.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof i.mad_mimi.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",i.mad_mimi.api_key)},500),"undefined"!=typeof i.mad_mimi.username&&setTimeout(function(){e('input[name="optin_username"]').attr("value",i.mad_mimi.username)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_api_key"]').val(),s=e('input[name="optin_username"]').val(),o=!!t.model.get("email_services").mad_mimi&&t.model.get("email_services").mad_mimi.enabled,n=e('select[name="optin_email_list"]'),a=n.val(),l=n.find("option:selected").text(),d={api_key:i,username:s,enabled:o,list_id:a,list_name:l,desc:i},r=_.extend(t.mad_mimi.provider_args,d);t.mad_mimi.provider_args=r,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e,t){"use strict";Optin.Mixins.add_services_mixin("mailchimp",function(i){return new Optin.Provider({id:"mailchimp",provider_args:{enabled:0},default_data:{enabled:!1,api_key:"",auto_optin:!1},errors:{email_list:{name:"email_provider_lists",iconClass:"dashicons-warning-account_name"}},show_selected:function(){if(i.editing_service===this.id){var t=i.model.get("email_services"),s=Optin.template("wpmudev-mailchimp-group-args-tpl"),o={},n=e("#optin-provider-account-selected-list"),a=n.find(".wpmudev-label--notice span");if("mailchimp"in t){var l="list_name"in t.mailchimp?t.mailchimp.list_name:"";if("undefined"!=typeof t.mailchimp.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",t.mailchimp.api_key)},500),a.length&&a.html(a.text().replace("campaign","<strong>"+l+"</strong>")),"undefined"==typeof t.mailchimp.list_id||"undefined"==typeof n.data("nonce"))return;o.list_id=t.mailchimp.list_id,o.group=t.mailchimp.group,o._ajax_nonce=n.data("nonce"),o.action="hustle_mailchimp_get_current_settings",e.get(ajaxurl,o).done(function(e){if(e&&e.success){var i=e.data.group,o=new Array,a=t.mailchimp.group_interest,l=new Array;null!==i&&(_.each(i.interests,function(e){o.push(e.name),"undefined"!=typeof a&&a.indexOf(e.id)!==-1&&l.push(e.name)}),n.append(s({name:i.title,type:i.type,options:o.join(", "),selected:l.join(", ")})))}})}}},update_args:function(t){if(i.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var s=e('input[name="optin_api_key"]').val(),o=e('input[name="optin_auto_optin"]').is(":checked"),n=!!t.model.get("email_services").mailchimp&&t.model.get("email_services").mailchimp.enabled,a=e('select[name="optin_email_list"]'),l=a.val(),d=a.find("option:selected").text(),r=e('select[name="mailchimp_groups"]'),c=r.val(),u=r.find("option:selected").text(),p="";if("-1"!==c)if(u.toLowerCase().indexOf("radio")!==-1){var m=e('input[name="mailchimp_groups_interests"]:checked').val();"undefined"!=typeof m&&(p=m)}else if(u.toLowerCase().indexOf("checkboxes")!==-1){var h=new Array;e('input[name="mailchimp_groups_interests[]"]:checked').each(function(){h.push(e(this).val())}),p=h}else p=e('select[name="mailchimp_groups_interests"]').val();o=o?"subscribed":"pending";var v={api_key:s,auto_optin:o,enabled:n,list_id:l,list_name:d,group:c,group_interest:p,desc:s},g=_.extend(t.mailchimp.provider_args,v);t.mailchimp.provider_args=g,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){var s=function(t){var s=e(t.target),o=e("#wph-optin-service-details-form"),n=e(".wph-optin-list-groups"),a=e(".wph-optin-list-group-interests-wrap"),l=e(".mailchimp_optin_load_more_lists"),d=_.reduce(o.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});d.action="hustle_mailchimp_get_list_groups",d._ajax_nonce=s.data("nonce"),a.empty(),n.html(e("#wpoi-loading-indicator").html()),l.hide(),e.get(ajaxurl,d).done(function(e){e&&(e.success?(n.html(e.data),l.show(),Hustle.Events.trigger("modules.view.rendered",i)):(l.hide(),n.empty()))})},o=function(t){var s=e(".wph-optin-list-group-interests-wrap"),o=e(t.target),n=e("#wph-optin-service-details-form"),a=_.reduce(n.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});return["-1","0"].indexOf(t.target.value)!==-1?void s.empty():(s.html(e("#wpoi-loading-indicator").html()),a._ajax_nonce=o.data("nonce"),a.action="hustle_mailchimp_get_group_interests",void e.get(ajaxurl,a).done(function(e){e&&e.success&&(s.html(e.data.html),s.find(".wpoi-leave-group-intrests-blank-radios").click(function(e){e.preventDefault(),s.find('input[name="mailchimp_groups_interests"]').prop("checked",!1)}),Hustle.Events.trigger("modules.view.rendered",i)),e&&!e.success&&s.empty()}).fail(function(e){}))},n=function(t){var s=e(t.target),o=s.closest("form"),n=o.serialize(),a=e("#optin-provider-account-options");a.html(e("#wpoi-loading-indicator").html()),n+="&action=refresh_provider_account_details&load_more=true",n+="&optin=mailchimp",e.post(ajaxurl,n,function(e){e.success===!0?(e.data.redirect_to?window.location.href=e.data.redirect_to:e.data?a.html(e.data):a.html(optin_vars.messages.something_went_wrong),Hustle.Events.trigger("modules.view.rendered",i)):e.data?a.html(e.data):a.html(optin_vars.messages.something_went_wrong)}).fail(function(e){a.html(optin_vars.messages.something_went_wrong)})},a=function(e){i.is_service_modal_updated=!0};e(t).on("change",".mailchimp_optin_email_list",s),e(t).on("change","#mailchimp_groups",o),e(t).on("change","input[name='optin_api_key']",a),e(t).on("click",".mailchimp_optin_load_more_lists",n),Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e,t){"use strict";Optin.Mixins.add_services_mixin("mautic",function(i){return new Optin.Provider({id:"mautic",provider_args:{enabled:0},default_data:{enabled:!1,url:"",username:"",password:""},show_selected:function(){if(i.editing_service===this.id){var t=i.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("mautic"in t){var n="list_name"in t.mautic?t.mautic.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof t.mautic.url&&setTimeout(function(){e('input[name="optin_url"]').attr("value",t.mautic.url)},500),"undefined"!=typeof t.mautic.username&&setTimeout(function(){e('input[name="optin_username"]').attr("value",t.mautic.username)},500),"undefined"!=typeof t.mautic.password&&setTimeout(function(){e('input[name="optin_password"]').attr("value",t.mautic.password)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_url"]').val(),s=e('input[name="optin_username"]').val(),o=!!t.model.get("email_services").mautic&&t.model.get("email_services").mautic.enabled,n=e('input[name="optin_password"]').val(),a=e('select[name="optin_email_list"]'),l=a.val(),d=a.find("option:selected").text(),r={url:i,username:s,enabled:o,password:n,list_id:l,list_name:d,desc:i},c=_.extend(t.mautic.provider_args,r);t.mautic.provider_args=c,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){var i=function(t){var i=e(this).val();(i.indexOf("http://")<0||i.indexOf("https://")<0)&&(alert(optin_vars.messages.mautic.invalid_url),e(this).focus())};e(t).on("change paste","input[name='optin_url']",i),Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document),function(e){"use strict";var t=["getresponse","campaignmonitor","aweber","mailerlite"];_.each(t,function(t){Optin.Mixins.add_services_mixin(t,function(i){return new Optin.Provider({id:t,provider_args:{enabled:0},default_data:{enabled:!1,api_key:""},show_selected:function(){if(i.editing_service===this.id){var s=i.model.get("email_services"),o=e("#optin-provider-account-selected-list"),n=o.find(".wpmudev-label--notice span"),a="list_name"in s[t]?s[t].list_name:"",l="api_key"in s[t]?s[t].api_key:"";n.length&&n.html(n.text().replace("campaign","<strong>"+a+"</strong>")),""!==l&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",l)},500)}},update_args:function(i){if(i.editing_service===this.id){if(!i.is_service_modal_updated)return void i.service_modal.close_modal();var s=e('input[name="optin_api_key"]').val(),o=e('select[name="optin_email_list"]'),n=!!i.model.get("email_services")[t]&&i.model.get("email_services")[t].enabled,a=o.val(),l=o.find("option:selected").text(),d={api_key:s,enabled:n,list_id:a,list_name:l,desc:s},r=_.extend(i[t].provider_args,d);i[t].provider_args=r,Hustle.Events.trigger("optin.service.saved",i)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})})}(jQuery,document),function(e,t){"use strict";Optin.Mixins.add_services_mixin("sendinblue",function(i){return new Optin.Provider({id:"sendinblue",provider_args:{enabled:0},default_data:{enabled:!1,api_key:""},errors:{email_list:{name:"email_provider_lists",iconClass:"dashicons-warning-account_name"}},show_selected:function(){if(i.editing_service===this.id){var t=i.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("sendinblue"in t){var n="list_name"in t.sendinblue?t.sendinblue.list_name:"";o.length&&o.html(o.text().replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof t.sendinblue.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",t.sendinblue.api_key)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_api_key"]').val(),s=!!t.model.get("email_services").sendinblue&&t.model.get("email_services").sendinblue.enabled,o=e('select[name="optin_email_list"]'),n=o.val(),a=o.find("option:selected").text(),l={api_key:i,enabled:s,list_id:n,list_name:a,desc:i},d=_.extend(t.sendinblue.provider_args,l);t.sendinblue.provider_args=d,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){var s=function(t){var s=e(t.target),o=s.closest("form"),n=o.serialize(),a=e("#optin-provider-account-options");a.html(e("#wpoi_loading_indicator").html()),n+="&action=refresh_provider_account_details&load_more=true",n+="&optin=sendinblue",e.post(ajaxurl,n,function(e){e.success===!0?(e.data.redirect_to?window.location.href=e.data.redirect_to:e.data?a.html(e.data):a.html(optin_vars.messages.something_went_wrong),Hustle.Events.trigger("modules.view.rendered",i)):e.data?a.html(e.data):a.html(optin_vars.messages.something_went_wrong)}).fail(function(e){a.html(optin_vars.messages.something_went_wrong)})};Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this)),e(t).on("click",".sendinblue_optin_load_more_lists",s)}})})}(jQuery,document),function(e){"use strict";Optin.Mixins.add_services_mixin("sendy",function(t){return new Optin.Provider({id:"sendy",provider_args:{enabled:0},default_data:{enabled:!1,api_key:"",installation_url:"",list_id:""},show_selected:function(){if(t.service_supports_fields=!1,t.editing_service===this.id){var i=t.model.get("email_services"),s=e("#optin-provider-account-selected-list"),o=s.find(".wpmudev-label--notice span");if("sendy"in i){var n="list_id"in i.sendy?i.sendy.list_id:"";o.length&&o.html(window.optin_vars.messages.providers.no_fetch_list.replace("campaign","<strong>"+n+"</strong>")),"undefined"!=typeof i.sendy.api_key&&setTimeout(function(){e('input[name="optin_api_key"]').attr("value",i.sendy.api_key)},500),"undefined"!=typeof i.sendy.installation_url&&setTimeout(function(){e('input[name="optin_sendy_installation_url"]').attr("value",i.sendy.installation_url)},500)}}},update_args:function(t){if(t.editing_service===this.id){if(!t.is_service_modal_updated)return void t.service_modal.close_modal();var i=e('input[name="optin_api_key"]').val(),s=!!t.model.get("email_services").sendy&&t.model.get("email_services").sendy.enabled,o=e('input[name="optin_sendy_installation_url"]').val(),n=e('input[name="optin_email_list"]').val(),a={api_key:i,enabled:s,installation_url:o,list_id:n,desc:i},l=_.extend(t.sendy.provider_args,a);t.sendy.provider_args=l,Hustle.Events.trigger("optin.service.saved",t)}},init:function(){Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})}(jQuery,document);var Module=window.Module||{};Hustle.define("Model",function(){"use strict";return Backbone.Model.extend({initialize:function(){this.on("change",this.user_has_change,this),Backbone.Model.prototype.initialize.apply(this,arguments);var e=this.attributes;this.display_preview_button(e)},user_has_change:function(){Module.hasChanges=!0;var e=this.attributes;this.display_preview_button(e)},display_preview_button:function(e){var t=$(".wpmudev-preview");e.has_title||""!==e.main_content||e.use_feature_image||e.show_cta||e.use_email_collection?t.show():t.hide()}})}),Hustle.define("Models.M",function(){"use strict";return Hustle.get("Model").extend({toJSON:function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},set:function(e,t,i){if("string"==typeof e&&e.indexOf(".")!==-1){var s=e.split(".")[0],o=e.split(".")[1],n=this.get(s);n&&n instanceof Backbone.Model&&(n.set(o,t,i),this.trigger("change:"+e,e,t,i),this.trigger("change:"+s,e,t,i))}else Backbone.Model.prototype.set.call(this,e,t,i)},get:function(e){if("string"==typeof e&&e.indexOf(".")!==-1){var t=e.split(".")[0],i=e.split(".")[1];return this.get(t).get(i)}return Backbone.Model.prototype.get.call(this,e)}})}),Hustle.define("Models.Trigger",function(){"use strict";return Hustle.get("Model").extend({defaults:{trigger:"time",on_time:!1,on_time_delay:5,on_time_unit:"seconds",on_scroll:"scrolled",on_scroll_page_percent:"20",on_scroll_css_selector:"",on_click_element:"",on_exit_intent:!0,on_exit_intent_per_session:!0,on_exit_intent_delayed:!1,on_exit_intent_delayed_time:5,on_exit_intent_delayed_unit:"seconds",on_adblock:!1,on_adblock_delayed:!1,on_adblock_delayed_time:5,on_adblock_delayed_unit:"seconds"}})}),Module.Model=Hustle.get("Models.M").extend({defaults:{module_name:"",module_type:"popup",active:1,test_mode:0}}),function(e){"use strict";var t=window.Module||{};t.Alert=Backbone.View.extend({template:Optin.template("optin-alert-modal"),events:{"click .inc-opt-alert-modal-close":"close","click .inc-opt-alert-modal":"close","click .inc-opt-alert-modal-close-btn":"close","click .inc-opt-alert-modal-inner-container":"prevent_close"},initialize:function(e){return this.options=e,this.render()},render:function(){this.$el.html(this.template(_.extend({close_text:optin_vars.messages.ok},this.options))),this.$el.appendTo("body")},close:function(e){this.$el.hide(),this.remove()},prevent_close:function(e){e.preventDefault(),e.stopPropagation()}}),t.Service_Modal=Backbone.View.extend({template:Optin.template("wpmudev-hustle-modal-add-new-service-tpl"),service_modal_target:"#wph-add-new-service-modal .wpmudev-box-modal",add_service_modal:e("#wph-add-new-service-modal"),initialize:function(e){return this.options=e,this.view=e.view,this.render()},render:function(){return this},add_service:function(t){this.view.is_service_modal_updated=!1;var i=_.extend({is_new:!0,service:"mailchimp"}),s=e(this.service_modal_target),o=t.closest("a");o.data("nonce");s.html(""),s.append(this.template(i)),this.show_modal(!1)},edit_service:function(t){this.view.is_service_modal_updated=!1;var i=t.closest("a"),s=i.data("id"),o=i.data("nonce"),n=_.extend({is_new:!1,service:s}),a=e(this.service_modal_target);a.html(""),a.append(this.template(n)),this.view.editing_service=s,this.get_provider_details(s,o),this.show_modal(!0)},on_provider_changed:function(t){var i=e(t.target),s=i.val(),o=i.data("nonce");this.view.editing_service!==s&&(this.view.is_service_modal_updated=!0),this.view.editing_service=s,this.get_provider_details(s,o)},get_provider_details:function(t,i){var s=e("#wph-provider-account-details"),o=this.view.module_id,n=this.view.module_type;s.html(""),e.ajax({url:ajaxurl,type:"get",async:!0,data:{action:"render_provider_account_options",provider_id:t,module_id:o,module_type:n,_ajax_nonce:i},success:function(i){i.success===!0&&(s.html(i.data),Hustle.Events.trigger("modules.view.select.render",this.view),"mailchimp"!==t&&e("#wph-mailchimp-group-args").length&&e("#wph-mailchimp-group-args").remove())}})},show_modal:function(t){var i=e("#wph-add-new-service-modal"),s=i.find(".wpmudev-box-modal"),o=this.view,n=this,a=this.view.model.get("email_services"),l=e("#optin-provider-account-selected-list");this.add_service_modal.addClass("wpmudev-modal-active"),e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){s.addClass("wpmudev-show"),Hustle.Events.trigger("modules.view.rendered",o),e(document).off("change",'select[name="optin_provider_name"]',e.proxy(n.on_provider_changed,n)),e(document).on("change",'select[name="optin_provider_name"]',e.proxy(n.on_provider_changed,n)),e(document).off("click",".optin_refresh_provider_details",e.proxy(n.refresh_provider_details,n)),e(document).on("click",".optin_refresh_provider_details",e.proxy(n.refresh_provider_details,n)),e(document).off("click",".wph-save-optin-service",e.proxy(n.updated_email_service_args,n)),e(document).on("click",".wph-save-optin-service",e.proxy(n.updated_email_service_args,n)),Hustle.Events.off("optin.service.saved",n.save_email_service),Hustle.Events.on("optin.service.saved",n.save_email_service),n.hide_or_show_other_services(t),t&&!_.isEmpty(a)?Hustle.Events.trigger("optin.service.show.selected",o):(l.hide(),s.find('select[name="optin_provider_name"]').trigger("change"))},100)},hide_or_show_other_services:function(t){var i=e("#wph-provider-select .wpmudev-select"),s=e("#optin-provider-account-selected-list"),o=this.view.model.get("email_services");if(_.isEmpty(o)&&(o={mailchimp:this.view.mailchimp.default_data}),t)s.show();else{s.hide();var n=i.find("option");n.each(function(){var t=e(this).attr("value");(t in o||"mailchimp"===t)&&e(this).remove()})}},refresh_provider_details:function(t){t.preventDefault();var i=this.view,s=e(t.target),o=s.closest("form"),n=o.serialize(),a=(s.siblings("input#optin_api_key"),e("#optin-provider-account-options"));this.view.is_service_modal_updated=!0,a.html(e("#wpoi-loading-indicator").html()),n+="&action=refresh_provider_account_details","undefined"!=typeof this.view.module_id&&(n+="&module_id="+this.view.module_id),s.addClass("wpmudev-button-onload"),e.post(ajaxurl,n,function(e){e.success===!0?e.data.redirect_to?window.location.href=e.data.redirect_to:(e.data?a.html(e.data):a.html(optin_vars.messages.something_went_wrong),Hustle.Events.trigger("modules.view.rendered",i)):e.data?a.html(e.data):a.html(optin_vars.messages.something_went_wrong)}).fail(function(e){a.html(optin_vars.messages.something_went_wrong)}).always(function(){s.removeClass("wpmudev-button-onload")})},updated_email_service_args:function(e){e.preventDefault(),Hustle.Events.trigger("optin.service.prepare",this.view)},save_email_service:function(e){var t=e.editing_service,i=e[t].provider_args,s={};s[t]=i,e.model.set("email_services",s),e.service_modal.close_modal(),e.service_modal.append_added_service(t,i)},close_modal:function(){this.add_service_modal.find(".wpmudev-i_close").click()},append_added_service:function(t,i){var s=e("tr.wph-wizard-content-email-providers").last(),o=(e('table#wph-wizard-content-email-options a[data-id="'+t+'"]'),s.clone());s.html(o.html());var n=e("tr.wph-wizard-content-email-providers").last();n.addClass("updated-email-provider"),n.siblings().removeClass("updated-email-provider");var n=e("tr.updated-email-provider"),a=n.find("input.wph-email-service-toggle"),l=a.siblings("label"),d=Optin.template("wpmudev-"+t+"-optin-provider-icon-svg"),r=n.find(".wph-email-providers-icon"),c=n.find("a.wph-email-service-edit-link"),_="desc"in i?i.desc:"";a.attr("id","wph-popup-list_"+t),a.attr("data-attribute",t+"_service_provider"),a.prop("checked",i.enabled),l.attr("for","wph-popup-list_"+t),c.attr("data-id",t),r.html(d()),t in optin_vars.providers&&(c.find("span.wpmudev-table_name").text(optin_vars.providers[t].name),c.find("span.wpmudev-table_desc:first").text(_))}}),t.Form_Fields=Backbone.View.extend({edit_fields_modal:e("#wph-edit-form-modal"),field_list_template:Optin.template("wpmudev-hustle-modal-view-form-fields-tpl"),fields_template:Optin.template("wpmudev-hustle-modal-manage-form-fields-tpl"),new_fields_template:Optin.template("wpmudev-hustle-modal-add-form-fields-tpl"),fields_modal_target:"#wph-edit-form-modal .wpmudev-box-modal",initialize:function(e){return this.options=e,this.view=e.view,this.render()},render:function(){return this},manage_form:function(){var t=this,i=(this.view,e(t.fields_modal_target)),s=this.view.model.get("form_elements");"object"!=typeof s&&(s=JSON.parse(s)),i.html(""),i.append(t.fields_template(_.extend({form_fields:s})));var o=i.find("form#wph-optin-form-fields-form .wpmudev-table-body");o.length&&_.each(s,function(e,i){o.append(t.new_fields_template(_.extend({field:e,new_field:!1})))});var n=t.edit_fields_modal.find(".wpmudev-box-modal"),a=t.edit_fields_modal.find(".wpmudev-table-body"),l=t.edit_fields_modal.find(".wpmudev-table-body-row"),d=t.edit_fields_modal.find("#wph-new-form-field"),r=t.edit_fields_modal.find(".wpmudev-i_close"),c=t.edit_fields_modal.find("#wph-cancel-edit-form"),u=t.edit_fields_modal.find("#wph-save-edit-form"),p=t.edit_fields_modal.find(".wph-field-row");t.edit_fields_modal.addClass("wpmudev-modal-active"),e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){n.addClass("wpmudev-show"),d.on("click",e.proxy(t.new_form_field,t)),u.on("click",e.proxy(t.save_form_fields,t)),a.sortable(),a.disableSelection(),l.each(function(){var i=e(this),s=i.find(".wpmudev-preview-item-manage"),o=i.find(".wpmudev-icon-delete");s.on("click",function(e){e.stopPropagation(),i.toggleClass("wpmudev-open")}),o.on("click",function(i){i.preventDefault(),i.stopPropagation(),t.delete_form_field(e(this))})}),r.on("click",function(i){i.stopPropagation(),n.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.edit_fields_modal.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),n.removeClass("wpmudev-hide")},500)}),c.on("click",function(i){i.preventDefault(),i.stopPropagation(),n.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.edit_fields_modal.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),n.removeClass("wpmudev-hide")},500)}),p.each(function(){t.form_fields_header(e(this))}),Hustle.Events.trigger("modules.view.select.render",t),Hustle.Events.off("optin.service.saved",t.persist_form_fields),Hustle.Events.on("optin.service.saved",t.persist_form_fields)},100)},new_form_field:function(t){t.preventDefault(),t.stopPropagation();var i=this,s=(i.view,i.edit_fields_modal.find(".wpmudev-table-body")),o=i.edit_fields_modal.find("#wph-new-form-field");if(this.view.service_supports_fields){var n=s.find(".wpmudev-table-body-row");n.each(function(){e(this).removeClass("wpmudev-open")}),s.prepend(i.new_fields_template(_.extend({field:{"delete":!0},new_field:!0})));var a=s.find(".wpmudev-preview-item-manage:first"),l=s.find(".wpmudev-icon-delete");a.on("click",function(t){t.stopPropagation(),e(this).closest(".wpmudev-table-body-row").toggleClass("wpmudev-open")}),l.on("click",function(t){t.preventDefault(),t.stopPropagation(),i.delete_form_field(e(this))}),i.form_fields_header(s.find(".wpmudev-table-body-row:first")),Hustle.Events.trigger("modules.view.select.render",i),i.update_model_fields(i)}else o.html(optin_vars.messages.form_fields.errors.custom_field_not_supported)},delete_form_field:function(e){var t=(e.data("id"),e.closest(".wph-field-row.wpmudev-table-body-row"));t.fadeOut("fast",function(){t.remove()})},form_fields_header:function(t){var i=t.find(".wpmudev-table-body-content input, .wpmudev-table-body-content select"),s=t.find(".wpmudev-table-body-preview"),o=s.closest(".wpmudev-table-body-row");i.each(function(){e(this).is(":checkbox")?e(this).on("change",function(t){e(this).is(":checked")?s.find(".wpmudev-preview-item-required").html('<span class="wpdui-fi wpdui-fi-check"></span>'):s.find(".wpmudev-preview-item-required").html("")}):e(this).on("change keyup keypress",function(t){var i=e(this).attr("name");s.find(".wpmudev-preview-item-"+i).html(e(this).val()),"name"===i&&o.attr("data-id",e(this).val())})})},save_form_fields:function(t){t.preventDefault(),t.stopPropagation();var i=this,s=i.view;i.update_model_fields(i,function(t){i.update_optin_fields(s,function(s){var o=i.field_list_template({form_fields:t});e(".wph-form-element-list").empty(),e(".wph-form-element-list").html(o),i.edit_fields_modal.find(".wpmudev-i_close").click()})})},update_model_fields:function(t,i){var s=t.view,o=t.edit_fields_modal.find(".wph-field-row"),n={},a={};o.each(function(){var t=e(this).attr("data-id"),i=e(this).find(".wpmudev-table-body-content input, .wpmudev-table-body-content select");a[t]={},i.each(function(){var i=e(this).attr("name"),s=e(this).val();"required"===i&&(s=e(this).is(":checkbox")?e(this).is(":checked"):"true"===s),"delete"===i&&(s="true"===s),a[t][i]=s}),n[t]=a[t]}),s.current_form_elements=n,s.model.set("form_elements",n,{silent:!0}),"undefined"!=typeof i&&"function"==typeof i&&i(n)},update_optin_fields:function(t,i){var s=this;if("object"==typeof t.current_form_elements){var o=JSON.stringify(t.current_form_elements),n=t.model.get("active_email_service"),a=s.edit_fields_modal.find("#wph-save-edit-form"),l=a.attr("data-nonce"),d=t.module_id,r={action:"add_module_fields",_ajax_nonce:l,data:o,provider:n,module_id:d};e.post(ajaxurl,r,function(e){"function"==typeof i&&i(e)}).fail(function(e){"function"==typeof i&&i(e)})}},persist_form_fields:function(e){var t=this;"object"==typeof e.current_form_elements&&(Object.keys(e.current_form_elements).length<=0&&"undefined"!=typeof wph_default_form_elements&&(e.current_form_elements=wph_default_form_elements),Object.keys(e.current_form_elements).length>0&&(e.model.set("form_elements",e.current_form_elements),t.update_optin_fields(e,null))),t.edit_fields_modal.find(".wpmudev-i_close").click()}}),t.hasChanges=!1,t.user_change=function(){t.hasChanges=!0},window.onbeforeunload=function(){if(t.hasChanges)return optin_vars.messages.dont_navigate_away},e(".highlight_input_text").focus(function(){e(this).select()})}(jQuery),function(e){"use strict";var t=window.Module||{};t.Validate={validate_module_name:function(){var t=!0;if(e("input[name=module_name]").length){var i=e("input[name=module_name]"),s=i.next(".wpmudev-label--notice");t=0!==i.val().length,t?s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"):(i.focus(),s.hasClass("wpmudev-hidden")&&s.removeClass("wpmudev-hidden"))}return t},on_change_validate_module_name:function(t){var i=e(t.target).val(),s=e(t.target).next(".wpmudev-label--notice");0!==i.length?s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")&&s.removeClass("wpmudev-hidden")}}}(jQuery),Hustle.define("Pop_Up.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-content-tpl"),module_id:0,target_container:e("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,service_supports_fields:!0,current_form_elements:[],content_form_container:e(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="popup",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return"undefined"==typeof t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"popup"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-popup-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"popup",target_div:t}),t.html(""),t.html(this.media_holder.$el))},add_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.add_service(i)},edit_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.edit_service(i)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Pop_Up.Design_View",function(e,t,i){
"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click())},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Popup.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .hustle-delete-module":"delete_module","click .button-view-email-list":"view_email_list","click .module-toggle-tracking-activity":"toggle_tracking_activity","click .button-view-log-list":"view_error_log_list","click #wpmudev-bulk-action-button":"apply_bulk_action","change [name='wph-module-status']":"module_status_updated","change #wph-all-popups":"select_all"},initialize:function(){var i=this,s=e(".wpmudev-list .wpmudev-list--element"),o=s.length,n=o;s.each(function(){e(this).css("z-index",n),n--;var t=e(this).find(".wpmudev-dots-dropdown"),s=t.find(".wpmudev-dots-button"),o=t.find(".wpmudev-dots-nav");s.on("click",function(){e(this).toggleClass("wpmudev-active"),o.toggleClass("wpmudev-hide"),i.$(".wpmudev-dots-nav").not(o).each(function(){e(this).hasClass("wpmudev-hide")||e(this).toggleClass("wpmudev-hide")})})}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}})},delete_module:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_popup_toggle_test_activity":(o.action="hustle_popup_module_toggle_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"popup",module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_popup_module_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){location.reload()}})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),o=s.id,n=s.name,a="popup",l=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new l({button:i,model:{name:n,id:o,type:a,total:s.total}})},select_all:function(t){var i=e(t.target);i.is(":checked")?this.$(".wph-module-checkbox").prop("checked",!0):this.$(".wph-module-checkbox").prop("checked",!1)},apply_bulk_action:function(t){var i=(e(t.target),this.$("select#wpmudev-bulk-action").val()),s=this.$('select#wpmudev-bulk-action option[value="'+i+'"]').data("nonce"),o=[];"delete"===i&&(this.$(".wph-module-checkbox:checked").each(function(){o.push(e(this).data("id"))}),_.isEmpty(o)||this.delete_confirmation&&(this.delete_confirmation.opts.ids=JSON.stringify(o),this.delete_confirmation.opts.multiple=1,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active")))}})}),Hustle.define("Pop_Up.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"popup"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=Hustle.get("Models.Trigger"),o=Hustle.get("Models.M").extend({defaults:{conditions:"",triggers:"",animation_in:"",animation_out:"",after_close:"",expiration:365,expiration_unit:"days",allow_scroll_page:!1,not_close_on_background_click:!1,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new s(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}});return{Base:e,Content:t,Design:i,Display_Settings:o}}),Hustle.define("Pop_Up.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({shortcode_id:optin_vars.current.shortcode_id},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Pop_Up.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-popup-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),e(document).off("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).off("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).off("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).off("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).off("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).off("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).off("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).off("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).off("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).off("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).off("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).off("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).off("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).off("keydown",e.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),e(document).on("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).on("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).on("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).on("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).on("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).on("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).on("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).on("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).on("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).on("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).on("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).on("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).on("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),e(document).on("keydown",e.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",e.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"),10);this.use_email_collection_changed(e,!1),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var l=tinyMCE.get("gdpr_message"),d=this.$("textarea#gdpr_message"),r="true"===d.attr("aria-hidden")?l.getContent():d.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var t=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");t.length&&t.remove();var i=this,s=i.content_view.model.get("main_content"),o=e(".wpmudev-preview").data("nonce");s.search(/\[/g)===-1?i.render_preview(i.content_view.model.toJSON()):e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:s,_ajax_nonce:o},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(e){var t=this,i=this.content_view.model.get("use_email_collection"),s=_.isTrue(i)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),o=_.extend(t.model.toJSON(),{content:e,design:t.design_view.model.toJSON(),settings:t.settings_view.model.toJSON()});t.$("#wph-preview-modal").append(s(o)),t.apply_custom_css(),t.apply_preview_styles(),t.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",t)},after_preview_render:function(){var t=this,i=this.$("#wph-preview-modal").addClass("wpmudev-modal-active"),s=i.find(".hustle-modal"),o=this.settings_view.model.get("animation_in");e("body").addClass("wpmudev-modal-is_active"),s.hasClass("hustle-animated")?setTimeout(function(){s.addClass("hustle-animate-"+o),t.apply_custom_size()},100):this.apply_custom_size()},apply_preview_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.style;if(_.isTrue(t.use_email_collection))return void this.apply_preview_optin_styles();var o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),l=n.find(".hustle-modal-body section"),d=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find(".hustle-modal-image"),u=n.find("article, .hustle-modal-message"),p=n.find("article blockquote, .hustle-modal-message blockquote"),m=n.find("article a, .hustle-modal-message a"),h=n.find(".hustle-modal-cta"),v=n.find(".hustle-modal-close"),g=n.find(".hustle-modal-close svg path"),f=o.find(".wpmudev-modal-mask");"cabriolet"===s?l.css("background-color",i.main_bg_color):a.css("background-color",i.main_bg_color),d.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("background-color",i.image_container_bg),u.css("color",i.content_color),p.css("border-left-color",i.link_static_color),p.mouseover(function(){e(this).css("border-left-color",i.link_hover_color)}).mouseout(function(){e(this).css("border-left-color",i.link_static_color)}),m.css("color",i.link_static_color),m.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),h.css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color}),h.mouseover(function(){e(this).css({"background-color":i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color})}),g.css("fill",i.close_button_static_color),v.mouseover(function(){g.css("fill",i.close_button_hover_color)}).mouseout(function(){g.css("fill",i.close_button_static_color)}),f.css("background-color",i.overlay_bg);var w=o.find(".hustle-modal-image img"),b="",y="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(b="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,y="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,w.css({"background-position":b+" "+y,"object-position":b+" "+y})),_.isTrue(i.border)){var x=i.border_weight+"px "+i.border_type+" "+i.border_color;"cabriolet"===s?n.find("section").css({border:x,"border-radius":i.border_radius+"px"}):a.css({border:x,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var k=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;"cabriolet"===s?n.find("section").css({"box-shadow":k}):a.css({"box-shadow":k})}},apply_preview_optin_styles:function(){var t=(this.content_view.model.toJSON(),this.design_view.model.toJSON()),i=t.form_layout,s=this.$("#wph-preview-modal"),o=s.find(".hustle-modal"),n=o.find(".hustle-modal-body"),a=o.find(".hustle-modal-success"),l=o.find(".hustle-modal-title"),d=o.find(".hustle-modal-subtitle"),r=o.find("article"),c=o.find("article blockquote"),u=o.find("article a:not(.hustle-modal-cta)"),p=o.find(".hustle-modal-optin_field"),m=p.find("label .hustle-modal-optin_icon .hustle-icon path"),h=p.find("label .hustle-modal-optin_placeholder"),v=o.find(".hustle-modal-optin_button button"),g=o.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),f=o.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),w=o.find(".hustle-modal-close"),b=o.find(".hustle-modal-close svg path");n.css("background-color",t.main_bg_color),a.css("background-color",t.main_bg_color),n.find(".hustle-modal-image").css("background-color",t.image_container_bg),"one"===i||"two"===i?o.find("footer").css("background-color",t.form_area_bg):o.find(".hustle-modal-optin_wrap").css("background-color",t.form_area_bg),l.css("color",t.title_color),d.css("color",t.subtitle_color),r.css("color",t.content_color),c.css("border-left-color",t.link_static_color),u.css("color",t.link_static_color),u.mouseover(function(){e(this).css("color",t.link_hover_color)}).mouseout(function(){e(this).css("color",t.link_static_color)}),r.find(".hustle-modal-cta").css({background:t.cta_button_static_bg,color:t.cta_button_static_color}),r.find(".hustle-modal-cta").mouseover(function(){e(this).css({background:t.cta_button_hover_bg,color:t.cta_button_hover_color})}).mouseout(function(){e(this).css({background:t.cta_button_static_bg,color:t.cta_button_static_color})}),p.find("input").css("color",t.optin_form_field_text_static_color),p.css("background-color",t.optin_input_static_bg),p.mouseover(function(){e(this).find("input").css("color",t.optin_form_field_text_hover_color),e(this).css("background-color",t.optin_input_hover_bg)}).mouseout(function(){e(this).find("input").css("color",t.optin_form_field_text_static_color),e(this).css("background-color",t.optin_input_static_bg)}),m.css("fill",t.optin_input_icon),v.css("color",t.optin_submit_button_static_color),v.css("background-color",t.optin_submit_button_static_bg),v.mouseover(function(){e(this).css("color",t.optin_submit_button_hover_color),e(this).css("background-color",t.optin_submit_button_hover_bg)}).mouseout(function(){e(this).css("color",t.optin_submit_button_static_color),e(this).css("background-color",t.optin_submit_button_static_bg)}),h.css("color",t.optin_placeholder_color),g.css("background-color",t.optin_check_radio_static_bg),f.css("background-color",t.optin_check_radio_static_bg);var y=e("#hustle-module-checkbox-radio-custom-styles"),x=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before",k=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before",C=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before",$=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before",O=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label",S=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label",z=".wpmudev-ui .wpmudev-modal .wpmudev-modal-mask",H=x+" { color: "+t.optin_check_radio_static_bg+"; }"+k+" { color: "+t.optin_check_radio_tick_color+"; }"+C+" { color: "+t.optin_check_radio_static_bg+"; }"+$+" { color: "+t.optin_check_radio_tick_color+"; }"+O+" { color: "+t.optin_mailchimp_title_color+"; }"+S+" { color: "+t.optin_mailchimp_labels_color+"; }"+z+" { background-color: "+t.overlay_bg+"; }";y.length&&y.remove(),e('<style id="hustle-module-mailchimp-custom-styles">'+H+"</style>").appendTo("body"),b.css("fill",t.close_button_static_color),w.mouseover(function(){b.css("fill",t.close_button_hover_color)}).mouseout(function(){b.css("fill",t.close_button_static_color)});var M=s.find(".hustle-modal-image img"),E="",T="";if("contain"!==t.feature_image_fit&&"cover"!==t.feature_image_fit||(E="custom"===t.feature_image_horizontal?t.feature_image_horizontal_px+"px":t.feature_image_horizontal,T="custom"===t.feature_image_vertical?t.feature_image_vertical_px+"px":t.feature_image_vertical,M.css({"background-position":E+" "+T,"object-position":E+" "+T})),_.isTrue(t.border)){var j=t.border_weight+"px "+t.border_type+" "+t.border_color;n.css({border:j,"border-radius":t.border_radius+"px"})}if(_.isTrue(t.drop_shadow)){var D=t.drop_shadow_x+"px "+t.drop_shadow_y+"px "+t.drop_shadow_blur+"px "+t.drop_shadow_spread+"px "+t.drop_shadow_color;n.css({"box-shadow":D})}if(_.isTrue(t.form_fields_border)){var P=t.form_fields_border_weight+"px "+t.form_fields_border_type+" "+t.form_fields_border_color;p.css({border:P,"border-radius":t.form_fields_border_radius+"px"})}if(_.isTrue(t.button_border)){var N=t.button_border_weight+"px "+t.button_border_type+" "+t.button_border_color;v.css({border:N,"border-radius":t.button_border_radius+"px"})}},apply_custom_size:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style,s=t.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body");if(_.isTrue(t.customize_size)){if(n.css({width:t.custom_width+"px","max-width":"none"}),"simple"===i&&_.isFalse(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,d=n.find(".hustle-modal-content");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),d.css({height:"calc("+t.custom_height+"px - "+l+"px)","overflow-y":"auto"})}if("minimal"===i&&_.isFalse(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,r=n.find("section"),c=n.find(".hustle-modal-message");if(!_.isTrue(e.has_title)||""===e.title&&""===e.sub_title)var u=0;else var u=n.find("header").outerHeight();if(_.isTrue(e.show_cta)&&""!==e.cta_label&&""!==e.cta_url)var p=n.find("footer").innerHeight();else var p=0;r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+u+"px - "+p+"px)"}),c.css({height:"calc("+t.custom_height+"px - "+l+"px - "+u+"px - "+p+"px)","overflow-y":"auto"})}if("cabriolet"===i&&_.isFalse(e.use_email_collection)){var u=n.find("header").height()+20,r=n.find("section"),c=n.find(".hustle-modal-message");r.css({height:"calc("+t.custom_height+"px - "+u+"px)"}),c.css({height:"calc("+t.custom_height+"px - "+u+"px)","overflow-y":"auto"})}if("one"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,p=n.find("footer").height(),m=n.find(".hustle-modal-image"),r=n.find("section"),h=n.find("article");if(r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"}),r.hasClass("hustle-modal-image_above")||r.hasClass("hustle-modal-image_below")){t.custom_height+l+p;r.height()<250?r.css({"overflow-y":"auto"}):h.css({height:"calc("+r.height()+"px - "+m.height()+"px)","overflow-y":"auto"})}else h.css({"max-height":"calc("+t.custom_height+"px - "+l+"px - "+p+"px)","overflow-y":"auto"}),m.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"})}if("two"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,p=n.find("footer").height(),v=n.find(".hustle-modal-body"),r=n.find("section"),h=n.find("article");v.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)","overflow-y":"auto"})}if("three"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,g=n.find(".hustle-modal-image").height(),h=n.find("article");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px - "+g+"px)","overflow-y":"auto"})}if("four"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,g=n.find(".hustle-modal-image").height(),f=t.custom_height-l-g,w=n.find(".hustle-modal-optin_wrap"),h=n.find("article");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px)","overflow-y":"auto"}),w.css({height:"calc("+t.custom_height+"px - "+l+"px - "+g+"px)","overflow-y":"auto"}),n.find(".hustle-modal-optin_form").innerHeight()>f&&w.css({"align-items":"flex-start"})}}},apply_custom_css:function(){var t=e("#hustle-module-custom-styles");t.remove();var i=this.design_view.model.toJSON().customize_css;if(1===i||"1"===i){var s=this.design_view.model.get("custom_css"),o=e("#hustle_custom_css").data("nonce");if(_.isEmpty(s)||"undefined"==typeof o)return;e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_popup_prepare_custom_css",css:s,_ajax_nonce:o},success:function(t){if(t&&t.success){var i=e("#hustle-module-custom-styles");i.length&&i.remove(),e('<style id="hustle-module-custom-styles">'+t.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(t){t.stopPropagation();var i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=this.settings_view.model.get("animation_in"),n="hustle-animate-"+o,a=this.settings_view.model.get("animation_out"),l="hustle-animate-"+a,d=1e3;s.removeClass(n).addClass(l),s.hasClass("hustle-animated")&&("fadeOut"===a&&(d=305),"newspaperOut"===a&&(d=505),"bounceOut"===a&&(d=755),setTimeout(function(){i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass(l)},d)),s.hasClass("hustle-modal-static")&&(s.removeClass("hustle-modal-static"),i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"))},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},save:function(t){if(!Module.Validate.validate_module_name())return!1;this.set_content_from_tinymce(!0),this.sanitize_data();var i=this,s=this.model.toJSON(),o=this.content_view.model.toJSON(),n=this.design_view.model.toJSON(),a=this.settings_view.model.toJSON();return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_popup_module",_ajax_nonce:t.data("nonce"),id:t.data("id")?t.data("id"):"-1",module:s,content:o,design:n,settings:a,shortcode_id:i._get_shortcode_id()
},complete:function(e){e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.target);i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section||!1,o="";return window.onbeforeunload=null,s&&"content"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t=e.changed,i=Object.keys(t);if("has_title"in t){var s=this.$("#wph-wizard-content-title-textboxes");s.length&&(t.has_title?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_feature_image"in t){var s=this.$("#wph-wizard-content-image-options");s.length&&(t.use_feature_image?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_cta"in t){var s=this.$("#wph-wizard-content-cta-options");s.length&&(t.show_cta?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_gdpr"in t){var s=this.$("#wph-wizard-content-gdpr-message");s.length&&(t.show_gdpr?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_email_collection"in t&&this.use_email_collection_changed(t.use_email_collection,!0),"after_successful_submission"in t&&this.after_successful_submission_changed(t.after_successful_submission),"auto_close_success_message"in t){var s=this.$("#wph-wizard-content-form_success_options");s.length&&(t.auto_close_success_message?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if(i[0].indexOf("_service_provider")!==-1){var o=i[0].replace("_service_provider","");this.handle_email_service(o,t[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}if("feature_image_fit"in t){var s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options");s.length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_horizontal"in t){var s=this.$("#wph-wizard-design-horizontal-position");s.length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_vertical"in t){var s=this.$("#wph-wizard-design-vertical-position");s.length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("border"in t){var s=this.$("#wph-wizard-design-border-options");s.length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("form_fields_border"in t){var s=this.$("#wph-wizard-design-form-fields-border-options");s.length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("button_border"in t){var s=this.$("#wph-wizard-design-button-border-options");s.length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("drop_shadow"in t){var s=this.$("#wph-wizard-design-shadow-options");s.length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_size"in t){var s=this.$("#wph-wizard-design-size-options");s.length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_css"in t){var s=this.$("#wph-wizard-design-css_holder");s.length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}if("on_scroll"in t){var s=this.$("#wpmudev-display-trigger-scroll-options"),o=s.find(".wpmudev-show"),n=s.find(".wpmudev-hidden");s.length&&(o.removeClass("wpmudev-show").addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden").addClass("wpmudev-show")),this.settings_view.model.set("triggers.on_scroll",t.on_scroll,{silent:!0})}if("on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0}),"on_exit_intent_delayed"in t){var i=this.$("#wpmudev-display-exit-intent-delayed-options");i.length&&(t.on_exit_intent_delayed?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_exit_intent_delayed",t.on_exit_intent_delayed,{silent:!0})}},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},update_color_palette:function(e){var t=this,i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+e+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(n,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var e=this,t=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_"),i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+t+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];_.each(n,function(t,i){e.$('input[data-attribute="'+i+'"]').val(t).trigger("change")})}}},use_email_collection_changed:function(e,t){var i=this.$("#wph-wizard-content-email"),s=this.$("#wph-wizard-content-email-options"),o=this.$("#wph-wizard-content-form_elements"),n=this.$("#wph-wizard-content-form_submission"),a=this.$("#wph-wizard-content-form_message"),l=this.$("#wph-wizard-content-form_success");parseInt(e,10)?(i.removeClass("last"),s.removeClass("wpmudev-hidden_table"),s.addClass("wpmudev-show_table"),o.show(),n.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),t&&this.design_view.model.set("style","gray_slate")):(i.hasClass("last")||i.addClass("last"),s.removeClass("wpmudev-show_table"),s.addClass("wpmudev-hidden_table"),o.hide(),n.hide(),a.hide(),l.hide(),t&&this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_cta_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("cta_target",s.val(),{silent:!0})},toggle_submit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",s.val())},toggle_feature_image_position_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",s.val(),{silent:!0})},toggle_feature_image_fit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",s.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",s.val(),{silent:!1})},toggle_feature_image_vertical_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",s.val(),{silent:!1})},toggle_form_fields_icon_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",s.val(),{silent:!1})},toggle_form_fields_proximity_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",s.val(),{silent:!1})},toggle_display_triggers:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",s.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},handle_email_service:function(t,i){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),i?(this.content_view.model.set("active_email_service",t),_.isEmpty(s)?s[t]={enabled:i}:_.each(s,function(i,o){o===t?s[o]=_.extend(s[o],{enabled:1}):(s[o]=_.extend(s[o],{enabled:0}),e('input[data-attribute="'+o+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[t]=_.extend(s[t],{enabled:i})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model,i=t.get("auto_close_success_message"),s=this.content_view.model.get("auto_close_time"),o=this.content_view.model.get("auto_close_unit"),n=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(i)){var a=parseInt(s),l=o;"minutes"===l&&(a*=60),a*=1e3,_.delay(function(){var e=n.find(".hustle-modal"),t=e.find(".hustle-modal-close .hustle-icon");t.length>0?t.trigger("click"):$success_msg.removeAttr("style")},a)}}})}),Hustle.define("Slidein.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-content-tpl"),module_id:0,target_container:e("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,service_supports_fields:!0,current_form_elements:[],content_form_container:e(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="slidein",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return"undefined"==typeof t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"slidein"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-slidein-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"slidein",target_div:t}),t.html(""),t.html(this.media_holder.$el))},show_email_service_modal:function(t){var i=e("#wph-add-new-service-modal"),s=i.find(".wpmudev-box-modal"),o=this.model.get("email_services"),n=e("#optin-provider-account-selected-list"),a=this;this.add_service_modal.addClass("wpmudev-modal-active"),e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){s.addClass("wpmudev-show"),Hustle.Events.trigger("modules.view.rendered",a),e(document).off("click",".optin_refresh_provider_details",e.proxy(a.refresh_provider_details,a)),e(document).on("click",".optin_refresh_provider_details",e.proxy(a.refresh_provider_details,a)),e(document).off("click",".wph-save-optin-service",e.proxy(a.updated_email_service_args,a)),e(document).on("click",".wph-save-optin-service",e.proxy(a.updated_email_service_args,a)),Hustle.Events.off("slidein.optin.service.saved",a.save_email_service),Hustle.Events.on("slidein.optin.service.saved",a.save_email_service),a.hide_or_show_other_services(t),t&&!_.isEmpty(o)?Hustle.Events.trigger("optin.service.show.selected",a):n.hide()},100)},add_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.add_service(i)},edit_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.edit_service(i)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Slidein.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click()),this.$el.find("#popup_overlay_color").parents(".wpmudev-col").hide()},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Slidein.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .hustle-delete-module":"delete_module","click .button-view-email-list":"view_email_list","click .module-toggle-tracking-activity":"toggle_tracking_activity","click .button-view-log-list":"view_error_log_list","click #wpmudev-bulk-action-button":"apply_bulk_action","change [name='wph-module-status']":"module_status_updated","change #wph-all-slideins":"select_all"},initialize:function(){var i=this,s=e(".wpmudev-list .wpmudev-list--element"),o=s.length,n=o;s.each(function(){e(this).css("z-index",n),n--;var t=e(this).find(".wpmudev-dots-dropdown"),s=t.find(".wpmudev-dots-button"),o=t.find(".wpmudev-dots-nav");s.on("click",function(){e(this).toggleClass("wpmudev-active"),o.toggleClass("wpmudev-hide"),i.$(".wpmudev-dots-nav").not(o).each(function(){e(this).hasClass("wpmudev-hide")||e(this).toggleClass("wpmudev-hide")})})}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}})},delete_module:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"slidein",module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_slidein_module_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){location.reload()}})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),o=s.id,n=s.name,a="slidein",l=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new l({button:i,model:{name:n,id:o,type:a,total:s.total}})},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_slidein_toggle_test_activity":(o.action="hustle_slidein_module_toggle_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})},select_all:function(t){var i=e(t.target);i.is(":checked")?this.$(".wph-module-checkbox").prop("checked",!0):this.$(".wph-module-checkbox").prop("checked",!1)},apply_bulk_action:function(t){var i=(e(t.target),this.$("select#wpmudev-bulk-action").val()),s=this.$('select#wpmudev-bulk-action option[value="'+i+'"]').data("nonce"),o=[];"delete"===i&&(this.$(".wph-module-checkbox:checked").each(function(){o.push(e(this).data("id"))}),_.isEmpty(o)||this.delete_confirmation&&(this.delete_confirmation.opts.ids=JSON.stringify(o),this.delete_confirmation.opts.multiple=1,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active")))}})}),Hustle.define("Slidein.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"slidein"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=Hustle.get("Models.Trigger"),o=Hustle.get("Models.M").extend({defaults:{conditions:"",triggers:"",animation_in:"slideInUp",animation_out:"slideOutUp",after_close:"",display_position:"s",auto_hide:!1,auto_hide_time:5,auto_hide_unit:"hours",expiration:365,expiration_unit:"days",allow_scroll_page:!1,not_close_on_background_click:!1,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new s(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}});return{Base:e,Content:t,Design:i,Display_Settings:o}}),Hustle.define("Slidein.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({shortcode_id:optin_vars.current.shortcode_id},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Slidein.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-slidein-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),e(document).off("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).off("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).off("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).off("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).off("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).off("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).off("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).off("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).off("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).off("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).off("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).off("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).off("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).off("keydown",e.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),e(document).on("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),
e(document).on("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).on("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).on("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).on("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).on("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).on("click","ul.wpmudev-feature-image-location li",e.proxy(this.toggle_feature_image_options,this)),e(document).on("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).on("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).on("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).on("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).on("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).on("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).on("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),e(document).on("keydown",e.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",e.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"));this.use_email_collection_changed(e,!1),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var l=tinyMCE.get("gdpr_message"),d=this.$("textarea#gdpr_message"),r="true"===d.attr("aria-hidden")?l.getContent():d.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},apply_custom_size:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style,s=t.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body");if(_.isTrue(t.customize_size)){if(n.css({width:t.custom_width+"px","max-width":"none"}),"simple"===i&&_.isFalse(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,d=n.find(".hustle-modal-content");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),d.css({height:"calc("+t.custom_height+"px - "+l+"px)","overflow-y":"auto"})}if("minimal"===i&&_.isFalse(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,r=n.find("section"),c=n.find(".hustle-modal-message");if(!_.isTrue(e.has_title)||""===e.title&&""===e.sub_title)var u=0;else var u=n.find("header").outerHeight();if(_.isTrue(e.show_cta)&&""!==e.cta_label&&""!==e.cta_url)var p=n.find("footer").innerHeight();else var p=0;r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+u+"px - "+p+"px)"}),c.css({height:"calc("+t.custom_height+"px - "+l+"px - "+u+"px - "+p+"px)","overflow-y":"auto"})}if("cabriolet"===i&&_.isFalse(e.use_email_collection)){var u=n.find("header").height()+20,r=n.find("section"),c=n.find(".hustle-modal-message");r.css({height:"calc("+t.custom_height+"px - "+u+"px)"}),c.css({height:"calc("+t.custom_height+"px - "+u+"px)","overflow-y":"auto"})}if("one"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,p=n.find("footer").height(),m=n.find(".hustle-modal-image"),r=n.find("section"),h=n.find("article");if(r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"}),r.hasClass("hustle-modal-image_above")||r.hasClass("hustle-modal-image_below")){t.custom_height+l+p;r.height()<250?r.css({"overflow-y":"auto"}):h.css({height:"calc("+r.height()+"px - "+m.height()+"px)","overflow-y":"auto"})}else h.css({"max-height":"calc("+t.custom_height+"px - "+l+"px - "+p+"px)","overflow-y":"auto"}),m.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"})}if("two"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,p=n.find("footer").height(),v=n.find(".hustle-modal-body"),r=n.find("section"),h=n.find("article");v.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)","overflow-y":"auto"})}if("three"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,g=n.find(".hustle-modal-image").height(),h=n.find("article");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px - "+g+"px)","overflow-y":"auto"})}if("four"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,g=n.find(".hustle-modal-image").height(),f=t.custom_height-l-g,w=n.find(".hustle-modal-optin_wrap"),h=n.find("article");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px)","overflow-y":"auto"}),w.css({height:"calc("+t.custom_height+"px - "+l+"px - "+g+"px)","overflow-y":"auto"}),n.find(".hustle-modal-optin_form").innerHeight()>f&&w.css({"align-items":"flex-start"})}}},apply_custom_css:function(){var t=e("#hustle-module-custom-styles");t.remove();var i=this.design_view.model.toJSON().customize_css;if(1===i||"1"===i){var s=this.design_view.model.get("custom_css"),o=e("#hustle_custom_css").data("nonce");if(_.isEmpty(s)||"undefined"==typeof o)return;e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_slidein_prepare_custom_css",css:s,_ajax_nonce:o},success:function(t){if(t&&t.success){var i=e("#hustle-module-custom-styles");i.length&&i.remove(),e('<style id="hustle-module-custom-styles">'+t.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(t){t.stopPropagation();var i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=this.get_slide_in_direction(this.settings_view.model.get("display_position"),"out"),n="hustle-animate-slideIn"+o,a="hustle-animate-slideOut"+o,l=1e3;s.removeClass(n).addClass(a),setTimeout(function(){i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass(a)},l)},get_slide_in_direction:function(e,t){return"nw"===e||"w"===e||"sw"===e?"Left":"ne"===e||"e"===e||"se"===e?"Right":"s"===e&&"in"===t||"n"===e&&"out"===t?"Up":"Down"},save:function(t){if(!Module.Validate.validate_module_name())return!1;if(this.set_content_from_tinymce(!0),this.sanitize_data(),"undefined"!=typeof tinyMCE){var i=tinyMCE.get("main_content"),s=this.$("textarea#main_content"),o="true"===s.attr("aria-hidden")?i.getContent():s.val();this.content_view.model.set("main_content",o,{silent:!0});var n=tinyMCE.get("success_message"),a=this.$("textarea#success_message"),l="true"===a.attr("aria-hidden")?n.getContent():a.val();this.content_view.model.set("success_message",l,{silent:!0})}var d=this,r=this.model.toJSON(),c=this.content_view.model.toJSON(),_=this.design_view.model.toJSON(),u=this.settings_view.model.toJSON();return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_slidein_module",_ajax_nonce:t.data("nonce"),id:t.data("id")?t.data("id"):"-1",module:r,content:c,design:_,settings:u,shortcode_id:d._get_shortcode_id()},complete:function(e){e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.target);i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section,o="";return window.onbeforeunload=null,s&&"content"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,void window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t=e.changed,i=Object.keys(t);if("has_title"in t){var s=this.$("#wph-wizard-content-title-textboxes");s.length&&(t.has_title?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_feature_image"in t){var s=this.$("#wph-wizard-content-image-options");s.length&&(t.use_feature_image?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_cta"in t){var s=this.$("#wph-wizard-content-cta-options");s.length&&(t.show_cta?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_gdpr"in t){var s=this.$("#wph-wizard-content-gdpr-message");s.length&&(t.show_gdpr?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_email_collection"in t&&this.use_email_collection_changed(t.use_email_collection),"after_successful_submission"in t&&this.after_successful_submission_changed(t.after_successful_submission),"auto_close_success_message"in t){var s=this.$("#wph-wizard-content-form_success_options");s.length&&(t.auto_close_success_message?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if(i[0].indexOf("_service_provider")!==-1){var o=i[0].replace("_service_provider","");this.handle_email_service(o,t[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}if("feature_image_fit"in t){var s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options");s.length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_horizontal"in t){var s=this.$("#wph-wizard-design-horizontal-position");s.length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_vertical"in t){var s=this.$("#wph-wizard-design-vertical-position");s.length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("border"in t){var s=this.$("#wph-wizard-design-border-options");s.length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("form_fields_border"in t){var s=this.$("#wph-wizard-design-form-fields-border-options");s.length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("button_border"in t){var s=this.$("#wph-wizard-design-button-border-options");s.length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("drop_shadow"in t){var s=this.$("#wph-wizard-design-shadow-options");s.length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_size"in t){var s=this.$("#wph-wizard-design-size-options");s.length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_css"in t){var s=this.$("#wph-wizard-design-css_holder");s.length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}},update_color_palette:function(e){var t=this,i=parseInt(this.content_view.model.get("use_email_collection"));if(i){var s=this.$('option[value="'+e+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(n,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var e=this,t=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_"),i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+t+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];_.each(n,function(t,i){e.$('input[data-attribute="'+i+'"]').val(t).trigger("change")})}}},use_email_collection_changed:function(e,t){var i=this.$("#wph-wizard-content-email"),s=this.$("#wph-wizard-content-email-options"),o=this.$("#wph-wizard-content-form_elements"),n=this.$("#wph-wizard-content-form_submission"),a=this.$("#wph-wizard-content-form_message"),l=this.$("#wph-wizard-content-form_success");parseInt(e)?(i.removeClass("last"),s.removeClass("wpmudev-hidden_table"),s.addClass("wpmudev-show_table"),o.show(),n.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),t&&this.design_view.model.set("style","gray_slate")):(i.hasClass("last")||i.addClass("last"),s.removeClass("wpmudev-show_table"),s.addClass("wpmudev-hidden_table"),o.hide(),n.hide(),a.hide(),l.hide(),t&&this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_feature_image_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("feature_image_location",s.val(),{silent:!0})},toggle_cta_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("cta_target",s.val(),{silent:!0})},toggle_submit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",s.val())},toggle_feature_image_position_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",s.val(),{silent:!0})},toggle_feature_image_fit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",s.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",s.val(),{silent:!1})},toggle_feature_image_vertical_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",s.val(),{silent:!1})},toggle_form_fields_icon_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",s.val(),{silent:!1})},toggle_form_fields_proximity_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",s.val(),{silent:!1})},toggle_display_triggers:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",s.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}if("on_scroll"in t){var s=this.$("#wpmudev-display-trigger-scroll-options"),o=s.find(".wpmudev-show"),n=s.find(".wpmudev-hidden");s.length&&(o.removeClass("wpmudev-show").addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden").addClass("wpmudev-show")),this.settings_view.model.set("triggers.on_scroll",t.on_scroll,{silent:!0})}if("on_exit_intent_delayed"in t){var i=this.$("#wpmudev-display-exit-intent-delayed-options");i.length&&(t.on_exit_intent_delayed?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_exit_intent_delayed",t.on_exit_intent_delayed,{silent:!0})}if("on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0}),"auto_hide"in t){var i=this.$("#wpmudev-display-auto_hide-options");i.length&&(t.auto_hide?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.auto_hide",t.auto_hide,{silent:!0})}"display_position"in t&&this.settings_view.model.set("display_position",t.display_position,{silent:!0})},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var t=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");t.length&&t.remove();var i=this,s=i.content_view.model.get("main_content"),o=e(".wpmudev-preview").data("nonce");s.search(/\[/g)===-1?i.render_preview(i.content_view.model.toJSON()):e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:s,_ajax_nonce:o},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(e){var t=this,i=this.content_view.model.get("use_email_collection"),s=_.isTrue(i)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),o=_.extend(t.model.toJSON(),{content:e,design:t.design_view.model.toJSON(),settings:t.settings_view.model.toJSON()});t.$("#wph-preview-modal").append(s(o)),t.apply_custom_css(),t.apply_preview_styles(),t.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",t)},after_preview_render:function(){var t=this,i=this.$("#wph-preview-modal").removeClass("inc_opt_slidein_nw inc_opt_slidein_n inc_opt_slidein_ne inc_opt_slidein_w inc_opt_slidein_e inc_opt_slidein_sw inc_opt_slidein_s inc_opt_slidein_se").addClass("wpmudev-modal-active inc_opt_slidein_"+this.settings_view.model.get("display_position")),s=i.find(".hustle-modal"),o=this.get_slide_in_direction(this.settings_view.model.get("display_position"),"in"),n="hustle-animate-slideIn"+o;e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){s.addClass(n),t.apply_custom_size()},100)},apply_preview_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.style;if(_.isTrue(t.use_email_collection))return void this.apply_preview_optin_styles();var o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),l=n.find(".hustle-modal-body section"),d=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find(".hustle-modal-image"),u=n.find("article, .hustle-modal-message"),p=n.find("article blockquote, .hustle-modal-message blockquote"),m=n.find("article a, .hustle-modal-message a"),h=n.find(".hustle-modal-cta"),v=n.find(".hustle-modal-close"),g=n.find(".hustle-modal-close svg path"),f=n.find(".wpmudev-modal-mask");"cabriolet"===s?l.css("background-color",i.main_bg_color):a.css("background-color",i.main_bg_color),d.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("background-color",i.image_container_bg),u.css("color",i.content_color),p.css("border-left-color",i.link_static_color),p.mouseover(function(){e(this).css("border-left-color",i.link_hover_color)}).mouseout(function(){e(this).css("border-left-color",i.link_static_color)}),m.css("color",i.link_static_color),m.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),h.css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color}),h.mouseover(function(){e(this).css({"background-color":i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color})}),g.css("fill",i.close_button_static_color),v.mouseover(function(){g.css("fill",i.close_button_hover_color)}).mouseout(function(){g.css("fill",i.close_button_static_color)}),f.css("background-color",i.overlay_bg);var w=o.find(".hustle-modal-image img"),b="",y="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(b="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,y="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,w.css("object-position",b+" "+y)),"right"===t.feature_image_location&&c.addClass("hustle-modal-image-right"),_.isTrue(i.border)){var x=i.border_weight+"px "+i.border_type+" "+i.border_color;"cabriolet"===s?n.find("section").css({border:x,"border-radius":i.border_radius+"px"}):a.css({border:x,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var k=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;"cabriolet"===s?n.find("section").css({"box-shadow":k}):a.css({"box-shadow":k})}},apply_preview_optin_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),l=n.find(".hustle-modal-success"),d=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find("article"),u=n.find("article blockquote"),p=n.find("article a:not(.hustle-modal-cta)"),m=n.find(".hustle-modal-image"),h=n.find(".hustle-modal-optin_field"),v=h.find("label .hustle-modal-optin_icon .hustle-icon path"),g=h.find("label .hustle-modal-optin_placeholder"),f=n.find(".hustle-modal-optin_button button"),w=n.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),b=n.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),y=n.find(".hustle-modal-close"),x=n.find(".hustle-modal-close svg path");a.css("background-color",i.main_bg_color),l.css("background-color",i.main_bg_color),a.find(".hustle-modal-image").css("background-color",i.image_container_bg),"one"===s||"two"===s?n.find("footer").css("background-color",i.form_area_bg):n.find(".hustle-modal-optin_wrap").css("background-color",i.form_area_bg),d.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("color",i.content_color),u.css("border-left-color",i.link_static_color),p.css("color",i.link_static_color),p.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),c.find(".hustle-modal-cta").css({background:i.cta_button_static_bg,color:i.cta_button_static_color}),c.find(".hustle-modal-cta").mouseover(function(){e(this).css({background:i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({background:i.cta_button_static_bg,color:i.cta_button_static_color})}),h.find("input").css("color",i.optin_form_field_text_static_color),h.css("background-color",i.optin_input_static_bg),h.mouseover(function(){e(this).find("input").css("color",i.optin_form_field_text_hover_color),e(this).css("background-color",i.optin_input_hover_bg)}).mouseout(function(){e(this).find("input").css("color",i.optin_form_field_text_static_color),e(this).css("background-color",i.optin_input_static_bg)}),v.css("fill",i.optin_input_icon),f.css("color",i.optin_submit_button_static_color),f.css("background-color",i.optin_submit_button_static_bg),f.mouseover(function(){e(this).css("color",i.optin_submit_button_hover_color),e(this).css("background-color",i.optin_submit_button_hover_bg)}).mouseout(function(){e(this).css("color",i.optin_submit_button_static_color),e(this).css("background-color",i.optin_submit_button_static_bg)}),g.css("color",i.optin_placeholder_color),w.css("background-color",i.optin_check_radio_static_bg),b.css("background-color",i.optin_check_radio_static_bg);var k=e("#hustle-module-checkbox-radio-custom-styles"),C=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before",$=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before",O=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before",S=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before",z=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label",H=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label",M=".wpmudev-ui .wpmudev-modal .wpmudev-modal-mask",E=C+" { color: "+i.optin_check_radio_static_bg+"; }"+$+" { color: "+i.optin_check_radio_tick_color+"; }"+O+" { color: "+i.optin_check_radio_static_bg+"; }"+S+" { color: "+i.optin_check_radio_tick_color+"; }"+z+" { color: "+i.optin_mailchimp_title_color+"; }"+H+" { color: "+i.optin_mailchimp_labels_color+"; }"+M+" { background-color: "+i.overlay_bg+"; }";k.length&&k.remove(),e('<style id="hustle-module-mailchimp-custom-styles">'+E+"</style>").appendTo("body"),x.css("fill",i.close_button_static_color),y.mouseover(function(){x.css("fill",i.close_button_hover_color)}).mouseout(function(){x.css("fill",i.close_button_static_color)});var T=o.find(".hustle-modal-image img"),j="",D="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(j="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,D="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,T.css({"background-position":j+" "+D,"object-position":j+" "+D})),_.isTrue(i.border)){var P=i.border_weight+"px "+i.border_type+" "+i.border_color;
a.css({border:P,"border-radius":i.border_radius+"px"})}if("right"===t.feature_image_location&&m.addClass("hustle-modal-image-right"),_.isTrue(i.drop_shadow)){var N=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;a.css({"box-shadow":N})}if(_.isTrue(i.form_fields_border)){var V=i.form_fields_border_weight+"px "+i.form_fields_border_type+" "+i.form_fields_border_color;h.css({border:V,"border-radius":i.form_fields_border_radius+"px"})}if(_.isTrue(i.button_border)){var J=i.button_border_weight+"px "+i.button_border_type+" "+i.button_border_color;f.css({border:J,"border-radius":i.button_border_radius+"px"})}},handle_email_service:function(t,i){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),i?(this.content_view.model.set("active_email_service",t),_.isEmpty(s)?s[t]={enabled:i}:_.each(s,function(i,o){o===t?s[o]=_.extend(s[o],{enabled:1}):(s[o]=_.extend(s[o],{enabled:0}),e('input[data-attribute="'+o+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[t]=_.extend(s[t],{enabled:i})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model,i=t.get("auto_close_success_message"),s=this.content_view.model.get("auto_close_time"),o=this.content_view.model.get("auto_close_unit"),n=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(i)){var a=parseInt(s),l=o;"minutes"===l&&(a*=60),a*=1e3,_.delay(function(){var e=n.find(".hustle-modal"),t=e.find(".hustle-modal-close .hustle-icon");t.length>0?t.trigger("click"):$success_msg.removeAttr("style")},a)}}})}),Hustle.define("Embedded.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-content-tpl"),module_id:0,target_container:e("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,service_supports_fields:!0,current_form_elements:[],content_form_container:e(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="embedded",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return"undefined"==typeof t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"embedded"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-embedded-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"embedded",target_div:t}),t.html(""),t.html(this.media_holder.$el))},add_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.add_service(i)},edit_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.edit_service(i)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Embedded.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click()),this.$el.find("#popup_overlay_color").parents(".wpmudev-col").hide()},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Embedded.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .wpmudev-row .wpmudev-box-head":"toggle_module_accordion","click .wpmudev-row .wpmudev-box-head .wpmudev-box-action":"module_toggle_clicked","click .hustle-delete-module":"delete_module","click .module-active-state":"toggle_module_activity","click .button-view-email-list":"view_email_list","click .button-view-log-list":"view_error_log_list","change .module-toggle-tracking-activity":"toggle_tracking_activity","change [name='wph-module-status']":"module_status_updated"},initialize:function(){var i=this;this.$(".optin-type-active-state").each(function(){i.set_testmode_visibiliy(e(this),0)}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}})},module_toggle_clicked:function(t){t.stopPropagation(),e(t.target).closest(".wpmudev-box-head").click()},toggle_module_accordion:function(t){if(_.indexOf(["wpmudev-box-head","wpmudev-box-action","wpmudev-box-group","wpmudev-box-group--inner","wpmudev-group-title","wpmudev-helper"],t.target.className)!==-1){var i=e(t.target),s=i.parents(".wpmudev-row").find(".wpmudev-box-action"),o=i.parents(".wpmudev-row").find(".wpmudev-box-body");o.slideToggle("fast",function(){s.toggleClass("wpmudev-action-show"),o.toggleClass("wpmudev-hidden")})}},delete_module:function(t){var i=e(t.target).closest("a.hustle-delete-module"),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_module_activity:function(t){var i=this.$(t.target),s=i.data()||{},o=i.parents(".wpmudev-row");s.action="hustle_embedded_module_toggle_state",s._ajax_nonce=s.nonce,i.prop("disabled",!0),i.is(":checked")?(o.find(".wpmudev-box-body .wpmudev-box-disabled").removeClass("wpmudev-box-disabled").addClass("wpmudev-box-enabled"),o.find("input").prop("disabled",!1)):(o.find(".wpmudev-box-body .wpmudev-box-enabled").removeClass("wpmudev-box-enabled").addClass("wpmudev-box-disabled"),o.find("input").prop("disabled",!0)),e.post(ajaxurl,s,function(e){i.prop("disabled",!1)})},view_email_list:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.currentTarget).hasClass("wpmudev-button")?e(t.currentTarget):e(t.currentTarget).parents(".wpmudev-button"),s=i.data("id"),o=i.data("name"),n=i.data("total"),a=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new a({model:{id:s,total:n,name:o,type:"embedded",module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_embedded_module_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),o=s.id,n=s.name,a="embedded",l=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new l({button:i,model:{name:n,id:o,type:a,total:s.total}})},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_embedded_toggle_test_activity":(o.action="hustle_embedded_module_toggle_type_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})}})}),Hustle.define("Embedded.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"embedded"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=(Hustle.get("Models.Trigger"),Hustle.get("Models.M").extend({defaults:{after_content_enabled:!1,widget_enabled:!0,shortcode_enabled:!0,conditions:"",animation_in:"",animation_out:"",on_submit:"default"},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}));return{Base:e,Content:t,Design:i,Display_Settings:s}}),Hustle.define("Embedded.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Embedded.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-embedded-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),e(document).off("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).off("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).off("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).off("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).off("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).off("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).off("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).off("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).off("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).off("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).off("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).off("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).off("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).off("keydown",e.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),e(document).on("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).on("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).on("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).on("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).on("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).on("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).on("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).on("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).on("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).on("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).on("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).on("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).on("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),e(document).on("keydown",e.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",e.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"));this.use_email_collection_changed(e),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var l=tinyMCE.get("gdpr_message"),d=this.$("textarea#gdpr_message"),r="true"===d.attr("aria-hidden")?l.getContent():d.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var t=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");t.length&&t.remove();var i=this,s=i.content_view.model.get("main_content"),o=e(".wpmudev-preview").data("nonce");s.search(/\[/g)===-1?i.render_preview(i.content_view.model.toJSON()):e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:s,_ajax_nonce:o},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(e){var t=this,i=this.content_view.model.get("use_email_collection"),s=_.isTrue(i)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),o=_.extend(t.model.toJSON(),{content:e,design:t.design_view.model.toJSON(),settings:t.settings_view.model.toJSON()});t.$("#wph-preview-modal").append(s(o)),t.apply_custom_css(),t.apply_preview_styles(),t.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",t)},after_preview_render:function(){var t=this,i=this.$("#wph-preview-modal").addClass("wpmudev-modal-active"),s=i.find(".hustle-modal"),o=this.settings_view.model.get("animation_in");e("body").addClass("wpmudev-modal-is_active"),s.hasClass("hustle-animated")?setTimeout(function(){s.addClass("hustle-animate-"+o),t.apply_custom_size()},100):this.apply_custom_size()},apply_preview_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.style;if(_.isTrue(t.use_email_collection))return void this.apply_preview_optin_styles();var o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),l=n.find(".hustle-modal-body section"),d=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find(".hustle-modal-image"),u=n.find("article, .hustle-modal-message"),p=n.find("article blockquote, .hustle-modal-message blockquote"),m=n.find("article a, .hustle-modal-message a"),h=n.find(".hustle-modal-cta"),v=n.find(".hustle-modal-close"),g=n.find(".hustle-modal-close svg path"),f=o.find(".wpmudev-modal-mask");"cabriolet"===s?l.css("background-color",i.main_bg_color):a.css("background-color",i.main_bg_color),d.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("background-color",i.image_container_bg),u.css("color",i.content_color),p.css("border-left-color",i.link_static_color),p.mouseover(function(){e(this).css("border-left-color",i.link_hover_color)}).mouseout(function(){e(this).css("border-left-color",i.link_static_color)}),m.css("color",i.link_static_color),m.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),h.css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color}),h.mouseover(function(){e(this).css({"background-color":i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color})}),g.css("fill",i.close_button_static_color),v.mouseover(function(){g.css("fill",i.close_button_hover_color)}).mouseout(function(){g.css("fill",i.close_button_static_color)}),f.css("background-color",i.overlay_bg);var w=o.find(".hustle-modal-image img"),b="",y="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(b="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,y="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,w.css({"background-position":b+" "+y,"object-position":b+" "+y})),_.isTrue(i.border)){var x=i.border_weight+"px "+i.border_type+" "+i.border_color;"cabriolet"===s?n.find("section").css({border:x,"border-radius":i.border_radius+"px"}):a.css({border:x,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var k=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;"cabriolet"===s?n.find("section").css({"box-shadow":k}):a.css({"box-shadow":k})}},apply_preview_optin_styles:function(){var t=(this.content_view.model.toJSON(),this.design_view.model.toJSON()),i=t.form_layout,s=this.$("#wph-preview-modal"),o=s.find(".hustle-modal"),n=o.find(".hustle-modal-body"),a=o.find(".hustle-modal-success"),l=o.find(".hustle-modal-title"),d=o.find(".hustle-modal-subtitle"),r=o.find("article"),c=o.find("article blockquote"),u=o.find("article a:not(.hustle-modal-cta)"),p=o.find(".hustle-modal-optin_field"),m=p.find("label .hustle-modal-optin_icon .hustle-icon path"),h=p.find("label .hustle-modal-optin_placeholder"),v=o.find(".hustle-modal-optin_button button"),g=o.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),f=o.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),w=o.find(".hustle-modal-close"),b=o.find(".hustle-modal-close svg path");n.css("background-color",t.main_bg_color),a.css("background-color",t.main_bg_color),n.find(".hustle-modal-image").css("background-color",t.image_container_bg),"one"===i||"two"===i?o.find("footer").css("background-color",t.form_area_bg):o.find(".hustle-modal-optin_wrap").css("background-color",t.form_area_bg),l.css("color",t.title_color),d.css("color",t.subtitle_color),r.css("color",t.content_color),c.css("border-left-color",t.link_static_color),u.css("color",t.link_static_color),u.mouseover(function(){e(this).css("color",t.link_hover_color)}).mouseout(function(){e(this).css("color",t.link_static_color)}),r.find(".hustle-modal-cta").css({background:t.cta_button_static_bg,color:t.cta_button_static_color}),r.find(".hustle-modal-cta").mouseover(function(){e(this).css({background:t.cta_button_hover_bg,color:t.cta_button_hover_color})}).mouseout(function(){e(this).css({background:t.cta_button_static_bg,color:t.cta_button_static_color})}),p.find("input").css("color",t.optin_form_field_text_static_color),p.css("background-color",t.optin_input_static_bg),p.mouseover(function(){e(this).find("input").css("color",t.optin_form_field_text_hover_color),e(this).css("background-color",t.optin_input_hover_bg)}).mouseout(function(){e(this).find("input").css("color",t.optin_form_field_text_static_color),e(this).css("background-color",t.optin_input_static_bg)}),m.css("fill",t.optin_input_icon),v.css("color",t.optin_submit_button_static_color),v.css("background-color",t.optin_submit_button_static_bg),v.mouseover(function(){e(this).css("color",t.optin_submit_button_hover_color),e(this).css("background-color",t.optin_submit_button_hover_bg)}).mouseout(function(){e(this).css("color",t.optin_submit_button_static_color),e(this).css("background-color",t.optin_submit_button_static_bg)}),h.css("color",t.optin_placeholder_color),g.css("background-color",t.optin_check_radio_static_bg),f.css("background-color",t.optin_check_radio_static_bg);var y=e("#hustle-module-checkbox-radio-custom-styles"),x=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before",k=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before",C=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before",$=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before",O=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label",S=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label",z=".wpmudev-ui .wpmudev-modal .wpmudev-modal-mask",H=x+" { color: "+t.optin_check_radio_static_bg+"; }"+k+" { color: "+t.optin_check_radio_tick_color+"; }"+C+" { color: "+t.optin_check_radio_static_bg+"; }"+$+" { color: "+t.optin_check_radio_tick_color+"; }"+O+" { color: "+t.optin_mailchimp_title_color+"; }"+S+" { color: "+t.optin_mailchimp_labels_color+"; }"+z+" { background-color: "+t.overlay_bg+"; }";y.length&&y.remove(),e('<style id="hustle-module-mailchimp-custom-styles">'+H+"</style>").appendTo("body"),b.css("fill",t.close_button_static_color),w.mouseover(function(){b.css("fill",t.close_button_hover_color)}).mouseout(function(){b.css("fill",t.close_button_static_color)});var M=s.find(".hustle-modal-image img"),E="",T="";if("contain"!==t.feature_image_fit&&"cover"!==t.feature_image_fit||(E="custom"===t.feature_image_horizontal?t.feature_image_horizontal_px+"px":t.feature_image_horizontal,T="custom"===t.feature_image_vertical?t.feature_image_vertical_px+"px":t.feature_image_vertical,M.css({"background-position":E+" "+T,"object-position":E+" "+T})),_.isTrue(t.border)){var j=t.border_weight+"px "+t.border_type+" "+t.border_color;n.css({border:j,"border-radius":t.border_radius+"px"})}if(_.isTrue(t.drop_shadow)){var D=t.drop_shadow_x+"px "+t.drop_shadow_y+"px "+t.drop_shadow_blur+"px "+t.drop_shadow_spread+"px "+t.drop_shadow_color;n.css({"box-shadow":D})}if(_.isTrue(t.form_fields_border)){var P=t.form_fields_border_weight+"px "+t.form_fields_border_type+" "+t.form_fields_border_color;p.css({border:P,"border-radius":t.form_fields_border_radius+"px"})}if(_.isTrue(t.button_border)){var N=t.button_border_weight+"px "+t.button_border_type+" "+t.button_border_color;v.css({border:N,"border-radius":t.button_border_radius+"px"})}},apply_custom_size:function(){var e=this.content_view.model.toJSON(),t=this.design_view.model.toJSON(),i=t.style,s=t.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body");if(_.isTrue(t.customize_size)){if(n.css({width:t.custom_width+"px","max-width":"none"}),"simple"===i&&_.isFalse(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,d=n.find(".hustle-modal-content");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),d.css({height:"calc("+t.custom_height+"px - "+l+"px)","overflow-y":"auto"})}if("minimal"===i&&_.isFalse(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,r=n.find("section"),c=n.find(".hustle-modal-message");if(!_.isTrue(e.has_title)||""===e.title&&""===e.sub_title)var u=0;else var u=n.find("header").outerHeight();
if(_.isTrue(e.show_cta)&&""!==e.cta_label&&""!==e.cta_url)var p=n.find("footer").innerHeight();else var p=0;r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+u+"px - "+p+"px)"}),c.css({height:"calc("+t.custom_height+"px - "+l+"px - "+u+"px - "+p+"px)","overflow-y":"auto"})}if("cabriolet"===i&&_.isFalse(e.use_email_collection)){var u=n.find("header").height()+20,r=n.find("section"),c=n.find(".hustle-modal-message");r.css({height:"calc("+t.custom_height+"px - "+u+"px)"}),c.css({height:"calc("+t.custom_height+"px - "+u+"px)","overflow-y":"auto"})}if("one"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,p=n.find("footer").height(),m=n.find(".hustle-modal-image"),r=n.find("section"),h=n.find("article");if(r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"}),r.hasClass("hustle-modal-image_above")||r.hasClass("hustle-modal-image_below")){t.custom_height+l+p;r.height()<250?r.css({"overflow-y":"auto"}):h.css({height:"calc("+r.height()+"px - "+m.height()+"px)","overflow-y":"auto"})}else h.css({"max-height":"calc("+t.custom_height+"px - "+l+"px - "+p+"px)","overflow-y":"auto"}),m.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"})}if("two"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,p=n.find("footer").height(),v=n.find(".hustle-modal-body"),r=n.find("section"),h=n.find("article");v.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),r.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px - "+p+"px)","overflow-y":"auto"})}if("three"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,g=n.find(".hustle-modal-image").height(),h=n.find("article");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px - "+g+"px)","overflow-y":"auto"})}if("four"===s&&_.isTrue(e.use_email_collection)){var l=n.find(".hustle-modal-close").height()+15,g=n.find(".hustle-modal-image").height(),f=t.custom_height-l-g,w=n.find(".hustle-modal-optin_wrap"),h=n.find("article");a.css({height:"calc("+t.custom_height+"px - "+l+"px)"}),h.css({height:"calc("+t.custom_height+"px - "+l+"px)","overflow-y":"auto"}),w.css({height:"calc("+t.custom_height+"px - "+l+"px - "+g+"px)","overflow-y":"auto"}),n.find(".hustle-modal-optin_form").innerHeight()>f&&w.css({"align-items":"flex-start"})}}},apply_custom_css:function(){var t=e("#hustle-module-custom-styles");t.remove();var i=this.design_view.model.toJSON().customize_css;if(1===i||"1"===i){var s=this.design_view.model.get("custom_css"),o=e("#hustle_custom_css").data("nonce");if(_.isEmpty(s)||"undefined"==typeof o)return;e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_embedded_prepare_custom_css",css:s,_ajax_nonce:o},success:function(t){if(t&&t.success){var i=e("#hustle-module-custom-styles");i.length&&i.remove(),e('<style id="hustle-module-custom-styles">'+t.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(t){t.stopPropagation();var i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=this.settings_view.model.get("animation_in"),n="hustle-animate-"+o,a=this.settings_view.model.get("animation_out"),l="hustle-animate-"+a,d=1e3;s.removeClass(n).addClass(l),s.hasClass("hustle-animated")&&("fadeOut"===a&&(d=305),"newspaperOut"===a&&(d=505),"bounceOut"===a&&(d=755),setTimeout(function(){i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass(l)},d)),s.hasClass("hustle-modal-static")&&(s.removeClass("hustle-modal-static"),i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"))},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},save:function(t){if(!Module.Validate.validate_module_name())return!1;this.set_content_from_tinymce(!0),this.sanitize_data();var i=this,s=this.model.toJSON(),o=this.content_view.model.toJSON(),n=this.design_view.model.toJSON(),a=this.settings_view.model.toJSON();return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_embedded_module",_ajax_nonce:t.data("nonce"),id:t.data("id")?t.data("id"):"-1",module:s,content:o,design:n,settings:a,shortcode_id:i._get_shortcode_id()},complete:function(e){e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.target);i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section||!1,o="";return window.onbeforeunload=null,s&&"content"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t=e.changed,i=Object.keys(t);if("has_title"in t){var s=this.$("#wph-wizard-content-title-textboxes");s.length&&(t.has_title?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_feature_image"in t){var s=this.$("#wph-wizard-content-image-options");s.length&&(t.use_feature_image?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_cta"in t){var s=this.$("#wph-wizard-content-cta-options");s.length&&(t.show_cta?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_gdpr"in t){var s=this.$("#wph-wizard-content-gdpr-message");s.length&&(t.show_gdpr?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_email_collection"in t&&this.use_email_collection_changed(t.use_email_collection),"after_successful_submission"in t&&this.after_successful_submission_changed(t.after_successful_submission),"auto_close_success_message"in t){var s=this.$("#wph-wizard-content-form_success_options");s.length&&(t.auto_close_success_message?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if(i[0].indexOf("_service_provider")!==-1){var o=i[0].replace("_service_provider","");this.handle_email_service(o,t[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}if("feature_image_fit"in t){var s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options");s.length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_horizontal"in t){var s=this.$("#wph-wizard-design-horizontal-position");s.length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_vertical"in t){var s=this.$("#wph-wizard-design-vertical-position");s.length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("border"in t){var s=this.$("#wph-wizard-design-border-options");s.length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("form_fields_border"in t){var s=this.$("#wph-wizard-design-form-fields-border-options");s.length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("button_border"in t){var s=this.$("#wph-wizard-design-button-border-options");s.length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("drop_shadow"in t){var s=this.$("#wph-wizard-design-shadow-options");s.length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_size"in t){var s=this.$("#wph-wizard-design-size-options");s.length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_css"in t){var s=this.$("#wph-wizard-design-css_holder");s.length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}"on_time_delay"in t&&this.settings_view.model.set("triggers.on_time_delay",t.on_time_delay,{silent:!0}),"on_time_unit"in t&&this.settings_view.model.set("triggers.on_time_unit",t.on_time_unit,{silent:!0}),"on_exit_intent"in t&&this.settings_view.model.set("triggers.on_exit_intent",t.on_exit_intent,{silent:!0}),"on_exit_intent_per_session"in t&&this.settings_view.model.set("triggers.on_exit_intent_per_session",t.on_exit_intent_per_session,{silent:!0}),"on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0})},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},update_color_palette:function(e){var t=this,i=parseInt(this.content_view.model.get("use_email_collection"));if(i){var s=this.$('option[value="'+e+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(n,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var e=this,t=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_"),i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+t+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];_.each(n,function(t,i){e.$('input[data-attribute="'+i+'"]').val(t).trigger("change")})}}},use_email_collection_changed:function(e){var t=this.$("#wph-wizard-content-email"),i=this.$("#wph-wizard-content-email-options"),s=this.$("#wph-wizard-content-form_elements"),o=this.$("#wph-wizard-content-form_submission"),n=this.$("#wph-wizard-content-form_message"),a=this.$("#wph-wizard-content-form_success");parseInt(e)?(t.removeClass("last"),i.removeClass("wpmudev-hidden_table"),i.addClass("wpmudev-show_table"),s.show(),o.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.model.set("style","gray_slate")):(t.hasClass("last")||t.addClass("last"),i.removeClass("wpmudev-show_table"),i.addClass("wpmudev-hidden_table"),s.hide(),o.hide(),n.hide(),a.hide(),this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_cta_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("cta_target",s.val(),{silent:!0})},toggle_submit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",s.val())},toggle_feature_image_position_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",s.val(),{silent:!0})},toggle_feature_image_fit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",s.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",s.val(),{silent:!1})},toggle_feature_image_vertical_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",s.val(),{silent:!1})},toggle_form_fields_icon_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",s.val(),{silent:!1})},toggle_form_fields_proximity_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",s.val(),{silent:!1})},toggle_display_triggers:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",s.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},handle_email_service:function(t,i){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),i?(this.content_view.model.set("active_email_service",t),_.isEmpty(s)?s[t]={enabled:i}:_.each(s,function(i,o){o===t?s[o]=_.extend(s[o],{enabled:1}):(s[o]=_.extend(s[o],{enabled:0}),e('input[data-attribute="'+o+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[t]=_.extend(s[t],{enabled:i})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model,i=t.get("auto_close_success_message"),s=this.content_view.model.get("auto_close_time"),o=this.content_view.model.get("auto_close_unit"),n=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(i)){var a=parseInt(s),l=o;"minutes"===l&&(a*=60),a*=1e3,_.delay(function(){var e=n.find(".hustle-modal"),t=e.find(".hustle-modal-close .hustle-icon");t.length>0?t.trigger("click"):$success_msg.removeAttr("style")},a)}}})}),Hustle.define("SShare.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-sshare-section-services-tpl"),target_container:e("#wpmudev-hustle-box-section-services"),init:function(e){return this.stopListening(this.model,"change",this.model_updated),this.listenTo(this.model,"change",this.model_updated),this.render()},events:{"click ul.wpmudev-tabs-menu li label":"toggle_checkbox","change .wpmudev-social-item input.wpmudev-social-item-native-enable":"toggle_icon","change .wpmudev-social-custom .wpmudev-social-item input.toggle-checkbox":"toggle_icon"},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return this.setElement(this.template(_.extend({module_type:"social_sharing"},t))),this}},after_render:function(){this.target_container.length},model_updated:function(e){var t=e.changed;"service_type"in t&&this.service_type_updated(t.service_type),"click_counter"in t&&this.click_counter_updated(t.click_counter)},service_type_updated:function(t){var i=this.$("#wpmudev-sshare-counter-options"),s=e(".wph-wizard-services-icons-native"),o=e(".wph-wizard-services-icons-custom");"native"===t?(i.removeClass("wpmudev-hidden"),o.addClass("wpmudev-hidden"),s.removeClass("wpmudev-hidden")):(i.addClass("wpmudev-hidden"),s.addClass("wpmudev-hidden"),o.removeClass("wpmudev-hidden"))},click_counter_updated:function(t){e("#wph-wizard-services-icons-native .wpmudev-social-item").each(function(){var i=e(this).find(".toggle-checkbox"),s=i.is(":checked"),o=e(this).find("input.wpmudev-input_number");t&&s?o.removeClass("wpmudev-hidden"):o.hasClass("wpmudev-hidden")||o.addClass("wpmudev-hidden")})},toggle_checkbox:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.closest("li"),s=i.find("input"),o=s.data("attribute");i.hasClass("current")||(i.addClass("current"),i.siblings().removeClass("current"),this.model.set(o,s.val()))},toggle_icon:function(e){var t=this.$(e.target),i=t.is(":checked"),s=this.model.get("click_counter"),o=t.closest(".wpmudev-social-item"),n=o.find("input.wpmudev-input_number"),a=!(!i||!s);i?o.removeClass("disabled"):o.addClass("disabled"),t.parents(".wpmudev-social-native").length>0&&(a?n.removeClass("wpmudev-hidden"):n.addClass("wpmudev-hidden"))},set_social_icons:function(){var e=this.model.toJSON();e=this.get_social_icons_data(e),this.model.set("social_icons",e.social_icons,{silent:!0})},get_social_icons_data:function(t){var i=e("#wph-wizard-services-icons-"+t.service_type+" .wpmudev-social-item"),s={};return i.each(function(){var t=e(this),i=t.find("input.toggle-checkbox"),o=i.data("id"),n=t.find("input.wpmudev-input_number"),a=t.find("input.wpmudev-input_text");if(n.length){var l=parseInt(n.val());l<0&&n.val(0)}i.is(":checked")&&(s[o]={enabled:!0,counter:n.length?n.val():"0",link:a.length?a.val():""})}),i.length&&(t.social_icons=s),t}}))}),Hustle.define("SShare.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-sshare-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),social_icons:{},service_type:"native",click_counter:!0,excluded_rerender:["floating_social_bg","floating_counter_color","floating_counter_border","icon_bg_color","icon_color","drop_shadow_x","drop_shadow_y","drop_shadow_blur","drop_shadow_spread","drop_shadow_color","widget_icon_bg_color","widget_icon_color","widget_bg_color","widget_drop_shadow_x","widget_drop_shadow_y","widget_drop_shadow_blur","widget_drop_shadow_spread","widget_drop_shadow_color","widget_counter_border","widget_counter_color"],init:function(e){return this.on("rendered",this.create_color_pickers),this.social_icons=e.social_icons,this.service_type=e.service_type,this.click_counter=e.click_counter,this.render_design()},render_design:function(e){if(this.target_container.length){var t=this,i=this.model.toJSON();return this._handle_icons_order(),this.setElement(this.template(_.extend({module_type:"social_sharing",social_icons:t.social_icons,service_type:t.service_type,click_counter:t.click_counter},i))),this}},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.make_icons_sortable(),this._handle_preview())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},make_icons_sortable:function(){var e=this,t={items:".hustle-social-icon",revert:!0,axis:"x",containment:this.$("#wpmudev-reoder-icons"),stop:function(t,i){e._reorder_icons()}};this.$("#wph-reorder-icons").sortable(t).disableSelection()},model_updated:function(e){this._handle_preview()},_handle_preview:function(){var t=e("#wph-sshare-preview-floating .hustle-shares-floating"),i=t.find(".hustle-shares-counter"),s=t.find(".hustle-icon-container"),o=t.find(".hustle-icon-path"),n=t.find(".hustle-social-icon"),a=e("#wph-sshare-preview-widget .hustle-shares-widget"),l=a.find(".hustle-shares-counter"),d=a.find(".hustle-icon-container"),r=a.find(".hustle-icon-path"),c=a.find(".hustle-social-icon"),u=this.model.toJSON();if(t.css("background-color",u.floating_social_bg),i.css("color",u.floating_counter_color),_.isTrue(u.customize_colors)&&("rounded"===u.icon_style||"squared"===u.icon_style?s.css("background-color",u.icon_bg_color):"outline"===u.icon_style&&n.css("border-color",u.icon_bg_color),o.css("fill",u.icon_color),"native"===this.service_type&&_.isTrue(this.click_counter)&&n.css("border-color",u.floating_counter_border)),_.isTrue(u.drop_shadow)){var p=""+u.drop_shadow_x+"px "+u.drop_shadow_y+"px "+u.drop_shadow_blur+"px "+u.drop_shadow_spread+"px "+u.drop_shadow_color;t.css("box-shadow",p)}if(a.css("background-color",u.widget_bg_color),l.css("color",u.widget_counter_color),_.isTrue(u.customize_widget_colors)&&("rounded"===u.icon_style||"squared"===u.icon_style?d.css("background-color",u.widget_icon_bg_color):"outline"===u.icon_style&&c.css("border-color",u.widget_icon_bg_color),r.css("fill",u.widget_icon_color),"native"===this.service_type&&_.isTrue(this.click_counter)&&c.css("border-color",u.widget_counter_border)),_.isTrue(u.widget_drop_shadow)){var m=""+u.widget_drop_shadow_x+"px "+u.widget_drop_shadow_y+"px "+u.widget_drop_shadow_blur+"px "+u.widget_drop_shadow_spread+"px "+u.widget_drop_shadow_color;a.css("box-shadow",m)}},_handle_icons_order:function(){var e={},t=this.social_icons,i=this.model.get("icons_order"),s=i.split(",");i&&s.length&&(_.each(s,function(i,s){"undefined"!=typeof t[i]&&(e[i]=t[i],t=_.pick(t,function(e,t){if(i!==t)return t=e}))}),Object.keys(t).length&&(e=_.extend(e,_.pick(t,function(e,t){if("undefined"!=typeof e)return t=e}))),this.social_icons=e)},_reorder_icons:function(){var t=[];e("#wph-reorder-icons .hustle-social-icon").each(function(){t.push(e(this).data("id"))}),this.model.set("icons_order",t.join())}}))}),Hustle.define("SShare.Listing",function(e,t,i){"use strict";var s=Hustle.get("Delete_Confirmation");return Backbone.View.extend({el:"#wpmudev-hustle",events:{"click .wpmudev-row .wpmudev-box-head":"toggle_module_accordion","click .wpmudev-row .wpmudev-box-head .wpmudev-box-action":"module_toggle_clicked","click .social-sharing-edit":"edit","click .hustle-delete-module":"delete_module","change .social-sharing-toggle-activity":"toggle_module_activity","change .social-sharing-toggle-tracking-activity":"toggle_tracking_activity","change [name='wph-module-status']":"module_status_updated"},delete_confirmations:{},initialize:function(){this.delete_confirmation=new s({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}})},module_toggle_clicked:function(t){t.stopPropagation(),e(t.target).closest(".wpmudev-box-head").click()},toggle_module_accordion:function(t){if(_.indexOf(["wpmudev-box-head","wpmudev-box-action","wpmudev-box-group","wpmudev-box-group--inner","wpmudev-group-title","wpmudev-helper"],t.target.className)!==-1){var i=e(t.target),s=i.parents(".wpmudev-row").find(".wpmudev-box-action"),o=i.parents(".wpmudev-row").find(".wpmudev-box-body");o.slideToggle("fast",function(){s.toggleClass("wpmudev-action-show"),o.toggleClass("wpmudev-hidden")})}},toggle_module_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.is(":checked"),a=i.parents(".wpmudev-row");i.prop("disabled",!0),n?(a.find(".wpmudev-box-body .wpmudev-box-disabled").removeClass("wpmudev-box-disabled").addClass("wpmudev-box-enabled"),a.find("input").prop("disabled",!1)):(a.find(".wpmudev-box-body .wpmudev-box-enabled").removeClass("wpmudev-box-enabled").addClass("wpmudev-box-disabled"),a.find("input").prop("disabled",!0)),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_sshare_module_toggle_state",id:s,_ajax_nonce:o},complete:function(){i.prop("disabled",!1)},success:function(e){e.success||i.attr("checked",!n)},error:function(){i.attr("checked",!n)}})},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_sshare_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_type_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_type_activity",id:s,type:n,_ajax_nonce:o},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},edit:function(e){e.stopPropagation()},delete_module:function(t){var i=e(t.target).closest("a.hustle-delete-module"),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_sshare_toggle_test_activity":(o.action="hustle_sshare_module_toggle_type_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})}})}),Hustle.define("SShare.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"social_sharing"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",active:1,test_mode:0,service_type:"native",click_counter:1,social_icons:""}}),i=Hustle.get("Models.M").extend({defaults:{icon_style:"squared",icons_order:"",customize_colors:0,icon_bg_color:"rgba(146, 158, 170, 1)",icon_color:"rgba(255, 255, 255, 1)",floating_social_bg:"rgba(4, 48, 69, 1)",floating_counter_border:"rgba(146, 158, 170, 1)",floating_counter_color:"rgba(255, 255, 255, 1)",floating_social_animate_icons:0,drop_shadow:0,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0)",floating_inline_count:0,customize_widget_colors:0,widget_icon_bg_color:"rgba(146, 158, 170, 1)",widget_icon_color:"rgba(255, 255, 255, 1)",widget_bg_color:"rgba(146, 158, 170, 1)",widget_animate_icons:0,widget_drop_shadow:0,widget_drop_shadow_x:0,widget_drop_shadow_y:0,widget_drop_shadow_blur:0,widget_drop_shadow_spread:0,widget_drop_shadow_color:"rgba(0,0,0,0)",widget_inline_count:0,widget_counter_border:"rgba(146, 158, 170, 1)",widget_counter_color:"rgba(255, 255, 255, 1)"}}),s=Hustle.get("Models.M").extend({defaults:{floating_social_enabled:!0,widget_enabled:!0,shortcode_enabled:!0,conditions:"",location_type:"screen",location_target:"",location_align_x:"left",location_align_y:"top",location_top:0,location_bottom:0,location_right:0,location_left:0},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}),o=Hustle.get("Models.M").extend({defaults:{widget:"",shortcode:""}});return{Base:e,Content:t,Design:i,Display_Settings:s,Types:o}}),Hustle.define("SShare.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpmudev-hustle-sshare-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),message_editor:!1,events:{"click .wpmudev-copy button":"copy_shortcode"},init:function(e){return this.stopListening(this.model,"change",this.model_updated),this.listenTo(this.model,"change",this.model_updated),this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render();
},render:function(){if(this.target_container.length){var e=this.model.toJSON();return this.setElement(this.template(_.extend({module_type:"social_sharing"},e))),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),this}},after_render:function(){this.target_container.length},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-floating-social-condition-labels").toggle()},update_conditions_label:function(t){e("#wph-floating-social-condition-labels").html(t.get_all_conditions_labels())},model_updated:function(e){var t=e.changed;if(console.log(t),"location_type"in t){var i=this.$("#wpmudev-sshare-selector-location-options");"selector"===t.location_type?i.removeClass("wpmudev-hidden"):i.addClass("wpmudev-hidden")}if("location_align_x"in t){var s=this.$("#wpmudev-floating-horizontal-left"),o=this.$("#wpmudev-floating-horizontal-right");"left"===t.location_align_x?(s.addClass("current"),o.removeClass("current")):(s.removeClass("current"),o.addClass("current"))}if("location_align_y"in t){var n=this.$("#wpmudev-floating-vertical-top"),a=this.$("#wpmudev-floating-vertical-bottom");"top"===t.location_align_y?(n.addClass("current"),a.removeClass("current")):(n.removeClass("current"),a.addClass("current"))}},copy_shortcode:function(t){var i=e(t.target),s=i.siblings("input");s.prop("disabled",!1).select(),document.execCommand("copy"),s.prop("disabled",!0)}}))}),Hustle.define("SShare.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-sshare-wizard-view",message_box_tpl:Optin.template("wpoi-social-sharing-message-box-tpl"),preview:!1,preview_model:!1,initial_data:new Backbone.Model({content:""}),events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.design_view.model,"change",this.design_view_changed),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render(),this.render_design_view(),this.settings_view.target_container.html(""),this.settings_view.render(),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},render_design_view:function(){this.design_view.target_container.html(""),this.design_view.render_design(),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render()},design_view_changed:function(e){var t=Object.keys(e.changed)[0];this.design_view.excluded_rerender.indexOf(t)!==-1?this.design_view.model_updated(e.changed):this.render_design_view()},sanitize_data:function(){_.isEmpty(this.model.get("module_name"))&&this.model.set("module_name",this.content_view.model.get("module_name"))},save:function(t){if(!Module.Validate.validate_module_name())return!1;this.sanitize_data();var i=this,s=this.model.toJSON(),o=this.content_view.model.toJSON(),n=this.design_view.model.toJSON(),a=this.settings_view.model.toJSON();return o=this.content_view.get_social_icons_data(o),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_sshare_module",_ajax_nonce:t.data("nonce"),id:t.data("id")?t.data("id"):"-1",module:s,content:o,design:n,settings:a,shortcode_id:i._get_shortcode_id()},complete:function(e){e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.target);i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-services-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section||!1,o="";return window.onbeforeunload=null,s&&"services"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.target));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-services-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"services"===t?window.location.replace(this.$(".wpmudev-menu-services-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")}})}),Hustle.define("Popup.Module",function(){"use strict";!function(){if("hustle_page_hustle_popup_listing"===pagenow){var e=Hustle.get("Popup.Listing");new e}}(),function(){if("hustle_page_hustle_popup"===pagenow){var e=Hustle.get("Pop_Up.View"),t=Hustle.get("Pop_Up.Content_View"),i=Hustle.get("Pop_Up.Design_View"),s=Hustle.get("Pop_Up.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Pop_Up.Models.Base"),a=Hustle.get("Pop_Up.Models.Content"),l=Hustle.get("Pop_Up.Models.Design"),d=Hustle.get("Pop_Up.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"pop-up"})})})}}()}),Hustle.define("Slidein.Module",function(){"use strict";!function(){if("hustle_page_hustle_slidein_listing"===pagenow){var e=Hustle.get("Slidein.Listing");new e}}(),function(){if("hustle_page_hustle_slidein"===pagenow){var e=Hustle.get("Slidein.View"),t=Hustle.get("Slidein.Content_View"),i=Hustle.get("Slidein.Design_View"),s=Hustle.get("Slidein.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Slidein.Models.Base"),a=Hustle.get("Slidein.Models.Content"),l=Hustle.get("Slidein.Models.Design"),d=Hustle.get("Slidein.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"slidein"})})})}}()}),Hustle.define("Embedded.Module",function(){"use strict";!function(){if("hustle_page_hustle_embedded_listing"===pagenow){var e=Hustle.get("Embedded.Listing");new e}}(),function(){if("hustle_page_hustle_embedded"===pagenow){var e=Hustle.get("Embedded.View"),t=Hustle.get("Embedded.Content_View"),i=Hustle.get("Embedded.Design_View"),s=Hustle.get("Embedded.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Embedded.Models.Base"),a=Hustle.get("Embedded.Models.Content"),l=Hustle.get("Embedded.Models.Design"),d=Hustle.get("Embedded.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"embedded"})})})}}()}),Hustle.define("SShare.Module",function(e){"use strict";!function(){if("hustle_page_hustle_sshare_listing"===pagenow){var e=Hustle.get("SShare.Listing");new e}}(),function(){if("hustle_page_hustle_sshare"===pagenow&&!parseInt(optin_vars.current.is_ss_limited)){var e=Hustle.get("SShare.View"),t=Hustle.get("SShare.Content_View"),i=Hustle.get("SShare.Design_View"),s=Hustle.get("SShare.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("SShare.Models.Base"),a=Hustle.get("SShare.Models.Content"),l=Hustle.get("SShare.Models.Design"),d=Hustle.get("SShare.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new l(optin_vars.current.design||{}),u=new d(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c}),design_view:new i({model:_,social_icons:c.get("social_icons"),service_type:c.get("service_type"),click_counter:c.get("click_counter")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"social_sharing"})})})}}()}),Hustle.define("Dashboard.View",function(e,t,i){"use strict";if("toplevel_page_hustle"===pagenow&&!_.isTrue(optin_vars.is_free)){var s=Backbone.View.extend({el:".wph-dashboard",conversions_chart:null,chart_data:null,chart_options:null,empty_chart:!0,default_dataset_options:{fill:!1,cubicInterpolationMode:"monotone",borderCapStyle:"butt",borderDash:[],borderWidth:1,borderDashOffset:0,borderJoinStyle:"miter",pointBackgroundColor:"#fff",pointBorderWidth:3,pointHoverRadius:5,pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGaps:!1},events:{"click .wph-icon.i-close":"close","click .wpmudev-box-action":"hide"},initialize:function(e){return _.isEmpty(optin_vars.top_active_modules)||"undefined"==typeof google||(google.charts.load("current",{packages:["corechart","line"]}),google.charts.setOnLoadCallback(this.drawLineStyles)),this.render()},drawLineStyles:function(){var e=new google.visualization.DataTable;e.addColumn("date","Day");var t=[];if(_.each(optin_vars.top_active_modules,function(i,s){e.addColumn("number",i.module_name),t.push(i.color)}),!_.isEmpty(optin_vars.graph_date_conversions)){_.each(optin_vars.graph_date_conversions,function(t,i){var s=[new Date(t.formatted)];_.each(t.conversions,function(e){s.push(e)}),e.addRows([s])});var i={curveType:"function",legend:{position:"none"},animation:{startup:!0,duration:500,easing:"in"},colors:t,pointSize:5,lineWidth:1,interpolateNulls:!0,chartArea:{top:10,right:10,bottom:40,left:40},hAxis:{format:"d MMM",viewWindow:{min:new Date(optin_vars.graph_min_date),max:new Date(optin_vars.graph_max_date)},baseline:new Date(optin_vars.graph_min_date),baselineColor:"#D8D8D8",gridlines:{color:"transparent",count:5},textStyle:{color:"#666666",fontSize:14,fontName:"Roboto Condensed"}},vAxis:{viewWindow:{min:0},gridlines:{color:"#D8D8D8",count:5},baseline:0,baselineColor:"#D8D8D8",textStyle:{color:"#666666",fontSize:14,fontName:"Roboto Condensed"}},tooltip:{showColorCode:!0}},s=new google.visualization.LineChart(document.getElementById("hustle_chart"));s.draw(e,i)}},render:function(){e(".tabs-header li label").on("click",this.toggle_overview),e(".can-close .wph-icon.i-close").on("click",this.close),e(".can-hide .wpmudev-box-action").on("click",this.hide),e("a#sshare_view_all_stats").on("click",this.toggle_sshare_modal),e(".wpmudev-box-head .wpmudev-icon.wpmudev-i_close").on("click",this.close),e("#wpmudev-dashboard-widget-modules .wpmudev-box-head").on("click",this.toggle_module_accordion),this.handle_sshare_modal_pagination();var t=e("#conversions_chart");if(t.length)if(this.empty_chart){t.parent().css("height","100%").css("width","100%").css("display","table");var i=e('<div class="graph-no-data">'+optin_vars.messages.dashboard.not_enough_data+"</div>");i.css("display","table-cell").css("text-align","center").css("vertical-align","middle"),t.replaceWith(i)}else{var s=t.closest("#wph-module-stats").find("table.wph-table.wph-module--stats"),o=s.outerHeight();o>230?t.attr("height",o):t.attr("height",230);for(var n in this.chart_data.datasets)this.chart_data.datasets[n].data&&(this.chart_data.datasets[n].data=_.sortBy(this.chart_data.datasets[n].data,"x"));this.conversions_chart=new Chart(t,{type:"line",data:this.chart_data,options:this.chart_options})}},toggle_module_accordion:function(t){var i=e(t.target),s=i.parents(".wpmudev-box").find(".wpmudev-box-body"),o=i.parents(".wpmudev-box").find(".wpmudev-box-head");s.slideToggle("fast",function(){o.toggleClass("wpmudev-collapsed"),s.toggleClass("wpmudev-hidden")})},close:function(t){t.preventDefault();var i=e(t.target).closest(".wpmudev-row"),s=e(t.target).closest("#wph-welcome"),o=s.data("nonce");i.slideToggle(300,function(){e.ajax({url:ajaxurl,type:"POST",data:{action:"persist_new_welcome_close",_ajax_nonce:o},complete:function(e){i.remove()}})})},hide:function(t){t.preventDefault();var i=e(t.target).closest(".wpmudev-box-head").next(".wpmudev-box-body");i.toggleClass(".wpmudev-hide")},toggle_overview:function(t){t.preventDefault();var i=e(t.target),s=i.find("input").val(),o=e("#wph-"+s+"-overview"),n=i.parent();e(".wph-modules-overview").not(o).removeClass("current"),o.addClass("current"),e(".tabs-header li").not(n).removeClass("current"),n.addClass("current")},toggle_sshare_modal:function(t){t.preventDefault();var i=e("#wph-comulative-shares-modal");i.toggleClass("wpmudev-modal-active"),i.find(".wpmudev-box-modal").toggleClass("wpmudev-show")},handle_sshare_modal_pagination:function(){e("li.wph-sshare--prev_page a").on("click",e.proxy(this.sshare_modal_prev,this)),e("li.wph-sshare--next_page a").on("click",e.proxy(this.sshare_modal_next,this)),e("li.wph-sshare--page_number a").on("click",e.proxy(this.sshare_modal_goto,this))},sshare_modal_prev:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent(),o=s.data("nonce"),n=s.find("li.wph-sshare--current_page"),a=s.find("li.wph-sshare--page_number"),l=s.find("li.wph-sshare--next_page"),d=(parseInt(s.data("total")),parseInt(n.data("page"))),r=parseInt(i.data("page"));n.data("page",r);var c=l.find("svg");if(l.data("page",d),c.length&&l.html('<a href="#">'+c[0].outerHTML+"</a>"),1==r){var _=i.find("svg");_.length&&i.html("<span>"+_[0].outerHTML+"</span>")}if(a.length)a.data("page",d),a.find("a").text(d);else{var u='<li class="wph-link wph-sshare--page_number" data-page="'+d+'"><a href="#">'+d+"</a></li>";e(u).insertAfter(n)}n.find("span").text(r),i.data("page",r-1),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(r,o)},sshare_modal_next:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent(),o=s.data("nonce"),n=s.find("li.wph-sshare--current_page"),a=s.find("li.wph-sshare--page_number"),l=s.find("li.wph-sshare--prev_page"),d=parseInt(s.data("total")),r=parseInt(n.data("page")),c=parseInt(i.data("page"));n.data("page",c);var _=l.find("svg");if(l.data("page",r),_.length&&l.html('<a href="#">'+_[0].outerHTML+"</a>"),c<d){if(a.length){var u=c+1;a.data("page",u),a.find("a").text(u),i.data("page",u)}}else{a.length&&a.remove();var p=i.find("svg");p.length&&i.html("<span>"+p[0].outerHTML+"</span>")}n.find("span").text(c),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(c,o)},sshare_modal_goto:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent();s.find("li.wph-sshare--next_page a").click()},sshare_show_page_content:function(t,i){var s=Optin.template("wpmudev-hustle-sshare-stats-modal-tpl"),o=e("#wph-comulative-shares-modal table.wpmudev-table-paginated tbody");o.html('<div class="wph-sshare--loading_stats"><span class="on-action">Loading...</span></div>'),e.ajax({url:ajaxurl,type:"POST",data:{action:"sshare_show_page_content",page_id:t,_ajax_nonce:i},complete:function(e){var t=e.responseJSON.data,i=s(_.extend({},t));o.html(i)}})}});new s}}),function(e,t){"use strict";if("hustle_page_hustle_settings"===pagenow){var i=Hustle.get("Settings.E_News"),s=Hustle.get("Settings.Modules_Activity"),o=Hustle.get("Settings.Services");new i,new s,new o;e("#wpmudev-settings-widget-modules .wpmudev-box-head").on("click",function(t){var i=e(t.target),s=i.parents(".wpmudev-box").find(".wpmudev-box-body"),o=i.parents(".wpmudev-box").find(".wpmudev-box-head");s.slideToggle("fast",function(){o.toggleClass("wpmudev-collapsed"),s.toggleClass("wpmudev-hidden")})})}}(jQuery,document);
//# sourceMappingURL=maps/admin.min.js.map
