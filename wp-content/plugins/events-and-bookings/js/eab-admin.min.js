/*! Events and Bookings - v1.9.6
 * http://premium.wpmudev.org/project/events-and-booking
 * Copyright (c) 2017; * Licensed GPLv2+ */

jQuery(function(){function a(a){var b,c;if(b=!1,""!=jQuery("#incsub_event_start_"+a).val()&&(b=new Date(jQuery("#incsub_event_start_"+a).val()),""!=jQuery("#incsub_event_start_time_"+a).val()||jQuery("#incsub_event_no_start_time_"+a).is(":checked"))){var d=jQuery("#incsub_event_no_start_time_"+a).is(":checked")?"00:01":jQuery("#incsub_event_start_time_"+a).val(),e=d.split(/:/gi);b.setHours(e[0]),b.setMinutes(e[1])}if(c=!1,""!=jQuery("#incsub_event_end_"+a).val()&&(c=new Date(jQuery("#incsub_event_end_"+a).val()),""!=jQuery("#incsub_event_end_time_"+a).val()||jQuery("#incsub_event_no_end_time_"+a).is(":checked"))){var f=jQuery("#incsub_event_no_end_time_"+a).is(":checked")?"23:59":jQuery("#incsub_event_end_time_"+a).val(),g=f.split(/:/gi);c.setHours(g[0]),c.setMinutes(g[1])}return[b,c]}function b(b){if("bank"==b)return!0;if(jQuery("#icl_translation_of").length)return!0;var c,d,e;return e=a(b),c=!!e.length&&e[0],d=!!e.length&&e[1],!c||!d||c.getTime()>=d.getTime()?(jQuery("#incsub_event_start_"+b).addClass("error"),jQuery("#incsub_event_start_time_"+b).addClass("error"),jQuery("#incsub_event_end_"+b).addClass("error"),jQuery("#incsub_event_end_time_"+b).addClass("error"),jQuery("input.button-primary.button-large").attr("disabled",!0),!1):(jQuery("#incsub_event_start_"+b).removeClass("error"),jQuery("#incsub_event_start_time_"+b).removeClass("error"),jQuery("#incsub_event_end_"+b).removeClass("error"),jQuery("#incsub_event_end_time_"+b).removeClass("error"),jQuery("input.button-primary.button-large").removeAttr("disabled"),!0)}jQuery(".incsub_event_picker").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,defaultDate:new Date,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0}),jQuery('[href*="preview=true"]').hide(),jQuery("#eab-add-more").show(),jQuery("#eab-add-more-button").click(function(){row_id=jQuery(".eab-start-section").length-1,jQuery("#eab-add-more-rows").append(jQuery("#eab-add-more-bank").html().replace(/_bank/gi,"_"+row_id).replace(/bank/gi,row_id+1).replace(/_b/gi,"")),jQuery("#incsub_event_start_"+row_id+" , #incsub_event_end_"+row_id).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0}),jQuery(".eab-section-block").length>2&&jQuery(".eab-section-heading").show()}),jQuery("body").on("click",".eab-event-remove_time",function(){var a=jQuery(this),b=a.parents("#eab-add-more-rows"),c=b.find(".eab-start-section"),d=a.parents(".eab-section-block");return!(c.length<=1)&&(!!d.length&&(d.remove(),!1))}),jQuery("#incsub_event-accept_payments").is(":checked")||jQuery("#eab-settings-paypal").hide(),jQuery("#incsub_event-accept_payments").change(function(){jQuery("#incsub_event-accept_payments").is(":checked")?jQuery("#eab-settings-paypal").show():jQuery("#eab-settings-paypal").hide()}),0==jQuery("#incsub_event_paid").val()&&jQuery(".incsub_event-fee_row").hide(),jQuery("#incsub_event_paid").change(function(){0==jQuery("#incsub_event_paid").val()?jQuery(".incsub_event-fee_row").hide():jQuery(".incsub_event-fee_row").show()}),jQuery("a.eab-info").click(function(){return jQuery(jQuery(this).attr("href")).toggle(),!1}),jQuery("#incsub-event-bookings").hasClass("closed")||jQuery("#incsub-event-bookings").addClass("closed"),jQuery("#incsub-event-bookings .hndle").append('<span class="eab-expand-metabox">'+eab_event_localized.view_all_bookings+"</span>"),jQuery("#incsub-event-wizard").hasClass("closed")||jQuery("#incsub-event-wizard").addClass("closed"),jQuery("#incsub-event-wizard .hndle").append('<a href="edit.php?post_type=incsub_event&page=eab_welcome" class="eab-expand-metabox">'+eab_event_localized.back_to_gettting_started+"</a>"),2==jQuery(".eab-section-block").length&&jQuery(".eab-section-heading").hide(),jQuery("#incsub-event").on("change","input.incsub_event",function(){b(jQuery(this).attr("id").replace(/incsub_event_[a-z_]+_/gi,""))}),jQuery("#incsub-event").on("change",".incsub_event_no_start_time",function(){var a=jQuery(this),b=a.attr("id").replace(/incsub_event_[a-z_]+_/gi,"");a.is(":checked")?jQuery("#incsub_event_start_time_"+b).hide():jQuery("#incsub_event_start_time_"+b).show()}),jQuery(".incsub_event_no_start_time").each(function(){jQuery(this).trigger("change")}),jQuery("#incsub-event").on("change",".incsub_event_no_end_time",function(){var a=jQuery(this),b=a.attr("id").replace(/incsub_event_[a-z_]+_/gi,"");a.is(":checked")?jQuery("#incsub_event_end_time_"+b).hide():jQuery("#incsub_event_end_time_"+b).show()}),jQuery(".incsub_event_no_end_time").each(function(){jQuery(this).trigger("change")}),jQuery("#incsub-event").on("change",".incsub_event_start",function(){var b,c,d=jQuery(this),e=d.parents(".eab-section-block").find(".incsub_event_end"),f=d.attr("id").replace(/incsub_event_[a-z_]+_/gi,"");return!e.length||(c=a(f),b=!!c.length&&c[0],!!c.length&&c[1],!b||!b.getTime||void e.datepicker("option","defaultDate",b))}),jQuery("form#post").submit(function(){if(_c=0,jQuery("#eab_event-repeat_start").is(":visible"))return!0;if(b(_c))return jQuery("#ajax-loading").show(),jQuery("#publish").removeClass("button-primary-disabled"),!0;var a=jQuery("#incsub_event_times_label"),c=a.length?a.offset().top:0;jQuery("#ajax-loading").hide(),jQuery("#publish").removeClass("button-primary-disabled"),jQuery("html,body").scrollTop(c);for(var d=0;d<3;d++)jQuery(".incsub_event_date.error").animate({"border-width":3}).animate({"border-width":1});return!1}),_eab_location=window.location,function(a){function c(){a("#incsub_event-accept_api_logins").is(":checked")?a("#eab-settings-apis .eab-inside").show():a("#eab-settings-apis .eab-inside").hide()}function d(){a("#incsub_event-override_appearance_defaults").is(":checked")?(a("#incsub_event-archive_template").attr("disabled",!1),a("#incsub_event-single_template").attr("disabled",!1)):(a("#incsub_event-archive_template").attr("disabled",!0),a("#incsub_event-single_template").attr("disabled",!0))}function e(){var b=a("#eab-eab-start_recurrence-button").val(),c=a("#eab-eab-start_recurrence-button").attr("data-eab-alter_label");return a("#eab-eab-start_recurrence-button").val(c),a("#eab-eab-start_recurrence-button").attr("data-eab-alter_label",b),a("#eab_event-recurring_event").is(":visible")?g():f(),!1}function f(){a("#eab_event-recurring_event").show(),a("#eab-add-more-rows").hide(),a("#eab-add-more").hide(),a("#eab_event-repeat_start,#eab_event-repeat_end").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0}),a("#edit-slug-box").hide(),h(!0)}function g(){a("#eab_event-recurring_event").hide(),a("#eab-add-more-rows").show(),a("#eab-add-more").show(),a("#edit-slug-box").show()}function h(b){a(".eab_event_recurrence_mode").hide();var c=a("#eab_event-repeat_every").val();if(!c&&void 0!==b)return a("#publish").attr("disabled",!0),!1;var d=a("#eab_event-repeat_interval-"+c);if(!d.length)return!1;a(".eab_event_recurrence_mode").find("input,select").attr("disabled",!0),d.find("input,select").attr("disabled",!1),a("#publish").attr("disabled",!1),d.show(),a("#eab_event-repeat_start,#eab_event-repeat_end").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,firstDay:parseInt(eab_event_localized.start_of_week,10)?parseInt(eab_event_localized.start_of_week,10):0})}function i(){return a("#eab_event-recurring_instances").is(":visible")?a("#eab_event-recurring_instances").hide():a("#eab_event-recurring_instances").show(),!1}a(function(){a("#incsub_event-accept_api_logins").change(c),c(),a("#incsub_event-override_appearance_defaults").change(d),d(),a(".eab-restart_tutorial").click(function(){var b=a(this);return a.post(ajaxurl,{action:"eab_restart_tutorial",step:b.attr("data-eab_tutorial")},function(){window.location.reload()}),!1}),a("#eab-eab-start_recurrence-button").click(e),a("#eab_event-repeat_every").change(h),h(),a("#eab_event-edit_recurring_instances").click(i),a("#eab_event-repeat_every").is(":visible")&&a("#edit-slug-box").hide(),a("body").on("click",".eab-guest-cancel_attendance",function(){var b=a(this),c=b.attr("data-eab-user_id"),d=b.attr("data-eab-event_id");return a.post(ajaxurl,{action:"eab_cancel_attendance",user_id:c,post_id:d},function(b){a("#eab-bookings-response").html(b)}),!1}),a("body").on("click",".eab-guest-delete_attendance",function(){var b=a(this),c=b.attr("data-eab-user_id"),d=b.attr("data-eab-event_id");return a.post(ajaxurl,{action:"eab_delete_attendance",user_id:c,post_id:d},function(b){a("#eab-bookings-response").html(b)}),!1}),a("body").on("click",".eab-add_attendance .button",function(){var b=a(".eab-add_attendance"),c=b.find(".eab-attendance-event_id").val();return email=b.find(".eab-attendance-email").val(),status=b.find(".eab-attendance-status").val(),!!(c&&email&&status)&&(a.post(ajaxurl,{action:"eab_add_attendance",user:email,post_id:c,status:status},function(b){a("#eab-bookings-response").html(b)}),!1)}),a("#incsub-event input.incsub_event").each(function(){b(a(this).attr("id").replace(/incsub_event_[a-z_]+_/gi,""))})})}(jQuery),function(a){function b(b){b.preventDefault(),b.stopPropagation();var c=a(this),e=c.attr("data-box_id"),f=!1;e&&(f=a("#"+e)),e&&e.length&&(a("#eab-root-settings_nav h3").removeClass("active"),c.addClass("active"),a(".eab-metabox.postbox").hide(),f.show(),window.location.hash=e,d())}function c(){var c=a(".eab-metabox.postbox"),h=a(".eab-metaboxcol.metabox-holder");if(g=g.length?g:h.siblings(".submit"),c.length){var i=a("#eab-root-settings_nav");if(i.length)return f.width()<e&&(h.removeClass("tabbed"),i.remove(),c.show()),void h.append(g);h.prepend('<div id="eab-root-settings_nav"></div>'),i=a("#eab-root-settings_nav"),i.empty(),c.each(function(){var c=a(this),d=c.attr("id"),e=c.find("h3.eab-hndle"),f=e.clone();d&&(f.attr("data-box_id",d).on("click",b),i.append(f),c.hide())}),h.append(g);var j=window.location.hash;if(j=j.split("#")[1]){var k=i.find('h3[data-box_id="'+j+'"]');k.length?k.click():i.find("h3:first").click()}else i.find("h3:first").click();d(),h.addClass("tabbed"),a(".eab-loading-cover.tabbable").remove(),a(".wrap.tabbable.hide").removeClass("hide")}}function d(){var b=window.location;a(".event_settings_url").val(b)}var e=768,f=a(window),g=!1;!!window.location.search.match("page=eab_settings")&&(!(f.width()<e)&&(!!a(".wrap").is(".tabbable")&&(a(c),f.on("resize",c))))}(jQuery)});