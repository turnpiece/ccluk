!function(t,e,o,r){"use strict";function a(e,o){this.element=e,this.$el=t(this.element),this.forminatorFront=null,this.settings=t.extend({},i,o),this._defaults=i,this._name=n,this.init()}var n="forminatorFrontSubmit",i={form_type:"custom-form",forminatorFront:!1,forminator_selector:"",chart_design:"bar",chart_options:{}};t.extend(a.prototype,{init:function(){switch(this.forminatorFront=this.$el.data("forminatorFront"),this.settings.form_type){case"custom-form":this.settings.forminator_selector&&t(this.settings.forminator_selector).length||(this.settings.forminator_selector=".forminator-custom-form"),this.handle_submit_custom_form();break;case"quiz":this.settings.forminator_selector&&t(this.settings.forminator_selector).length||(this.settings.forminator_selector=".forminator-quiz"),this.handle_submit_quiz();break;case"poll":this.settings.forminator_selector&&t(this.settings.forminator_selector).length||(this.settings.forminator_selector=".forminator-poll"),this.handle_submit_poll()}},handle_submit_custom_form:function(){var o=this;t(this.element);o.$el.find(".forminator-cform-response-message").find(".forminator-label--success").not(":hidden").length&&o.focus_to_element(o.$el.find(".forminator-cform-response-message"),!0),t("body").on("submit.frontSubmit",this.settings.forminator_selector,function(r){var a=t(this),n=new FormData(this),i=a.find(".forminator-cform-response-message"),s=a.find(".forminator-g-recaptcha");if(s.length){s=t(s.get(0));var l=s.data("forminator-recapchta-widget"),f=s.data("size"),d=e.grecaptcha.getResponse(l);if("invisible"===f&&0===d.length)return e.grecaptcha.execute(l),!1;if(e.grecaptcha.reset(l),i.html(""),s.hasClass("error")&&s.removeClass("error"),0===d.length)return s.hasClass("error")||s.addClass("error"),i.html('<label class="forminator-label--error"><span>'+e.ForminatorFront.cform.captcha_error+"</span></label>"),o.focus_to_element(i),!1}return!o.$el.hasClass("forminator_ajax")||(i.html(""),i.html('<label class="forminator-label--info"><span>'+e.ForminatorFront.cform.processing+"</span></label>"),o.focus_to_element(i),r.preventDefault(),t.ajax({type:"POST",url:e.ForminatorFront.ajaxUrl,data:n,cache:!1,contentType:!1,processData:!1,beforeSend:function(){a.find("button").attr("disabled",!0)},success:function(r){a.find(".forminator-label--validation").remove(),a.find(".forminator-field").removeClass("forminator-has_error"),a.find("button").removeAttr("disabled"),i.html("");var s=r.success?"success":"error";void 0!==r.message?(i.html('<div class="forminator-label--'+s+'"><span>'+r.message+"</span></div>"),o.focus_to_element(i,"success"===s)):void 0!==r.data&&(s=r.data.success?"success":"error",i.html('<div class="forminator-label--'+s+'"><span>'+r.data.message+"</span></div>"),o.focus_to_element(i,"success"===s)),!r.data.success&&r.data.errors.length&&(a.trigger("forminator:form:submit:failed",n),o.show_messages(r.data.errors)),!0===r.success&&(a[0]&&(a[0].reset(),a.find(".forminator-upload--remove").hide(),a.find(".forminator-upload .forminator-input").val(""),a.find(".forminator-upload .forminator-label").html("No file chosen"),a.find(".forminator-select").each(function(){t(this).val(null).trigger("change")}),a.trigger("forminator:form:submit:success",n),a.trigger("forminator.front.condition.restart")),void 0!==r.data.url&&(e.location.href=r.data.url))},error:function(t){a.find("button").removeAttr("disabled"),i.html("");var r=400===t.status?e.ForminatorFront.cform.upload_error:e.ForminatorFront.cform.error;i.html('<label class="forminator-label--notice"><span>'+r+"</span></label>"),o.focus_to_element(i),a.trigger("forminator:form:submit:failed",n)}}),!1)})},handle_submit_quiz:function(){var o=this;t("body").on("submit.frontSubmit",this.settings.forminator_selector,function(r){var a=t(this),n=[];return r.preventDefault(),o.$el.find(".forminator-has-been-disabled").removeAttr("disabled"),n=a.serialize(),o.$el.find(".forminator-has-been-disabled").attr("disabled","disabled"),t.ajax({type:"POST",url:e.ForminatorFront.ajaxUrl,data:n,beforeSend:function(){o.$el.find("button").attr("disabled","disabled")},success:function(t){if(t.success){if("nowrong"===t.data.type)o.$el.find(".quiz-form-button-holder").html(t.data.result);else if("knowledge"===t.data.type){var r=e.location.href.split("/");-1===r.indexOf("entries")?e.history.pushState("forminator","Forminator","entries/"+t.data.entry+"/"):(r[r.indexOf("entries")+1]=t.data.entry,e.history.pushState("forminator","Forminator",r.join("/"))),o.$el.find(".quiz-form-button-holder").size()>0&&o.$el.find(".quiz-form-button-holder").html(t.data.finalText),Object.keys(t.data.result).forEach(function(e){var r=o.$el.find("#"+e);r.find(".forminator-question--result").text(t.data.result[e].message),r.find(".forminator-submit-rightaway").attr("disabled","disabled");var a,n=o.$el.find('[id|="'+t.data.result[e].answer+'"]'),i=n.closest(".forminator-answer");a=t.data.result[e].isCorrect?"forminator-is_correct":"forminator-is_incorrect",i.addClass(a)})}}else o.$el.find("button").removeAttr("disabled")}}),!1}),t("body").on("click",".forminator-result--header button",function(){location.reload()})},handle_submit_poll:function(){var o=this;o.$el.find(".forminator-poll-response-message").find(".forminator-label--success").not(":hidden").length&&o.focus_to_element(o.$el.find(".forminator-poll-response-message"),!0),t("body").on("submit.frontSubmit",this.settings.forminator_selector,function(r){var a=(t(this),o.$el.find(".forminator-poll-response-message"));return!o.$el.hasClass("forminator_ajax")||(a.html(""),a.html('<label class="forminator-label--info"><span>'+e.ForminatorFront.poll.processing+"</span></label>"),o.focus_to_element(a),r.preventDefault(),t.ajax({type:"POST",url:e.ForminatorFront.ajaxUrl,data:o.$el.serialize(),beforeSend:function(){o.$el.find("button").attr("disabled",!0)},success:function(t){o.$el.find("button").removeAttr("disabled"),a.html("");var r=t.success?"success":"error";!1===t.success?(a.html('<label class="forminator-label--'+r+'"><span>'+t.data.message+"</span></label>"),o.focus_to_element(a)):void 0!==t.data&&(r=t.data.success?"success":"error",a.html('<label class="forminator-label--'+r+'"><span>'+t.data.message+"</span></label>"),o.focus_to_element(a,"success"===r)),!0===t.success&&(void 0!==t.data.url?e.location.href=t.data.url:void 0!==t.data.chart_data&&t.data.chart_data.length>1&&"undefined"!=typeof google&&(void 0===google.visualization?(google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(function(){o.render_poll_chart(t.data.chart_data,t.data.back_button,o)})):o.render_poll_chart(t.data.chart_data,t.data.back_button,o)))},error:function(){o.$el.find("button").removeAttr("disabled"),a.html(""),a.html('<label class="forminator-label--notice"><span>'+e.ForminatorFront.poll.error+"</span></label>"),o.focus_to_element(a)}}),!1)})},render_poll_chart:function(e,r,a){a.$el.find(".forminator-poll--chart").remove();var n=a.$el.attr("id")+"-"+a.$el.data("forminatorRender"),i="forminator-chart-poll-"+n,s=t('<div id="'+i+'" class="forminator-poll--chart" style="width: 100%; height: 300px;"></div>'),l=google.visualization.arrayToDataTable(e),f=t(r),d=!1;t(s).insertBefore(a.$el.find(".forminator-poll--answers")),a.$el.find(".forminator-poll--answers").hide(),a.$el.find(".forminator-poll--actions").empty(),f.click(function(t){t.preventDefault(),location.reload()}),a.$el.find(".forminator-poll--actions").append(f),"bar"===a.settings.chart_design?d=new google.visualization.BarChart(o.getElementById(i)):"pie"===this.settings.chart_design&&(d=new google.visualization.PieChart(o.getElementById(i))),d&&d.draw(l,a.settings.chart_options)},focus_to_element:function(o,r){r=r||!1,o.show(),t("html,body").animate({scrollTop:o.offset().top-(t(e).height()-o.outerHeight(!0))/2},500,function(){o.attr("tabindex")||o.attr("tabindex",-1),o.focus(),r&&o.show().delay(5e3).fadeOut("slow")})},show_messages:function(e){var o=this,r=o.$el.data("forminatorFrontCondition");if(void 0!==r){this.$el.find(".forminator-label--validation").remove();var a=0;e.forEach(function(e){var n=Object.keys(e),i=Object.values(e),s=r.get_form_field(n);if(s.length){if(0===a&&(o.$el.trigger("forminator.front.pagination.focus.input",[s]),o.focus_to_element(s)),t(s).hasClass("forminator-input-time")){var l=t(s).closest(".forminator-field:not(.forminator-field--inner)"),f=l.children(".forminator-label--validation");0===f.length&&(l.append('<label class="forminator-label--validation"></label>'),f=l.children(".forminator-label--validation")),f.text(i)}var d=t(s).closest(".forminator-field--inner");0===d.length&&(d=t(s).closest(".forminator-field"),0===d.length&&(d=t(s).find(".forminator-field"),d.length>1&&(d=d.first())));var m=d.find(".forminator-label--validation");0===m.length&&(d.append('<label class="forminator-label--validation"></label>'),m=d.find(".forminator-label--validation")),t(s).attr("aria-invalid","true"),m.text(i),d.addClass("forminator-has_error"),a++}})}return this}}),t.fn[n]=function(e){return this.each(function(){t.data(this,n)||t.data(this,n,new a(this,e))})}}(jQuery,window,document);