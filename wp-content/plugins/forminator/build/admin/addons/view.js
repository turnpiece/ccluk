!function(t){formintorjs.define(["text!tpl/popups.html"],function(i){return Backbone.View.extend({className:"wpmudev-section--integrations",loaderTpl:Forminator.Utils.template(t(i).find("#popup-loader-tpl").html()),model:{},events:{"click .forminator-addon-connect":"connect_addon","click .forminator-addon-disconnect":"disconnect_addon","click .forminator-addon-form-disconnect":"form_disconnect_addon","click .forminator-addon-next":"submit_next_step","click .forminator-addon-back":"go_prev_step","click .forminator-addon-close":"close","click .forminator-integration-close":"close","click .forminator-addon-finish":"finish_steps"},initialize:function(t){return this.slug=t.slug,this.nonce=t.nonce,this.action=t.action,this.form_id=t.form_id,this.multi_id=t.multi_id,this.step=0,this.next_step=!1,this.prev_step=!1,this.$el.find(".forminator-integration-close").on("click",this.close),this.render()},render:function(){var t={};t.action=this.action,t._ajax_nonce=this.nonce,t.data={},t.data.slug=this.slug,t.data.step=this.step,t.data.current_step=this.step,this.form_id&&(t.data.form_id=this.form_id),this.multi_id&&(t.data.multi_id=this.multi_id),this.request(t,!1,!0)},request:function(i,n,e){var s=this;e&&(this.$el.find(".sui-box-body").html(this.loaderTpl()),this.$el.find(".sui-box-footer").html(""),this.$el.find(".integration-header").html("")),this.$el.find(".sui-button").addClass("sui-button-onload"),t.post({url:Forminator.Data.ajaxUrl,type:"post",data:i}).done(function(i){if(i&&i.success){s.render_body(i),s.render_footer(i);var e=i.data.data;if(s.on_render(e),s.$el.find(".sui-button").removeClass("sui-button-onload"),(n||!_.isUndefined(e.is_close)&&e.is_close)&&s.close(),_.isUndefined(e.notification)||_.isUndefined(e.notification.type)||_.isUndefined(e.notification.text)||Forminator.Notification.open(e.notification.type,e.notification.text,4e3),_.isUndefined(e.hasBack)?s.$el.find(".forminator-addon-back").hide():e.hasBack?s.$el.find(".forminator-addon-back").show():s.$el.find(".forminator-addon-back").hide(),!_.isUndefined(e.size)){var o=t("#forminator-integration-popup");"normal"===e.size&&o.removeClass("sui-dialog-sm sui-dialog-lg"),"small"===e.size&&(o.addClass("sui-dialog-sm"),o.removeClass("sui-dialog-lg")),"large"===e.size&&(o.addClass("sui-dialog-lg"),o.removeClass("sui-dialog-sm"))}}}).always(function(){s.$el.find(".fui-loading-dialog").remove()})},render_body:function(t){this.$el.find(".sui-box-body").html(t.data.data.html);var i=this.$el.find(".sui-box-body .integration-header").remove();i.length>0&&this.$el.find(".integration-header").html(i.html())},render_footer:function(t){var i=this,n=t.data.data.buttons;i.$el.find(".sui-box-footer").html(""),_.each(n,function(t){i.$el.find(".sui-box-footer").append(t.markup)})},on_render:function(t){this.delegateEvents(),Forminator.Utils.sui_delegate_events(),_.isUndefined(t.forminator_addon_current_step)||(this.step=+t.forminator_addon_current_step),_.isUndefined(t.forminator_addon_has_next_step)||(this.next_step=t.forminator_addon_has_next_step),_.isUndefined(t.forminator_addon_has_prev_step)||(this.prev_step=t.forminator_addon_has_prev_step)},get_step:function(){return this.next_step?this.step+1:this.step},get_prev_step:function(){return this.prev_step?this.step-1:this.step},connect_addon:function(i){var n={},e=this.$el.find("form"),s={slug:this.slug,step:this.get_step(),current_step:this.step},o=e.serialize();this.form_id&&(s.form_id=this.form_id),this.multi_id&&(s.multi_id=this.multi_id),o=o+"&"+t.param(s),n.action=this.action,n._ajax_nonce=this.nonce,n.data=o,this.request(n,!1,!1)},submit_next_step:function(i){var n={},e=this.$el.find("form"),s={slug:this.slug,step:this.get_step(),current_step:this.step},o=e.serialize();this.form_id&&(s.form_id=this.form_id),o=o+"&"+t.param(s),n.action=this.action,n._ajax_nonce=this.nonce,n.data=o,this.request(n,!1,!1)},go_prev_step:function(t){var i={},n={slug:this.slug,step:this.get_prev_step(),current_step:this.step};this.form_id&&(n.form_id=this.form_id),this.multi_id&&(n.multi_id=this.multi_id),i.action=this.action,i._ajax_nonce=this.nonce,i.data=n,this.request(i,!1,!1)},finish_steps:function(i){var n={},e=this.$el.find("form"),s={slug:this.slug,step:this.get_step(),current_step:this.step},o=e.serialize();this.form_id&&(s.form_id=this.form_id),this.multi_id&&(s.multi_id=this.multi_id),o=o+"&"+t.param(s),n.action=this.action,n._ajax_nonce=this.nonce,n.data=o,this.request(n,!1,!1)},disconnect_addon:function(t){var i={};i.action="forminator_addon_deactivate",i._ajax_nonce=this.nonce,i.data={},i.data.slug=this.slug,this.request(i,!0,!1)},form_disconnect_addon:function(t){var i={};i.action="forminator_addon_form_deactivate",i._ajax_nonce=this.nonce,i.data={},i.data.slug=this.slug,i.data.form_id=this.form_id,this.multi_id&&(i.data.multi_id=this.multi_id),this.request(i,!0,!1)},close:function(){Forminator.Integrations_Popup.close(),Forminator.Events.trigger("forminator:addons:reload")}})})}(jQuery);