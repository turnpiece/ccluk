/*! Google Maps Pro - v2.9.5
 * http://premium.wpmudev.org/project/wordpress-google-maps-plugin
 * Copyright (c) 2018; * Licensed GPLv2+ */
window.AgmMapHandler=null,jQuery(function(){window.AgmMapHandler=function(a,b,c){function d(){I=b,void 0===b.defaults&&(b.defaults={}),b.zoom=b.zoom||b.defaults.zoom,b.zoom=parseInt(b.zoom)?parseInt(b.zoom):1,b.show_map="show_map"in b?b.show_map:1,b.show_posts="show_posts"in b?b.show_posts:0,b.show_markers="show_markers"in b?b.show_markers:1,b.show_images="show_images"in b?b.show_images:0,b.snapping="snapping"in b.defaults?parseInt(b.defaults.snapping):1,b.show_panoramio_overlay="show_panoramio_overlay"in b?parseInt(b.show_panoramio_overlay):0,b.panoramio_overlay_tag="panoramio_overlay_tag"in b?b.panoramio_overlay_tag:"",b.street_view="street_view"in b?b.street_view:0,b.street_view_pos="street_view_pos"in b?b.street_view_pos:0,b.street_view_pov="street_view_pov"in b?b.street_view_pov:0,b.map_type=b.map_type||b.defaults.map_type,b.map_alignment=b.map_alignment||b.defaults.map_alignment,b.post_ids=b.post_ids||[],b.image_size=b.image_size||b.defaults.image_size,b.image_limit=b.image_limit||b.defaults.image_limit}function e(){var a=jQuery("#agm_mh_map_id").val();return!a||jQuery(this).is(":disabled")?(window.alert(l10nStrings.please_save_map),!1):(E(),void K.trigger("agm_map_insert",[a]))}function f(){var a=jQuery("#agm_save_status_pending"),b=jQuery("#agm_save_status_done"),c=jQuery("#agm_map_title").val();if(!c)return window.alert(l10nStrings.map_name_missing),!1;a.show(),b.hide();var d=H.getStreetView(),e=jQuery("#agm_map_size_x").is(":enabled")?jQuery("#agm_map_size_x").val():0,f=jQuery("#agm_map_size_y").is(":enabled")?jQuery("#agm_map_size_y").val():0,g=jQuery("input.agm_map_alignment_element:checked").val(),h={action:"agm_save_map",id:jQuery("#agm_mh_map_id").val(),title:c,height:f,width:e,zoom:H.getZoom(),map_type:H.getMapTypeId(),show_map:jQuery("#agm_map_show_map").is(":checked")?1:0,show_posts:jQuery("#agm_map_show_posts").is(":checked")?1:0,map_alignment:g,show_markers:jQuery("#agm_map_show_markers").is(":checked")?1:0,show_images:jQuery("#agm_map_show_images").is(":checked")?1:0,image_size:jQuery("#agm_map_image_size").val(),image_limit:jQuery("#agm_map_image_limit").val(),show_panoramio_overlay:jQuery("#agm_map_show_panoramio_overlay").is(":checked")?1:0,panoramio_overlay_tag:jQuery("#agm_map_panoramio_overlay_tag").val(),street_view:d.getVisible()?1:0,street_view_pos:d.getVisible()?[d.getPosition().lat(),d.getPosition().lng()]:0,street_view_pov:d.getVisible()?d.getPov():0,post_ids:[],markers:[]};jQuery.each(jQuery("input.agm_mh_associated_id"),function(a,b){h.post_ids[h.post_ids.length]=jQuery(b).val()}),jQuery("#agm_map_size_associate").is(":checked")&&(h.post_ids[h.post_ids.length]=jQuery("#post_ID").val()),jQuery.each(L,function(a,b){var c=b.getPosition();if(!c)return!0;var d={title:b.getTitle(),body:b._agmBody,icon:b.getIcon(),position:[c.lat(),c.lng()]};h.markers[h.markers.length]=d}),jQuery(document).trigger("agm_google_maps-admin-save_request",[h]),jQuery.post(window.ajaxurl,h,function(c){a.hide(),c.status?(b.show(),jQuery("#agm_mh_map_id").val(parseInt(c.id)),jQuery("#agm_insert_map").attr("disabled",!1),jQuery(document).trigger("agm-map-saved",[parseInt(c.id)]),K.trigger("agm_map_saved",[parseInt(c.id)]),window.setTimeout(function(){b.hide()},3e3)):window.alert(l10nStrings.map_not_saved)})}function g(){return b.post_ids.length?(jQuery.post(window.ajaxurl,{action:"agm_get_post_titles",post_ids:b.post_ids},function(a){if(!a.posts)return!1;var b='<div class="agm_less_important">'+l10nStrings.already_associated_width+'<ul class="agm_associated_list">';jQuery("#post_ID").val();jQuery.each(a.posts,function(a,c){b+="<li>"+c.post_title+"</li>"}),b+="</ul></div>",jQuery("#agm_map_associated_posts").html(b)}),!1):(jQuery("#agm_map_associated_posts").html(""),jQuery("#agm_map_size_associate").attr("checked",!1),!1)}function h(){var a,d="",e="";jQuery.each(b.post_ids,function(a,b){d+='<input type="hidden" class="agm_mh_associated_id" value="'+b+'" />'}),jQuery.each(J,function(a,c){var d=c===b.image_size?'selected="selected"':"";e+='<option value="'+c+'" '+d+">"+c+"</option>"}),K.html('<div class="agm-preview"></div><div class="agm-options" id="agm_mh_options" style="display:none"></div>'),K.find(".agm-preview").append('<div id="agm_mh_header"><input type="hidden" id="agm_mh_map_id"><div class="agm_mh_container"><input type="text" size="32" class="widefat" id="agm_map_title" placeholder="'+l10nStrings.map_title+'" /></div><div class="agm_mh_container marker-buttons"><label for="agm_mh_location">'+l10nStrings.add_location+' </label><input type="text" id="agm_mh_location" /><button type="button" class="button-secondary action" id="agm_mh_location_trigger"><i class="dashicons dashicons-location"></i> '+l10nStrings.add+'</button><span id="agm_map_drop_marker_controls_container"><button type="button" class="button-secondary action" id="agm_map_drop_marker"><i class="dashicons dashicons-location"></i> '+l10nStrings.drop_marker+'</button><div id="agm_map_zoom_in_help" class="agm_less_important">'+l10nStrings.zoom_in_help+'</div></span></div></div><div class="map_preview"></div><div id="agm_mh_footer" class="agm_mh_footer"><div class="agm_mh_container" id="agm_mh_markers"></div></div>'),a=K.parents(".agm-editor"),a.find(".buttons").append('<div class="detail-buttons">'+(a.hasClass("agm-no-back")?"":'<button type="button" class="button-secondary action agm_go_back"><i class="dashicons dashicons-arrow-left"></i> '+l10nStrings.go_back+"</button>")+'<span class="map-actions"><span class="agm-status-text" id="agm_save_status_pending" style="display:none">'+l10nStrings.saving+'</span><span class="agm-status-text" id="agm_save_status_done" style="display:none">'+l10nStrings.saved+"</span>"+(c?'<button type="button" class="button-secondary action" id="agm_insert_map"><i class="dashicons dashicons-pressthis"></i> '+l10nStrings.insert+"</button>":"")+'<button type="button" class="button-secondary action agm_map_options_open"data-tooltip="'+l10nStrings.options_help+'" data-width="500"><i class="dashicons dashicons-admin-generic"></i> '+l10nStrings.options+'</button><button type="button" class="button-secondary action agm_map_options_close" style="display:none"><i class="dashicons dashicons-yes"></i> '+l10nStrings.apply_settings+'</button><button type="button" class="button-primary agm_save_map"><i class="dashicons dashicons-yes"></i> '+l10nStrings.save+"</button></span></div>"),K.find(".agm-options").append('<div><label for="agm_map_size_associate"><input type="checkbox" id="agm_map_size_associate" value="'+jQuery("#post_ID").val()+'" /> '+l10nStrings.map_associate+'</label><div class="agm_less_important">'+l10nStrings.association_help+"</div>"+d+'<div id="agm_map_associated_posts"></div></div><fieldset><legend>'+l10nStrings.map_size+'</legend><div><input type="text" size="3" id="agm_map_size_x" />&nbsp;x&nbsp;<input type="text" size="3" id="agm_map_size_y" /></div><div><label><input type="checkbox" id="agm_map_size_default" /> '+l10nStrings.use_default_size+"</label></div></fieldset><fieldset><legend>"+l10nStrings.map_appearance+'</legend><div><label><input type="checkbox" id="agm_map_show_posts" /> '+l10nStrings.show_posts+'</label></div><div><label for="agm_map_show_map"><input type="checkbox" id="agm_map_show_map" /> '+l10nStrings.show_map+'</label></div><div><label for="agm_map_show_markers"><input type="checkbox" id="agm_map_show_markers" /> '+l10nStrings.show_markers+"</label></div></fieldset><fieldset><legend>"+l10nStrings.map_alignment+'</legend><div><label><input type="radio" id="agm_map_alignment_left" name="ama" class="agm_map_alignment_element" value="left" /> <img src="'+_agm.root_url+'/img/system/left.png" />'+l10nStrings.map_alignment_left+'</label></div><div><label><input type="radio" id="agm_map_alignment_center" name="ama" class="agm_map_alignment_element" value="center" /> <img src="'+_agm.root_url+'/img/system/center.png" />'+l10nStrings.map_alignment_center+'</label></div><div><label><input type="radio" id="agm_map_alignment_right" name="ama" class="agm_map_alignment_element" value="right" /> <img src="'+_agm.root_url+'/img/system/right.png" />'+l10nStrings.map_alignment_right+'</label></div></fieldset><p class="agm_less_important">Global defaults are configured in Settings &gt; WPMU DEV Maps</p>'),jQuery(document).trigger("agm_google_maps-admin-markup_created",[K.find(".agm-preview"),b]),i(),j(),jQuery(document).trigger("agm_google_maps-admin-options_initialized",[K.find(".agm-options"),b]),wpmUi.upgrade_tooltips(),wpmUi.upgrade_multiselect(K),jQuery(".map_preview").width(700).height(.35*jQuery(window).height()),jQuery(document).trigger("agm_google_maps-admin-map_resized",[K,b])}function i(){jQuery("#agm_mh_map_id").val(b.id),b.id||jQuery("#agm_insert_map").attr("disabled",!0),jQuery("#agm_map_title").val(b.title)}function j(){var a=b.show_map&&parseInt(b.show_map)>0,c=b.show_posts&&parseInt(b.show_posts)>0,d=b.show_markers&&parseInt(b.show_markers)>0,e=b.show_images&&parseInt(b.show_images)>0,f=b.show_panoramio_overlay;switch(jQuery("#agm_map_show_map").prop("checked",a),jQuery("#agm_map_show_posts").prop("checked",c),jQuery("#agm_map_show_markers").prop("checked",d),jQuery("#agm_map_show_images").click(n).prop("checked",e),n(),jQuery("#agm_map_show_panoramio_overlay").click(k).prop("checked",f),jQuery("#agm_map_panoramio_overlay_tag").change(p).val(b.panoramio_overlay_tag),b.map_alignment){case"right":jQuery("#agm_map_alignment_right").prop("checked",!0);break;case"center":jQuery("#agm_map_alignment_center").prop("checked",!0);break;default:jQuery("#agm_map_alignment_left").prop("checked",!0)}b.width&&parseInt(b.width)||jQuery("#agm_map_size_default").prop("checked",!0),m(),jQuery.each(b.post_ids,function(a,b){jQuery("#post_ID").val()===b&&jQuery("#agm_map_size_associate").prop("checked",!0)}),jQuery("#agm_map_size_associate").click(o)}function k(){if("object"!=typeof window.google.maps.panoramio)return!1;if(jQuery("#agm_map_show_panoramio_overlay").is(":checked")){var a=jQuery("#agm_map_panoramio_overlay_tag").val();M=new window.google.maps.panoramio.PanoramioLayer,a&&M.setTag(a),M.setMap(H)}else M&&(M.setMap(null),M=!1)}function l(){var a=K.find(".agm-options"),b=K.find(".agm-preview"),c=K.parents(".agm-editor").find(".detail-buttons");return a.is(":visible")?(jQuery(document).trigger("agm_google_maps-admin-options_dialog-closed",[H]),a.hide(),b.show(),c.find("button").hide(),c.find("#agm_insert_map, .agm_go_back, .agm_map_options_open, .agm_save_map").show()):(a.show(),b.hide(),c.find("button").hide(),c.find(".agm_map_options_close").show()),!1}function m(){var a=b.defaults.width,c=b.defaults.height,d=jQuery("#agm_map_size_default").is(":checked");d||(a=parseInt(b.width)>0?b.width:a,c=parseInt(b.height)>0?b.height:c),jQuery("#agm_map_size_x").val(a).attr("disabled",d),jQuery("#agm_map_size_y").val(c).attr("disabled",d)}function n(){var a=jQuery("#agm_map_show_images").is(":checked");jQuery("#agm_map_image_size").attr("disabled",!a),jQuery("#agm_map_image_limit").attr("disabled",!a)}function o(){var a=jQuery("#agm_map_size_associate").val();return jQuery("#agm_map_size_associate").is(":checked")?b.post_ids?b.post_ids.push(a):b.post_ids=[a]:(jQuery('input.agm_mh_associated_id[value="'+a+'"]').remove(),b.post_ids&&(b.post_ids=jQuery.grep(b.post_ids,function(b){return b!==a}))),g(),!0}function p(){var a=jQuery("#agm_map_panoramio_overlay_tag").val();return!M||void M.setTag(a)}function q(){b.markers&&jQuery.each(b.markers,function(a,b){s(b.title,new window.google.maps.LatLng(b.position[0],b.position[1]),b.body,b.icon)})}function r(){return s("Untitled marker",H.getCenter()),!1}function s(a,c,d,e){d=d||"",void 0!==e&&"string"==typeof e||(e=_agm.root_url+"/img/system/marker.png"),e.match(/^https?:\/\//)||(e=_agm.root_url+"/img/"+e);var f=L.length;H.setCenter(c);var g=new window.google.maps.Marker({title:a,map:H,icon:e,draggable:!0,clickable:!0,position:c,zIndex:100}),h=new window.google.maps.InfoWindow({content:t(a,d,e,f),maxWidth:400});window.google.maps.event.addListener(g,"click",function(){h.open(H,g)}),g._agmInfo=h,b.snapping&&window.google.maps.event.addListener(g,"dragend",function(){var a=new window.google.maps.Geocoder;a.geocode({latLng:g.getPosition()},function(a,b){b===window.google.maps.GeocoderStatus.OK?(g.setPosition(a[0].geometry.location),g.setTitle(a[0].formatted_address),h.setContent(t(a[0].formatted_address,"",g.getIcon(),f)),x()):window.alert(l10nStrings.geocoding_error)})}),g._agmBody=d,L[f]=g,jQuery(document).trigger("agm_google_maps-admin-marker_added",[g,H]),H._agm_add_marker(g),x()}function t(a,b,c,d){return c=void 0!==c.url?c.url:c.toString(),'<div class="agm_mh_info_content"><a href="#" class="agm_mh_info_icon_switch"><img agm:marker_id="'+d+'" src="'+c+'" class="marker-icon-32" /><br /><small>Icon</small></a><div class="agm_mh_info_text"><div><label for="">'+l10nStrings.title+'</label><br /><input type="text" agm:marker_id="'+d+'" class="agm_mh_info_title" value="'+a+'" /></div><label for="">'+l10nStrings.body+'</label><textarea class="agm_mh_info_body" agm:marker_id="'+d+'">'+b+"</textarea></div></div>"}function u(a){var b=a.replace(/[^0-9]+/,"");return parseInt(b)}function v(){var a=jQuery(this),b=u(a.attr("href")),c=L.splice(b,1);return jQuery(document).trigger("agm_google_maps-admin-marker_removed",[c[0]]),c[0].setMap(null),H._agm_remove_marker(b),x(),!1}function w(){var a=jQuery(this),c=u(a.attr("href")),d=L[c];if(H.setCenter(d.getPosition()),parseInt(b.street_view)){var e=H.getStreetView();e.setPosition(H.getCenter()),e.setVisible(!0)}return!1}function x(){var a="<ul>";jQuery.each(L,function(b,c){var d,e=c.getIcon();e=void 0!==e.url?e.url:e.toString(),d='<li><a href="#agm_mh_marker-'+b+'" class="agm_mh_marker_item"><img src="'+e+'" class="marker-icon-32" />'+c.getTitle()+'</a><span class="action"><a href="#agm_mh_marker-'+b+'" class="button-secondary agm_mh_marker_delete_item"><i class="dashicons dashicons-trash"></i> '+l10nStrings.delete_item+'</a></span><span class="marker-infos">Lat: <span class="click-sel">'+c.position.lat().toFixed(5)+'</span> | Long: <span class="click-sel">'+c.position.lng().toFixed(5)+"</span></span></li>",a+=d}),a+="</ul>",jQuery("#agm_mh_markers").html(a)}function y(){var a=jQuery(this).find("img").attr("agm:marker_id"),b=jQuery(this).parent(".agm_mh_info_content"),c=b.html();jQuery.post(window.ajaxurl,{action:"agm_list_icons"},function(d){var e="";jQuery.each(d,function(a,b){e+='<a class="agm_new_icon" href="#"><img src="'+b+'" class="marker-icon-32" /></a> '}),b.html(e),jQuery(".agm_new_icon").click(function(){var d=jQuery(this).find("img").attr("src");b.html(c),b.find("a.agm_mh_info_icon_switch img").attr("src",d).addClass("marker-icon-32");var e=L[a];e.setIcon(d),x()})})}function z(){var a=jQuery(this),b=a.attr("agm:marker_id"),c=L[b];c.setTitle(a.val()),c._agmInfo.setContent(t(c.getTitle(),c._agmBody,c.getIcon(),b)),x()}function A(){var a=jQuery(this),b=a.attr("agm:marker_id"),c=L[b];c._agmBody=a.val(),c._agmInfo.setContent(t(c.getTitle(),c._agmBody,c.getIcon(),b)),x()}function B(){var a=jQuery("#agm_mh_location").val();if(!a)return window.alert(l10nStrings.type_in_location),!1;var b=new window.google.maps.Geocoder;b.geocode({address:a},function(a,b){b===window.google.maps.GeocoderStatus.OK?s(a[0].formatted_address,a[0].geometry.location):window.alert(l10nStrings.geocoding_error)})}function C(a){var b,c=jQuery(this)[0];document.selection?(b=document.body.createTextRange(),b.moveToElementText(c),b.select()):window.getSelection&&(b=document.createRange(),b.selectNode(c),window.getSelection().addRange(b))}function D(){if(d(),h(),H=new window.google.maps.Map(jQuery(".map_preview",K).get(0),{zoom:parseInt(b.zoom)?parseInt(b.zoom):1,minZoom:1,center:new window.google.maps.LatLng(40.7171,(-74.0039)),mapTypeId:window.google.maps.MapTypeId[b.map_type]}),navigator.geolocation&&!b.markers&&navigator.geolocation.getCurrentPosition(function(a){H.setCenter(new window.google.maps.LatLng(a.coords.latitude,a.coords.longitude))}),q(),k(),g(),parseInt(b.street_view)){var a=H.getStreetView(),c=null;c=b.street_view_pos?new window.google.maps.LatLng(b.street_view_pos[0],b.street_view_pos[1]):H.getCenter(),a.setPosition(c),b.street_view_pov&&a.setPov({heading:parseInt(b.street_view_pov.heading),pitch:parseInt(b.street_view_pov.pitch),zoom:parseInt(b.street_view_pov.zoom)}),a.setVisible(!0)}jQuery(document).trigger("agm_google_maps-admin-map_initialized",[H,b]),jQuery("#agm_map_drop_marker").click(r),jQuery(".agm_go_back").click(E),jQuery("#agm_insert_map").click(e),jQuery(".agm_map_options_open").click(l),jQuery(".agm_map_options_close").click(l),jQuery(".agm_save_map").click(f),jQuery("#agm_mh_location_trigger").click(B),jQuery("#agm_map_size_default").click(m),jQuery(document).on("click",".click-sel",C),jQuery("body").on("click",".agm_mh_marker_item",w),jQuery("body").on("click",".agm_mh_marker_delete_item",v),jQuery("body").on("click",".agm_mh_info_icon_switch",y),jQuery("body").on("change",".agm_mh_info_title",z),jQuery("body").on("change",".agm_mh_info_body",A)}function E(){F(),K.trigger("agm_map_close")}function F(){K.empty(),K.parents(".agm-editor").find(".buttons .detail-buttons").remove(),jQuery("body").off("click",".agm_mh_marker_item"),jQuery("body").off("click",".agm_mh_marker_delete_item"),jQuery("body").off("click",".agm_mh_info_icon_switch"),jQuery("body").off("change",".agm_mh_info_title"),jQuery("body").off("change",".agm_mh_info_body")}function G(){window._agmMapIsLoaded?D():window.setTimeout(G,100)}var H,I,J=["medium","small","thumbnail","square","mini_square"],K=jQuery(a),L=[],M=!1;return c=void 0===c||c,G(),{destroy:F}}});