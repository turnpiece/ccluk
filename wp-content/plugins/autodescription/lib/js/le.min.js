"use strict";window.tsfLe=function(){function a(){tsfTT.triggerReset()}function b(){for(const a in k){const b=k[a],c=document.getElementById("autodescription-quick[%s]".replace("%s",a));if(c)if(b.isSelect){tsf.selectByValue(c,b.value);const a=c.querySelector("[value=\"0\"]");a&&(a.innerHTML=a.innerHTML.replace("%s",tsf.escapeString(tsf.decodeEntities(b.default))))}else c.value=tsf.decodeEntities(b.value),b.placeholder?.length&&(c.placeholder=tsf.decodeEntities(b.placeholder))}}function c(){return b()}function d(a){const b=document.getElementById(`edit-${a}`);let c="public";if(b?.querySelector("[name=keep_private]")?.checked)c="private";else{const a=b?.querySelector("[name=post_password]")?.value;a?.length&&"0"!==a&&(c="password")}return c}function e(a,b){const c=document.getElementById(`edit-${a}`);b=tsfUtils.debounce(b,20),c?.querySelector("[name=post_password]")?.addEventListener("input",b),c?.querySelector("[name=keep_private]")?.addEventListener("click",b)}function f(a){const b="autodescription-quick[doctitle]",c=document.getElementById(b);if(!c)return;tsfTitle.setInputElement(c);const f=JSON.parse(document.getElementById(`tsfLeTitleData[${a}]`)?.dataset.leTitle||0);if(f&&(tsfTitle.updateStateOf(b,"allowReferenceChange",!f.refTitleLocked),tsfTitle.updateStateOf(b,"defaultTitle",f.defaultTitle.trim()),tsfTitle.updateStateOf(b,"addAdditions",f.addAdditions),tsfTitle.updateStateOf(b,"additionValue",f.additionValue.trim()),tsfTitle.updateStateOf(b,"additionPlacement",f.additionPlacement)),"post"===m){const c=()=>{let c="";switch(d(a)){case"password":c=tsfTitle.protectedPrefix;break;case"private":c=tsfTitle.privatePrefix;break;default:case"public":c=""}tsfTitle.updateStateOf(b,"prefixValue",c)};e(a,c),c()}const g=a=>{const c=(a.originalEvent||a).target,d=c.value?.trim()||"";let e=(tsfTitle.stripTitleTags?tsf.stripTags(d):d)||tsfTitle.untitledTitle;if("tax"===m){const a=f?.termPrefix?.trim()||"";a.length&&(window.isRtl?e=`${e} ${a}`:e=`${a} ${e}`)}e=tsf.escapeString(tsf.decodeEntities(e.trim())),tsfTitle.updateStateOf(b,"defaultTitle",e)},h=document.getElementById(`edit-${a}`);switch(m){case"post":const a=h?.querySelector("[name=post_title]");a&&!l.isFront&&(a.addEventListener("input",g),a.dispatchEvent(new Event("input")));break;case"tax":const b=h?.querySelector("[name=name]");b&&(b.addEventListener("input",g),b.dispatchEvent(new Event("input")))}tsfTT.triggerReset()}function g(a){const b="autodescription-quick[description]",c=document.getElementById(b);if(c){tsfDescription.setInputElement(c);const d=JSON.parse(document.getElementById(`tsfLeDescriptionData[${a}]`)?.dataset.leDescription||0);d&&(tsfDescription.updateStateOf(b,"allowReferenceChange",!d.refDescriptionLocked),tsfDescription.updateStateOf(b,"defaultDescription",d.defaultDescription.trim())),tsfTT.triggerReset()}}function h(a){const b="autodescription-quick[canonical]",c=document.getElementById("autodescription-quick[noindex]"),e=document.getElementById(b),f=new Map,g=1,h=2;let i=0;tsfCanonical.setInputElement(e);const j=JSON.parse(document.getElementById(`tsfLeCanonicalData[${a}]`)?.dataset.leCanonical||0);j&&(tsfCanonical.updateStateOf(b,"allowReferenceChange",!j.refCanonicalLocked),tsfCanonical.updateStateOf(b,"defaultCanonical",j.defaultCanonical.trim()),tsfCanonical.updateStateOf(b,"preferredScheme",j.preferredScheme.trim()),tsfCanonical.updateStateOf(b,"urlStructure",j.urlStructure)),tsfCanonical.enqueueTriggerUnregisteredInput(b);const l=()=>{tsfCanonical.updateStateOf(b,"showUrlPlaceholder",!(i&g||i&h)),tsfCanonical.updateStateOf(b,"urlDataParts",Object.fromEntries(f.entries()))},n=document.getElementById(`edit-${a}`);if(tsfCanonical.usingPermalinks&&e&&n)switch(m){case"post":{const c=tsfCanonical.structIncludes(b,"%postname%"),d=tsfCanonical.structIncludes(b,["%year%","%monthnum%","%day%","%hour%","%minute%","%second%"]),e={},g=tsfCanonical.structIncludes(b,"%author%");let h="",i="",k="",m="",o=[],p=[];c&&(tsfPostSlugs.store(j.parentPostSlugs),o=j.parentPostSlugs.map(a=>a.slug)),j.supportedTaxonomies.forEach(a=>{e[a]=tsfCanonical.structIncludes(b,`%${a}%`)});for(const[a,b]of Object.entries(j.parentTermSlugs))tsfTermSlugs.store(b,a),p[a]=b.map(a=>a.slug);g&&(tsfAuthorSlugs.store(j.authorSlugs),k=j.authorSlugs?.[0].slug);const q=tsfUtils.debounce(()=>{if(c){let b="";h.length&&(b=tsfCanonical.sanitizeSlug(h.substring(0,200)),"0"===b&&(b="")),!b.length&&i.length&&(b=tsfCanonical.sanitizeSlug(i.substring(0,200))),b.length||(b=a),f.set(`%postname%`,[...o,b].join("/"))}if(f.set(`%post_id%`,a).set(`%author%`,k),d){const a=new Date(m),b=a=>(a+"").padStart(2,"0");f.set(`%year%`,a.getFullYear()).set(`%monthnum%`,b(a.getMonth()+1)).set(`%day%`,b(a.getDate())).set(`%hour%`,b(a.getHours())).set(`%minute%`,b(a.getMinutes())).set(`%second%`,b(a.getSeconds()))}for(const a in e)e[a]&&f.set(`%${a}%`,Object.values(p[a]??{}).join("/"));l()},1e3/60);if(c){const a=n.querySelector("[name=post_name]"),b=n.querySelector("[name=post_title]"),c=n.querySelector("[name=post_parent]"),d=()=>{i=b?.value??"",h=a?.value??"",q()};if(a?.addEventListener("input",d),b?.addEventListener("input",d),d(),c){const a=tsfUtils.debounce(async()=>{o=await tsfPostSlugs.get(c.value),q()},100);c.addEventListener("input",a),a()}}if(g){const a=n.querySelector("[name=post_author]");if(a){const b=tsfUtils.debounce(async()=>{k=await tsfAuthorSlugs.get(a.value),q()},100);a.addEventListener("input",b),b()}}if(d){const a=[n.querySelector("[name=aa]"),n.querySelector("[name=mm]"),n.querySelector("[name=jj]"),n.querySelector("[name=hh]"),n.querySelector("[name=mn]"),n.querySelector("[name=ss]")],b=!a.some(a=>null===a),c=()=>{const b=a.map(a=>a.value);return b[1]&&--b[1],b.map(a=>a??"00")},d=()=>{m=b?new Date(...c()).toISOString():j.publishDate,q()};a.forEach(a=>{a?.addEventListener("change",d)}),d()}q();break}case"tax":{const c=n.querySelector("input[name=taxonomy]")?.value||"",d=tsfCanonical.structIncludes(b,`%${c}%`);let e="",g="",h=[];d&&(tsfTermSlugs.store(j.parentTermSlugs,c),h=j.parentTermSlugs.map(a=>a.slug));const i=()=>{if(d){let b="";e.length&&(b=tsfCanonical.sanitizeSlug(e.substring(0,200)),"0"===b&&(b="")),!b.length&&g.length&&(b=tsfCanonical.sanitizeSlug(g.substring(0,200))),b.length||(b=a),f.set(`%${c}%`,[...h,b].join("/"))}l()},k=tsfUtils.debounce(i,1e3/60);if(d){const a=n.querySelector("[name=name]"),b=n.querySelector("[name=slug]"),c=()=>{g=a?.value??"",e=b?.value??"",k()};b?.addEventListener("input",c),a?.addEventListener("input",c),c()}k()}}if(c){if("post"===m){const b=tsfUtils.debounce(()=>{let b=c.querySelector("[value=\"0\"]"),e="";switch(d(a)){case"password":case"private":e="noindex",i|=g;break;default:case"public":e=k.noindex.default,i&=~g}b&&(b.innerHTML=c.dataset.defaultI18n.replace("%s",tsf.escapeString(tsf.decodeEntities(e)))),l()},1e3/60);n?.querySelector("[name=post_password]")?.addEventListener("input",()=>b()),n?.querySelector("[name=keep_private]")?.addEventListener("change",()=>b()),b()}const b=a=>{let b="";switch(+a){case 0:b=k.noindex.default;break;case-1:b="index";break;case 1:b="noindex"}"noindex"===b?i|=h:i&=~h,l()};c.addEventListener("change",a=>b(a.target.value)),b(c.value)}}function i(){document.addEventListener("tsfLeDispatchUpdate",n),document.addEventListener("tsfLeUpdated",a)}function j(){let a,d;a=window.inlineEditPost?.edit,a&&(window.inlineEditPost.edit=function(c){let d=a.apply(this,arguments);return("object"==typeof c&&(c=window.inlineEditPost?.getId(c)),!c)?d:(m="post",k=JSON.parse(document.getElementById(`tsfLeData[${c}]`)?.dataset.le||0)||{},l=JSON.parse(document.getElementById(`tsfLePostData[${c}]`)?.dataset.lePostData||0)||{},[b,h,f,g].forEach(a=>{try{a(c)}catch(a){}}),window.tsfC?.resetCounterListener(),d)}),d=window.inlineEditTax?.edit,d&&(window.inlineEditTax.edit=function(a){let b=d.apply(this,arguments);return("object"==typeof a&&(a=window.inlineEditTax?.getId(a)),!a)?b:(m="tax",k=JSON.parse(document.getElementById(`tsfLeData[${a}]`)?.dataset.le||0)||{},[c,h,f,g].forEach(b=>{try{b(a)}catch(a){}}),window.tsfC?.resetCounterListener(),b)})}let k,l,m="";const n=tsfUtils.debounce(()=>{document.dispatchEvent(new CustomEvent("tsfLeUpdated"))},50);return{load:()=>{document.body.addEventListener("tsf-onload",i),document.body.addEventListener("tsf-onload",j)}}}(),window.tsfLe.load();
