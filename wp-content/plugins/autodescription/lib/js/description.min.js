"use strict";window.tsfDescription=function(){function a(a){return s.get(a)}function b(a,b){return b?t[a]?.[b]:t[a]}function c(a,b,c){if(t[a][b]!==c)switch(t[a][b]=c,b){case"allowReferenceChange":case"defaultDescription":case"useDefaultDescription":default:m(a)}}function d(a){return[document.getElementById(`tsf-description-reference_${a}`)]}function e(a){const c=d(a.target.id);if(!c[0])return;const e=b(a.target.id,"allowReferenceChange"),f=!e||b(a.target.id,"useDefaultDescription");let g=tsf.coalesceStrlen(e&&a.target.value.trim())??tsf.coalesceStrlen(f&&b(a.target.id,"defaultDescription"))??"";const h=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(tsf.sTabs(tsf.sSingleLine(g).trim())))),i=new Event("change");c.forEach(a=>{a.innerHTML=h,setTimeout(()=>{a.dispatchEvent(i)})})}function f(a){a.target.placeholder=d(a.target.id)[0].textContent}function g(a){const b=document.getElementById(`${a.target.id}_chars`),c=d(a.target.id)[0];b&&tsfC?.updateCharacterCounter({e:b,text:c.innerHTML,field:"description",type:"search"})}function h(a){const b=document.getElementById(`${a.target.id}_pixels`),c=d(a.target.id)[0];b&&tsfC?.updatePixelCounter({e:b,text:c.innerHTML,field:"description",type:"search"})}function i(b){b?a(b)?.dispatchEvent(new Event("input")):s.forEach(a=>a.id&&i(a.id))}function j(b){b?a(b)?.dispatchEvent(new CustomEvent("tsf-update-description-counter")):s.forEach(a=>a.id&&j(a.id))}function k(a){e(a),f(a),l(a)}function l(a){g(a),h(a)}function m(a){a in u&&clearTimeout(u[a]),u[a]=setTimeout(()=>i(a),1e3/60)}function n(a){if("tsfAys"in window){let b=tsfAys.areSettingsChanged();i(a),!b&&tsfAys.areSettingsChanged()&&tsfAys.reset()}else i(a)}function o(a){a in v&&clearTimeout(v[a]),v[a]=setTimeout(()=>n(a),1e3/60)}function p(){n()}function q(a){!a instanceof Element||(a.addEventListener("input",k),a.addEventListener("tsf-update-description-counter",l),o(a.id))}function r(){window.addEventListener("tsf-resize",p),window.addEventListener("tsf-counter-updated",()=>o())}const s=new Map,t={};let u={},v={};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",r)}},{setInputElement:function(b){return s.set(b.id,b),t[b.id]={allowReferenceChange:!0,defaultDescription:"",useDefaultDescription:!0},q(b),a(b.id)},getInputElement:a,getStateOf:b,updateStateOf:c,updateStateAll:function(a,b,d){d=Array.isArray(d)?d:[d],s.forEach(e=>{d.includes(e.id)||c(e.id,a,b)})},triggerCounter:j,triggerInput:i,enqueueTriggerInput:m,triggerUnregisteredInput:n,enqueueUnregisteredInputTrigger:o})}(),window.tsfDescription.load();
