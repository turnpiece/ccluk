"use strict";window.tsfPT=function(){function a(a,b){return g[a]?.i18n[b]||""}function b(a,b){document.dispatchEvent(new CustomEvent("tsf-updated-primary-term",{detail:{id:a,taxonomy:b}}))}function c(a){const c=()=>document.getElementById(`autodescription[_primary_term_${a}]`),d=()=>+c().value,e=(d,e)=>(d=+d,c().value=d,b(d||+e,a),d);return{get:d,set:e,revalidate:a=>{const b=d();return a.includes(b)?b:e(a?.[0]||0)},registerPostField:()=>{const b=document.getElementById(`${a}div`);b?(b.insertAdjacentHTML("beforeend",wp.template("tsf-primary-term-selector")({taxonomy:g[a]})),h.set(a,!0)):h.set(a,!1)},isPostFieldRegistered:()=>!!h.get(a)}}function d(a){const b=()=>document.getElementById(`${a}checklist`),c=()=>[...b().querySelectorAll("input[type=checkbox]")].sort((c,a)=>c.value-a.value),d=()=>document.getElementById(`taxonomy-${a}`).querySelectorAll(".categorychecklist input[type=checkbox]"),e=()=>c().filter(a=>a.checked),f=()=>e().map(a=>+a.value);return{getWrap:b,getInputs:c,getAllInputs:d,getInputsChecked:e,getInputsCheckedValues:f,subscribe:a=>{const c=()=>a(f()),e=()=>{d().forEach(a=>{a.addEventListener("change",c)})};new MutationObserver(()=>{e(),c()}).observe(b(),{childList:!0}),e(),c()}}}function e(){if(Object.keys(g).length){const b=b=>{const e=c(b),f=d(b),g=`tsf-primary-term-${b}`,h=`${g}-select`;let i=!1;const j=a=>document.createElement(a),k=()=>{const a=j("option"),b=document.getElementById(h);b.innerHTML="",b.append(...f.getInputsChecked().map(b=>{const c=a.cloneNode();return c.value=b.value,c.label=tsf.decodeEntities(b.parentElement.textContent.trim()),c})),tsf.selectByValue(b,e.get())},l=()=>{const c=j("div"),d=j("label"),f=j("select");c.id=g,c.classList.add("tsf-primary-term-selector-wrap"),d.innerText=a(b,"selectPrimary"),f.name=f.id=h,d.setAttribute("for",h),c.append(d,f),document.getElementById(`taxonomy-${b}`).insertBefore(c,document.getElementById(`${b}-adder`)?.nextSibling),f.addEventListener("change",a=>{e.set(a.target.value)}),tsfAys.registerChangeListener(f,"change")};f.subscribe(()=>{1<f.getInputsChecked().length?(!i&&(i=!0,l()),k(),e.revalidate(f.getInputsCheckedValues())):(i&&(document.getElementById(g)?.remove(),i=!1),e.set(0,f.getInputsChecked()[0]?.value||f.getInputs()[0]?.value||0))})};for(let a in g)if(d(a).getWrap()){const d=c(a);d.registerPostField(),d.isPostFieldRegistered()&&b(a)}}}const f=tsfPTL10n,g=f?.taxonomies||{},h=new Map;return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",e)}},{l10n:f})}(),window.tsfPT.load();
